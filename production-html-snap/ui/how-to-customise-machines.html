<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="css/stylesheet.css" />
    <style>
      #selector a:link{color:black;}
      #selector a:visited{color:black;}
      #selector a:active{color:black;}
      #selector a:hover{color:blue;}
      #sidebar a:link{color:black;}
      #sidebar a:visited{color:black;}
      #sidebar a:active{color:black;}
      #sidebar a:hover{color:blue;}
      ul {margin-left:0;margin-top:0;margin-bottom:0;list-style-type:none;padding-left:20px;}
      li {margin: 4px 0;}
      details {margin-top:0;margin-bottom:0;}
      details > summary {
	  padding: 0px;
	  margin-top: 0px;
	  margin-bottom: 0px;
	  width: 200px;
	  background-color: #ffffff;
	  border: none;
	  cursor: pointer;
    	  list-style-type: "< ";
	  direction: rtl;
      }
      details[open] > summary {
	  list-style-type: "v ";
      }
    </style>
  </head>
  <body>
    <div id="selector" style="top:0; position:fixed; float:right; background-color:#d9d9d9; width:100%;border-bottom:1px solid black;">
      &nbsp;&nbsp;
      <strong>Offline docs
      </strong>
      <a href="https://maas.io/docs">(switch to live docs)
      </a>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <span style="background-color:white;border-top:1px solid black; border-left:1px solid black; border-right:1px solid black; border-bottom:5px solid white;">
        &nbsp;UI-only&nbsp;
      </span>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <a href="../cli/how-to-customise-machines.html">
        CLI-only
      </a>
    </div>
    <div id="sidebar" style="float:left; width:25%;margin-top:40px; margin-left:20px">
      <ul>
	<li>
          <a href="maas-documentation.html"><b>MAAS Documentation</b></a>
	</li>
	<hr style="margin-top:15px;">
	<li>
          <details>
            <summary><a href="tutorials.html">Tutorials</a></summary>
            <ul>
              <li>
		<details>
                  <summary>Try out MAAS</summary>
		  <ul>
		    <li>
		      <a href="bootstrap-maas.html">Bootstrap MAAS</a>
		    </li>
		    <li>
		      <a href="get-to-know-your-machines.html">Get to know your machines</a>
		    </li>
		  </ul>
		</details>
              </li>
	      <li>
		<a href="try-out-the-maas-cli.html">Try out the MAAS CLI</a>
	      </li>
	      <li>
		<a href="create-custom-images.html">Create custom images</a>
	      </li>
	      <li>
		<a href="get-fancy-cli-output.html">Get fancy CLI output</a>
	      </li>
              <li>
		<details>
                  <summary>Primer tutorials</summary>
		  <ul>
		    <li>
		      <a href="primer-tutorial-the-osi-model.html">OSI model tutorial</a>
		    </li>
		  </ul>
		</details>
              </li>
            </ul>
          </details>
	</li>
	<hr style="margin-top:15px;">
	<li>
          <details>
            <summary><a href="how-to-guides.html">How-to guides</a></summary>
            <ul>
              <li>
		<details>
                  <summary><a href="how-to-get-started-with-maas.html">Get started with MAAS</a></summary>
		  <ul>
                    <li>
                      <a href="how-to-do-a-fresh-install-of-maas.html">Do a fresh install of MAAS</a>
		    </li>
		    <li>
                      <a href="how-to-upgrade-maas.html">Upgrade MAAS</a>
		    </li>
		    <li>
                      <a href="how-to-spin-up-maas-with-ansible.html">Spin up MAAS with Ansible</a>
		    </li>
		  </ul>
		</details>
              </li>
              <li>
		<details>
                  <summary><a href="how-to-manage-networks.html">Manage networks</a></summary>
		  <ul>
                    <li>
                      <a href="how-to-connect-maas-networks.html">Connect MAAS networks</a>
                    </li>
                    <li>
                      <a href="how-to-enable-dhcp.html">Enable DHCP</a>
                    </li>
                    <li>
                      <a href="how-to-use-availability-zones.html">Use availability zones</a>
                    </li>
		  </ul>
		</details>
              </li>
              <li>
		<details>
                  <summary><a href="how-to-use-images.html">Use images</a></summary>
		  <ul>
                    <li>
                      <a href="how-to-use-standard-images.html">Use standard images</a>
                    </li>
                    <li>
                      <a href="how-to-mirror-images-locally.html">Mirror images locally</a>
                    </li>
                    <li>
                      <a href="how-to-customise-images.html">Customise images</a>
                    </li>
                    <li>
                      <a href="how-to-employ-vmware-images.html">Employ VMware images</a>
                    </li>
                    <li>
                      <a href="how-to-deploy-a-real-time-kernel.html">Deploy a RT kernel</a>
                    </li>
		  </ul>
		</details>
              </li>
              <li>
		<details>
                  <summary><a href="how-to-manage-controllers.html">Manage controllers</a></summary>
		  <ul>
		    <li>
		      <a href="how-to-configure-controllers.html">Configure controllers</a>
		    </li>
		    <li>
		      <a href="how-to-enable-high-availability.html">Enable high availability</a>
		    </li>
		  </ul>
		</details>
              </li>
              <li>
		<details>
                  <summary><a href="how-to-manage-machines.html">Manage machines</a></summary>
		  <ul>
		    <li>
		      <a href="how-to-make-machines-available.html">Make machines available</a>
		    </li>
		    <li>
		      <a href="how-to-customise-machines.html">Customise machines</a>
		    </li>
		    <li>
		      <a href="how-to-put-machines-to-work.html">Put machines to work</a>
		    </li>
		  </ul>
		</details>
              </li>
              <li>
		<details>
                  <summary><a href="how-to-use-virtual-machines.html">Use virtual machines</a></summary>
		  <ul>
		    <li>
		      <a href="how-to-set-up-lxd.html">Set up LXD</a>
		    </li>
		    <li>
		      <a href="how-to-manage-vm-hosts.html">Manage VM hosts</a>
		    </li>
		    <li>
		      <a href="how-to-manage-virtual-machines.html">Manage virtual machines</a>
		    </li>
		  </ul>
		</details>
              </li>
              <li>
		<details>
                  <summary><a href="how-to-label-devices.html">Label devices</a></summary>
		  <ul>
		    <li>
		      <a href="how-to-tag-machines.html">Tag machines</a>
		    </li>
		    <li>
		      <a href="how-to-annotate-machines.html">Annotate machines</a>
		    </li>
		    <li>
		      <a href="how-to-use-machine-tags.html">Use machine tags</a>
		    </li>
		    <li>
		      <a href="how-to-use-controller-tags.html">Use controller tags</a>
		    </li>
		    <li>
		      <a href="how-to-use-storage-tags.html">Use storage tags</a>
		    </li>
		    <li>
		      <a href="how-to-use-network-tags.html">Use network tags</a>
		    </li>
		  </ul>
		</details>
              </li>
	      <li>
		<details>
                  <summary><a href="how-to-secure-maas.html">Secure MAAS</a></summary>
		  <ul>
		    <li>
		      <a href=.html"how-to-improve-maas-security.html">Improve MAAS security</a>
		    </li>
		    <li>
		      <a href="how-to-manage-user-accounts.html">Manage user accounts</a>
		    </li>
		    <li>
		      <a href="how-to-enable-maas-native-tls.html">Enable MAAS native TLS</a>
		    </li>
		    <li>
		      <a href="how-to-use-hashicorp-vault-with-maas.html">Use Vault with MAAS</a>
		    </li>
		    <li>
		      <a href="how-to-set-up-an-air-gapped-maas.html">Set up an air-gapped MAAS</a>
		    </li>
		  </ul>
		</details>
              </li>
	      <li>
		<details>
                  <summary><a href="how-to-operate-maas.html">Operate MAAS</a></summary>
		  <ul>
		    <li>
		      <a href=.html"how-to-find-machines.html">Find machines</a>
		    </li>
		    <li>
		      <a href="how-to-back-up-maas.html">Back up MAAS</a>
		    </li>
		    <li>
		      <a href="how-to-monitor-maas.html">Monitor MAAS</a>
		    </li>
		    <li>
		      <a href="how-to-audit-maas.html">Audit MAAS</a>
		    </li>
		    <li>
		      <a href="how-to-troubleshoot-maas">Troubleshoot MAAS</a>
		    </li>
		  </ul>
		</details>
              </li>
	      <li>
		<details>
                  <summary><a href="how-to-give-and-receive-help.html">Give and receive help</a></summary>
		  <ul>
		    <li>
		      <a href=.html"how-to-use-the-maas-discourse-forum.html">Use our discourse forum</a>
		    </li>
		    <li>
		      <a href="https://ubuntu.com/pro">Get support</a>
		    </li>
		    <li>
		      <a href="how-to-request-new-features.html">Request new features</a>
		    </li>
		    <li>
		      <a href="how-to-review-and-report-bugs.html">Review and report bugs</a>
		    </li>
		    <li>
		      <a href="how-to-contribute-documentation.html">Contribute documentation</a>
		    </li>
		  </ul>
		</details>
              </li>
            </ul>
          </details>
	</li>
	<hr style="margin-top:15px;">
	<li>
          <details>
            <summary><a href="reference.html">Reference</a></summary>
            <ul>
	      <details>
		<summary><a href="maas-release-notes.html">Release notes</a></summary>
		<ul>
		  <li>
		    <a href="what-is-new-with-maas-3-4.html">MAAS 3.4 release notes</a>
              	  </li>
		  <li>
              	    <a href="what-is-new-with-maas-3-3.html">MAAS 3.3 release notes</a>
              	  </li>
		  <li>
              	    <a href="what-is-new-with-maas-3-2.html">MAAS 3.2 release notes</a>
              	  </li>
		  <li>
              	    <a href="what-is-new-with-maas-3-1.html">MAAS 3.1 release notes</a>
              	  </li>
		  <li>
              	    <a href="what-is-new-with-maas-3-0.html">MAAS 3.0 release notes</a>
              	  </li>
		  <li>
              	    <a href="what-is-new-with-maas-2-9.html">MAAS 2.9 release notes</a>
              	  </li>
		  <li>
              	    <a href="what-is-new-with-maas-2-8.html">MAAS 2.8 release notes</a>
              	  </li>
		  <li>
              	    <a href="what-is-new-with-maas-2-7.html">MAAS 2.7 release notes</a>
              	  </li>
		</ul>
	      </details>
              <li>
		<details>
                  <summary><a href="general-reference.html">General</a></summary>
		  <ul>
		    <li>
		      <a href="installation-requirements.html">Installation requirements</a>
		    </li>
		    <li>
		      <a href="maas-settings-reference.html">MAAS settings</a>
		    </li>
		    <li>
		      <a href="https://launchpad.net/maas">Source code</a>
		    </li>
		    <li>
		      <a href="maas-documentation-style-guide.html">Doc style guide</a>
		    </li>
		    <li>
		      <a href="maas-glossary.html">Glossary</a>
		    </li>
		    <li>
		      <a href="https://ubuntu.com/community/code-of-conduct">Code of conduct</a>
		    </li>
		  </ul>
		</details>
	      </li>
              <li>
		<details>
		  <summary><a href="api.html">API</a></summary>
		  <ul>
		    <li>
                      <a href="api-authentication-reference.html">API authentication</a>
                    </li>
		    <li>
                      <a href="python-api-client-reference.html">Python API client</a>
                    </li>
		    <li>
                      <a href="/docs/api">API documentation</a>
                    </li>
		  </ul>
		</details>
              </li>
              <li>
		<details>
		  <summary><a href="scripts-reference.html">Scripts</a></summary>
		  <ul>
		    <li>
                      <a href="commissioning-scripts-reference.html">Commissioning scripts</a>
                    </li>
		    <li>
                      <a href="hardware-test-scripts-reference.html">Hardware test scripts</a>
                    </li>
		    <li>
                      <a href="maas-terraform-reference.html">Terraform</a>
                    </li>
		  </ul>
		</details>
              </li>
              <li>
		<details>
		  <summary><a href="log-reference.html">Logging</a></summary>
		  <ul>
		    <li>
                      <a href="event-logs-reference.html">Event logs</a>
                    </li>
		    <li>
                      <a href="audit-event-logs-reference.html">Audit event logs</a>
                    </li>
		    <li>
                      <a href="commissioning-logs-reference.html">Commissioning logs</a>
                    </li>
		    <li>
                      <a href="testing-logs-reference.html">Testing logs</a>
                    </li>
		  </ul>
		</details>
              </li>
              <li>
		<details>
		  <summary><a href="machine-parameters-reference.html">machine-parameters</a></summary>
		  <ul>
		    <li>
                      <a href=.html"power-drivers-reference.html">Power drivers</a>
                    </li>
		    <li>
                      <a href="storage-layouts-reference.html">Storage layouts</a>
                    </li>
		    <li>
                      <a href="device-labelling-reference.html">Device labelling</a>
                    </li>
		  </ul>
		</details>
              </li>
	    </ul>
	  </details>
	</li>
	<hr style="margin-top:15px;">
	<li>
	  <details>
	    <summary><a href="explanation.html">Explanation</a></summary>
	    <ul>
	      <li>
		<a href="about-maas.html">About MAAS</a>
	      </li>
	      <li>
		<details>
		  <summary>Networking</summary>
		  <ul>
		    <li>
		      <a href="about-maas-networks.html">MAAS networks</a>
		    </li>
		    <li>
		      <a href="about-tcp-ip-networks.html">TCP/IP primer</a>
		    </li>
		    <li>
		      <a href="about-dhcp.html">DHCP primer</a>
		    </li>
		    <li>
		      <a href="about-cloud-networking.html">Cloud networking primer</a>
		    </li>
		  </ul>
		</details>
	      </li>
	      <li>
		<a href="about-images.html">Images</a>
              </li>
	      <li>
		<details>
		  <summary>Controllers</summary>
		  <ul>
		    <li>
		      <a href="about-region-and-rack-controllers.html">Region and rack controllers</a>
		    </li>
		    <li>
		      <a href="about-high-availability.html">High availability</a>
		    </li>
		  </ul>
		</details>
	      </li>
	      <li>
		<details>
		  <summary>Machines and devices</summary>
		  <ul>
		    <li>
		      <a href="about-machines.html">Machines</a>
		    </li>
		    <li>
		      <a href="about-virtual-machines.html">Virtual machines</a>
		    </li>
		    <li>
		      <a href="device-labels.html">Device labels</a>
		    </li>
		  </ul>
		</details>
	      </li>
	      <li>
		<details>
		  <summary>Events and logging</summary>
		  <ul>
		    <li>
		      <a href="about-maas-events.html">MAAS events</a>
		    </li>
		    <li>
		      <a href="about-audit-events.html">Audit events</a>
		    </li>
		    <li>
		      <a href="about-log-files.html">MAAS logging</a>
		    </li>
		    <li>
		      <a href="about-maas-security.html">MAAS security</a>
		    </li>
		    <li>
		      <a href="about-maas-performance.html">MAAS performance</a>
		    </li>
		    <li>
		      <a href="about-ansible.html">Ansible</a>
		    </li>
		  </ul>
		</details>
	      </li>
	    </ul>
	  </details>
	</li>
      </ul>
    </div>
    <div class="container" style="float:right; width:65%; margin-top:40px; margin-right:30px">
      <h1>How to customise machines</h1><!-- "How to customise machines" -->
<p>MAAS provides the capability to customise machines.  This article will help you learn:</p>
<ul style="margin-left:4px; list-style-type:disc;">
<li><a href="#heading--how-to-customise-machine-storage">How to customise machine storage</a></li>
<li><a href="#heading--how-to-pre-seed-with-curtin">How to pre-seed with curtin</a></li>
<li><a href="#heading--cloud-init">How to pre-seed with cloud-init</a></li>
<li><a href="#heading--how-to-choose-ubuntu-kernels">How to choose Ubuntu kernels</a></li>
<li><a href="#heading--how-to-set-global-kernel-boot-options">How to set global kernel boot options</a></li>
<li><a href="#heading--create-tags-with-built-in-kernel-options">How to create tags with built-in kernel options</a></li>
<li><a href="#heading--how-to-use-resource-pools">How to use resource pools</a></li>
<li><a href="#heading--how-to-enable-hardware-sync-on-a-machine">How to enable hardware sync on a machine</a></li>
<li><a href="#heading--how-to-configure-hardware-sync-interval">How to configure hardware sync interval</a></li>
<li><a href="#heading--how-to-view-updates-from-hardware-sync">How to view updates from hardware sync</a></li>
</ul>
<p><a href="#heading--how-to-customise-machine-storage"><h2 id="heading--how-to-customise-machine-storage">How to customise machine storage</h2></a></p>
<p>This section will show you:</p>
<ul style="margin-left:4px; list-style-type:disc;">
<li><a href="#heading--how-to-set-global-storage-layouts">How to set global storage layouts</a></li>
<li><a href="#heading--how-to-set-per-machine-storage-layouts">How to set per-machine storage layouts</a></li>
<li><a href="#heading--how-to-set-default-erasure-configuration">How to set the default erasure configuration</a></li>
</ul>
<p>Note that layouts can be set globally and on a per-machine basis.  For additional information on storage layouts, see the <a href="storage-layouts-reference.html">Storage layouts reference</a> article.</p>
<p><a href="#heading--how-to-set-global-storage-layouts"><h3 id="heading--how-to-set-global-storage-layouts">How to set global storage layouts</h3></a></p>
<p>All machines will have a default layout applied when commissioned. An administrator can configure the default layout on the &lsquo;Settings&rsquo; page, under the &lsquo;Storage&rsquo; tab.</p>
<p><strong>NOTE:</strong> 
The new default will only apply to newly-commissioned machines.</p>
<p><a href="#heading--how-to-set-per-machine-storage-layouts"><h3 id="heading--how-to-set-per-machine-storage-layouts">How to set per-machine storage layouts</h3></a></p>
<p>An administrator can change the layout for a single machine as well as customise that layout providing this is done while the machine has a status of &lsquo;Ready&rsquo;. This is only possible via the CLI: to see how, click the &ldquo;CLI&rdquo; option for your version and delivery method above.</p>
<p><strong>NOTE:</strong> 
Only an administrator can modify storage at the block device level (providing the machine has a status of &lsquo;Ready&rsquo;).</p>
<p><a href="#heading--how-to-set-default-erasure-configuration"><h3 id="heading--how-to-set-default-erasure-configuration">How to set the default erasure configuration</h3></a></p>
<ol>
<li>
<p>Click on <em>Settings&rdquo; &ndash;&gt; Storage</em>.</p>
</li>
<li>
<p>Set or clear <em>Erase machines&rsquo; disks prior to releasing</em>.  If you set this option, users will be compelled to use disk erasure: that option will be pre-filled in the machine&rsquo;s view and the user will be unable to remove the option.</p>
</li>
</ol>
<p><a href="#heading--how-to-pre-seed-with-curtin"><h2 id="heading--how-to-pre-seed-with-curtin">How to pre-seed with curtin</h2></a></p>
<p>You can customise the Curtin installation by either editing the existing <code>curtin_userdata</code> template or by adding a custom file as described above.  For a flowchart, showing where Curtin and pre-seeding fits into the deployment picture, see <a href="how-to-acquire-images.html#heading--how-images-deploy">How images get deployed</a>.</p>
<p>Curtin provides hooks to execute custom code before and after installation takes place. These hooks are named <code>early</code> and <code>late</code> respectively, and they can both be overridden to execute the Curtin configuration in the ephemeral environment. Additionally, the <code>late</code> hook can be used to execute a configuration for a machine being installed, a state known as in-target.</p>
<p>Curtin commands look like this:</p>
<pre><code>foo: ["command", "--command-arg", "command-arg-value"]
</code></pre>
<p>Each component of the given command makes up an item in an array. Note, however, that the following won&rsquo;t work:</p>
<pre><code>foo: ["sh", "-c", "/bin/echo", "foobar"]
</code></pre>
<p>This syntax won&rsquo;t work because the value of <code>sh</code>&lsquo;s <code>-c</code> argument is itself an entire command. The correct way to express this is:</p>
<pre><code>foo: ["sh", "-c", "/bin/echo foobar"]
</code></pre>
<p>The following is an example of an early command that will run before the installation takes place in the ephemeral environment. The command pings an external machine to signal that the installation is about to start:</p>
<pre><code class="language-bash">early_commands:
  signal: [&quot;wget&quot;, &quot;--no-proxy&quot;, &quot;http://example.com/&quot;, &quot;--post-data&quot;, &quot;system_id=&amp;signal=starting_install&quot;, &quot;-O&quot;, &quot;/dev/null&quot;]
</code></pre>
<p>The following is an example of two late commands that run after installation is complete. Both run in-target, on the machine being installed.</p>
<p>The first command adds a PPA to the machine. The second command creates a file containing the machineâ€™s system ID:</p>
<pre><code class="language-bash">late_commands:
  add_repo: [&quot;curtin&quot;, &quot;in-target&quot;, &quot;--&quot;, &quot;add-apt-repository&quot;, &quot;-y&quot;, &quot;ppa:my/ppa&quot;]
  custom: [&quot;curtin&quot;, &quot;in-target&quot;, &quot;--&quot;, &quot;sh&quot;, &quot;-c&quot;, &quot;/bin/echo -en 'Installed ' &gt; /tmp/maas_system_id&quot;]
</code></pre>
<p><a href="#heading--cloud-init"><h2 id="heading--cloud-init">How to pre-seed with cloud-init</h2></a></p>
<p>For a flowchart, showing where cloud-init fits into the deployment picture, see <a href="how-to-acquire-images.html#heading--how-images-deploy">How images get deployed</a>.</p>
<p>To customise cloud-init via the web UI:</p>
<ol>
<li>
<p>Select <em>Machines</em>.</p>
</li>
<li>
<p>Select a machine.</p>
</li>
<li>
<p>Select <em>Actions &gt; Deploy</em>.</p>
</li>
<li>
<p>Checkbox <em>Cloud-init user-data&hellip;</em>.</p>
</li>
<li>
<p>Paste, upload, or drag-and-drop the script into the box.</p>
</li>
<li>
<p>Select <em>Start deployment for machine</em>.</p>
</li>
</ol>
<p><a href="#heading--how-to-choose-ubuntu-kernels"><h2 id="heading--how-to-choose-ubuntu-kernels">How to choose Ubuntu kernels</h2></a></p>
<p>This section will show you:</p>
<ul style="margin-left:4px; list-style-type:disc;">
<li><a href="#heading--set-a-default-minimum-kernel-for-enlistment-and-commissioning">How to set a default minimum kernel for enlistment and commissioning</a></li>
<li><a href="#heading--set-a-minimum-deploy-kernel-for-a-machine">How to set a minimum deployment kernel for a machine</a></li>
<li><a href="#heading--set-a-specific-kernel-during-machine-deployment">How to set a specific kernel during machine deployment</a></li>
</ul>
<p><a href="#heading--set-a-default-minimum-kernel-for-enlistment-and-commissioning"><h3 id="heading--set-a-default-minimum-kernel-for-enlistment-and-commissioning">How to set a default minimum kernel for enlistment and commissioning</h3></a></p>
<p>To set the default minimum enlistment and commissioning kernel for all machines:</p>
<ol>
<li>
<p>Select <em>Settings</em>.</p>
</li>
<li>
<p>Select <em>Configuration</em>.</p>
</li>
<li>
<p>Select <em>Commissioning</em>.</p>
</li>
<li>
<p>Select a kernel from the <em>Default minimum kernel version</em> drop-down.</p>
</li>
<li>
<p>Select <em>Save</em> to register your changes.</p>
</li>
</ol>
<p><a href="#heading--how-to-set-global-kernel-boot-options"><h2 id="heading--how-to-set-global-kernel-boot-options">How to set global kernel boot options</h2></a></p>
<p>To set global kernel boot options:</p>
<ol>
<li>
<p>Select <em>Settings</em>.</p>
</li>
<li>
<p>Select <em>Configuration &gt; Kernel parameters</em>.</p>
</li>
<li>
<p>Enter the <em>Global boot parameters always passed to the kernel</em> in the text box.</p>
</li>
<li>
<p>Select <em>Save</em> to register your changes.</p>
</li>
</ol>
<p><a href="#heading--create-tags-with-built-in-kernel-options"><h2 id="heading--create-tags-with-built-in-kernel-options">How to create tags with built-in kernel options</h2></a></p>
<p>You can create tags with embedded kernel boot options.  When you apply such tags to a machine, those kernel boot options will be applied to that machine on the next deployment.</p>
<p>To create a tag with embedded kernel boot options, use the following command:</p>
<pre><code class="language-nohighlight">maas $PROFILE tags create name='$TAG_NAME' \
    comment='$TAG_COMMENT' kernel_opts='$KERNEL_OPTIONS'
</code></pre>
<p>For example:</p>
<pre><code class="language-nohighlight">maas admin tags create name='nomodeset_tag' \
    comment='nomodeset_kernel_option' kernel_opts='nomodeset vga'
</code></pre>
<p>This command yields the following results:</p>
<pre><code class="language-nohighlight">Success.
Machine-readable output follows:
{
    &quot;name&quot;: &quot;nomodeset_tag&quot;,
    &quot;definition&quot;: &quot;,
    &quot;comment&quot;: &quot;nomodeset_kernel_option&quot;,
    &quot;kernel_opts&quot;: &quot;nomodeset vga&quot;,
    &quot;resource_uri&quot;: &quot;/MAAS/api/2.0/tags/nomodeset_tag/&quot;
}
</code></pre>
<p>You can check your work with a modified form of the listing command:</p>
<pre><code class="language-nohighlight">maas admin tags read | jq -r \
'([&quot;tag_name&quot;,&quot;tag_comment&quot;,&quot;kernel_options&quot;]
|(.,map(length*&quot;-&quot;))),(.[]|[.name,.comment,.kernel_opts]) 
| @tsv' | column -t
</code></pre>
<p>This should give you results something like this:</p>
<pre><code class="language-nohighlight">tag_name             tag_comment                  kernel_options                     
--------             -----------                  --------------                     
virtual                                                                              
new_tag              a-new-tag-for-test-purposes                                     
pod-console-logging  console=tty1                 console=ttyS0                      
nomodeset_tag        nomodeset_kernel_option      nomodeset       vga
</code></pre>
<p><a href="#heading--how-to-use-resource-pools"><h2 id="heading--how-to-use-resource-pools">How to use resource pools</h2></a></p>
<p>This section will explain:</p>
<p><a href="#heading--how-to-enable-hardware-sync-on-a-machine"><h2 id="heading--how-to-enable-hardware-sync-on-a-machine">How to enable hardware sync on a machine</h2></a></p>
<p><strong>NOTE:</strong> 
MAAS hardware sync may leak the MAAS admin API token.  You may need to rotate all admin tokens and re-deploy all machines that have hardware sync enabled.  To find out whether this is an issue, and how to fix it, see the <a href="how-to-troubleshoot-maas.html#heading--Manually-swapping-the-MAAS-admin-API-token">troubleshooting instructions</a> for this problem.</p>
<p>To enable Hardware sync on a machine:</p>
<ol>
<li>
<p>Select <em>Machines</em>.</p>
</li>
<li>
<p>Select a machine(s).</p>
</li>
<li>
<p>Select <em>Actions &gt; Deploy</em>*.</p>
</li>
<li>
<p>Check <em>Periodically synch hardware</em>.</p>
</li>
<li>
<p>Select <em>Start deployment&hellip;</em>.</p>
</li>
</ol>
<p>Once you&rsquo;ve enabled hardware sync, any changes you make to the physical device, or to the VM through the VM host, will show up in the appropriate page for the deployed machine as soon as the sync interval has passed.</p>
<p><a href="#heading--how-to-view-updates-from-hardware-sync"><h2 id="heading--how-to-view-updates-from-hardware-sync">How to view updates from hardware sync</h2></a></p>
<p>To view updates from hardware sync:</p>
<ol>
<li>
<p>Select <em>Machines</em>.</p>
</li>
<li>
<p>Select the machine in question.</p>
</li>
</ol>
<p>Any changes to the machine&rsquo;s hardware configuration will be updated on the next sync.  The status bar at the bottom will show times for <em>Last synced</em> and <em>Next sync</em>. Updated BMC configuration and tags can also be viewed on the machine itself.</p>
<p><a href="#heading--how-to-configure-hardware-sync-interval"><h2 id="heading--how-to-configure-hardware-sync-interval">How to configure hardware sync interval</h2></a></p>
<p>The hardware sync interval is configured globally in <a href="how-to-change-maas-settings.html#heading--Deployment">MAAS deployment settings</a>.</p>
    </div>
  </body>
</html>