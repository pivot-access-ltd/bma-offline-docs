<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="css/stylesheet.css" />
    <style>
      #selector a:link{color:black;}
      #selector a:visited{color:black;}
      #selector a:active{color:black;}
      #selector a:hover{color:blue;}
      #sidebar a:link{color:black;}
      #sidebar a:visited{color:black;}
      #sidebar a:active{color:black;}
      #sidebar a:hover{color:blue;}
      ul {margin-left:0;margin-top:0;margin-bottom:0;list-style-type:none;padding-left:20px;}
      li {margin: 4px 0;}
      details {margin-top:0;margin-bottom:0;}
      details > summary {
	  padding: 0px;
	  margin-top: 0px;
	  margin-bottom: 0px;
	  width: 200px;
	  background-color: #ffffff;
	  border: none;
	  cursor: pointer;
    	  list-style-type: "< ";
	  direction: rtl;
      }
      details[open] > summary {
	  list-style-type: "v ";
      }
    </style>
  </head>
  <body>
    <div id="selector" style="top:0; position:fixed; float:right; background-color:#d9d9d9; width:100%;border-bottom:1px solid black;">
      &nbsp;&nbsp;
      <strong>Offline docs
      </strong>
      <a href="https://maas.io/docs">(switch to live docs)
      </a>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <span style="background-color:white;border-top:1px solid black; border-left:1px solid black; border-right:1px solid black; border-bottom:5px solid white;">
        &nbsp;UI-only&nbsp;
      </span>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <a href="../cli/how-to-make-machines-available.html">
        CLI-only
      </a>
    </div>
    <div id="sidebar" style="float:left; width:25%;margin-top:40px; margin-left:20px">
      <ul>
	<li>
          <a href="maas-documentation.html"><b>MAAS Documentation</b></a>
	</li>
	<hr style="margin-top:15px;">
	<li>
          <details>
            <summary><a href="tutorials.html">Tutorials</a></summary>
            <ul>
              <li>
		<details>
                  <summary>Try out MAAS</summary>
		  <ul>
		    <li>
		      <a href="bootstrap-maas.html">Bootstrap MAAS</a>
		    </li>
		    <li>
		      <a href="get-to-know-your-machines.html">Get to know your machines</a>
		    </li>
		  </ul>
		</details>
              </li>
	      <li>
		<a href="try-out-the-maas-cli.html">Try out the MAAS CLI</a>
	      </li>
	      <li>
		<a href="create-custom-images.html">Create custom images</a>
	      </li>
	      <li>
		<a href="get-fancy-cli-output.html">Get fancy CLI output</a>
	      </li>
              <li>
		<details>
                  <summary>Primer tutorials</summary>
		  <ul>
		    <li>
		      <a href="primer-tutorial-the-osi-model.html">OSI model tutorial</a>
		    </li>
		  </ul>
		</details>
              </li>
            </ul>
          </details>
	</li>
	<hr style="margin-top:15px;">
	<li>
          <details>
            <summary><a href="how-to-guides.html">How-to guides</a></summary>
            <ul>
              <li>
		<details>
                  <summary><a href="how-to-get-started-with-maas.html">Get started with MAAS</a></summary>
		  <ul>
                    <li>
                      <a href="how-to-do-a-fresh-install-of-maas.html">Do a fresh install of MAAS</a>
		    </li>
		    <li>
                      <a href="how-to-upgrade-maas.html">Upgrade MAAS</a>
		    </li>
		    <li>
                      <a href="how-to-spin-up-maas-with-ansible.html">Spin up MAAS with Ansible</a>
		    </li>
		  </ul>
		</details>
              </li>
              <li>
		<details>
                  <summary><a href="how-to-manage-networks.html">Manage networks</a></summary>
		  <ul>
                    <li>
                      <a href="how-to-connect-maas-networks.html">Connect MAAS networks</a>
                    </li>
                    <li>
                      <a href="how-to-enable-dhcp.html">Enable DHCP</a>
                    </li>
                    <li>
                      <a href="how-to-use-availability-zones.html">Use availability zones</a>
                    </li>
		  </ul>
		</details>
              </li>
              <li>
		<details>
                  <summary><a href="how-to-use-images.html">Use images</a></summary>
		  <ul>
                    <li>
                      <a href="how-to-use-standard-images.html">Use standard images</a>
                    </li>
                    <li>
                      <a href="how-to-mirror-images-locally.html">Mirror images locally</a>
                    </li>
                    <li>
                      <a href="how-to-customise-images.html">Customise images</a>
                    </li>
                    <li>
                      <a href="how-to-employ-vmware-images.html">Employ VMware images</a>
                    </li>
                    <li>
                      <a href="how-to-deploy-a-real-time-kernel.html">Deploy a RT kernel</a>
                    </li>
		  </ul>
		</details>
              </li>
              <li>
		<details>
                  <summary><a href="how-to-manage-controllers.html">Manage controllers</a></summary>
		  <ul>
		    <li>
		      <a href="how-to-configure-controllers.html">Configure controllers</a>
		    </li>
		    <li>
		      <a href="how-to-enable-high-availability.html">Enable high availability</a>
		    </li>
		  </ul>
		</details>
              </li>
              <li>
		<details>
                  <summary><a href="how-to-manage-machines.html">Manage machines</a></summary>
		  <ul>
		    <li>
		      <a href="how-to-make-machines-available.html">Make machines available</a>
		    </li>
		    <li>
		      <a href="how-to-customise-machines.html">Customise machines</a>
		    </li>
		    <li>
		      <a href="how-to-put-machines-to-work.html">Put machines to work</a>
		    </li>
		  </ul>
		</details>
              </li>
              <li>
		<details>
                  <summary><a href="how-to-use-virtual-machines.html">Use virtual machines</a></summary>
		  <ul>
		    <li>
		      <a href="how-to-set-up-lxd.html">Set up LXD</a>
		    </li>
		    <li>
		      <a href="how-to-manage-vm-hosts.html">Manage VM hosts</a>
		    </li>
		    <li>
		      <a href="how-to-manage-virtual-machines.html">Manage virtual machines</a>
		    </li>
		  </ul>
		</details>
              </li>
              <li>
		<details>
                  <summary><a href="how-to-label-devices.html">Label devices</a></summary>
		  <ul>
		    <li>
		      <a href="how-to-tag-machines.html">Tag machines</a>
		    </li>
		    <li>
		      <a href="how-to-annotate-machines.html">Annotate machines</a>
		    </li>
		    <li>
		      <a href="how-to-use-machine-tags.html">Use machine tags</a>
		    </li>
		    <li>
		      <a href="how-to-use-controller-tags.html">Use controller tags</a>
		    </li>
		    <li>
		      <a href="how-to-use-storage-tags.html">Use storage tags</a>
		    </li>
		    <li>
		      <a href="how-to-use-network-tags.html">Use network tags</a>
		    </li>
		  </ul>
		</details>
              </li>
	      <li>
		<details>
                  <summary><a href="how-to-secure-maas.html">Secure MAAS</a></summary>
		  <ul>
		    <li>
		      <a href=.html"how-to-improve-maas-security.html">Improve MAAS security</a>
		    </li>
		    <li>
		      <a href="how-to-manage-user-accounts.html">Manage user accounts</a>
		    </li>
		    <li>
		      <a href="how-to-enable-maas-native-tls.html">Enable MAAS native TLS</a>
		    </li>
		    <li>
		      <a href="how-to-use-hashicorp-vault-with-maas.html">Use Vault with MAAS</a>
		    </li>
		    <li>
		      <a href="how-to-set-up-an-air-gapped-maas.html">Set up an air-gapped MAAS</a>
		    </li>
		  </ul>
		</details>
              </li>
	      <li>
		<details>
                  <summary><a href="how-to-operate-maas.html">Operate MAAS</a></summary>
		  <ul>
		    <li>
		      <a href=.html"how-to-find-machines.html">Find machines</a>
		    </li>
		    <li>
		      <a href="how-to-back-up-maas.html">Back up MAAS</a>
		    </li>
		    <li>
		      <a href="how-to-monitor-maas.html">Monitor MAAS</a>
		    </li>
		    <li>
		      <a href="how-to-audit-maas.html">Audit MAAS</a>
		    </li>
		    <li>
		      <a href="how-to-troubleshoot-maas">Troubleshoot MAAS</a>
		    </li>
		  </ul>
		</details>
              </li>
	      <li>
		<details>
                  <summary><a href="how-to-give-and-receive-help.html">Give and receive help</a></summary>
		  <ul>
		    <li>
		      <a href=.html"how-to-use-the-maas-discourse-forum.html">Use our discourse forum</a>
		    </li>
		    <li>
		      <a href="https://ubuntu.com/pro">Get support</a>
		    </li>
		    <li>
		      <a href="how-to-request-new-features.html">Request new features</a>
		    </li>
		    <li>
		      <a href="how-to-review-and-report-bugs.html">Review and report bugs</a>
		    </li>
		    <li>
		      <a href="how-to-contribute-documentation.html">Contribute documentation</a>
		    </li>
		  </ul>
		</details>
              </li>
            </ul>
          </details>
	</li>
	<hr style="margin-top:15px;">
	<li>
          <details>
            <summary><a href="reference.html">Reference</a></summary>
            <ul>
	      <details>
		<summary><a href="maas-release-notes.html">Release notes</a></summary>
		<ul>
		  <li>
		    <a href="what-is-new-with-maas-3-4.html">MAAS 3.4 release notes</a>
              	  </li>
		  <li>
              	    <a href="what-is-new-with-maas-3-3.html">MAAS 3.3 release notes</a>
              	  </li>
		  <li>
              	    <a href="what-is-new-with-maas-3-2.html">MAAS 3.2 release notes</a>
              	  </li>
		  <li>
              	    <a href="what-is-new-with-maas-3-1.html">MAAS 3.1 release notes</a>
              	  </li>
		  <li>
              	    <a href="what-is-new-with-maas-3-0.html">MAAS 3.0 release notes</a>
              	  </li>
		  <li>
              	    <a href="what-is-new-with-maas-2-9.html">MAAS 2.9 release notes</a>
              	  </li>
		  <li>
              	    <a href="what-is-new-with-maas-2-8.html">MAAS 2.8 release notes</a>
              	  </li>
		  <li>
              	    <a href="what-is-new-with-maas-2-7.html">MAAS 2.7 release notes</a>
              	  </li>
		</ul>
	      </details>
              <li>
		<details>
                  <summary><a href="general-reference.html">General</a></summary>
		  <ul>
		    <li>
		      <a href="installation-requirements.html">Installation requirements</a>
		    </li>
		    <li>
		      <a href="maas-settings-reference.html">MAAS settings</a>
		    </li>
		    <li>
		      <a href="https://launchpad.net/maas">Source code</a>
		    </li>
		    <li>
		      <a href="maas-documentation-style-guide.html">Doc style guide</a>
		    </li>
		    <li>
		      <a href="maas-glossary.html">Glossary</a>
		    </li>
		    <li>
		      <a href="https://ubuntu.com/community/code-of-conduct">Code of conduct</a>
		    </li>
		  </ul>
		</details>
	      </li>
              <li>
		<details>
		  <summary><a href="api.html">API</a></summary>
		  <ul>
		    <li>
                      <a href="api-authentication-reference.html">API authentication</a>
                    </li>
		    <li>
                      <a href="python-api-client-reference.html">Python API client</a>
                    </li>
		    <li>
                      <a href="/docs/api">API documentation</a>
                    </li>
		  </ul>
		</details>
              </li>
              <li>
		<details>
		  <summary><a href="scripts-reference.html">Scripts</a></summary>
		  <ul>
		    <li>
                      <a href="commissioning-scripts-reference.html">Commissioning scripts</a>
                    </li>
		    <li>
                      <a href="hardware-test-scripts-reference.html">Hardware test scripts</a>
                    </li>
		    <li>
                      <a href="maas-terraform-reference.html">Terraform</a>
                    </li>
		  </ul>
		</details>
              </li>
              <li>
		<details>
		  <summary><a href="log-reference.html">Logging</a></summary>
		  <ul>
		    <li>
                      <a href="event-logs-reference.html">Event logs</a>
                    </li>
		    <li>
                      <a href="audit-event-logs-reference.html">Audit event logs</a>
                    </li>
		    <li>
                      <a href="commissioning-logs-reference.html">Commissioning logs</a>
                    </li>
		    <li>
                      <a href="testing-logs-reference.html">Testing logs</a>
                    </li>
		  </ul>
		</details>
              </li>
              <li>
		<details>
		  <summary><a href="machine-parameters-reference.html">machine-parameters</a></summary>
		  <ul>
		    <li>
                      <a href=.html"power-drivers-reference.html">Power drivers</a>
                    </li>
		    <li>
                      <a href="storage-layouts-reference.html">Storage layouts</a>
                    </li>
		    <li>
                      <a href="device-labelling-reference.html">Device labelling</a>
                    </li>
		  </ul>
		</details>
              </li>
	    </ul>
	  </details>
	</li>
	<hr style="margin-top:15px;">
	<li>
	  <details>
	    <summary><a href="explanation.html">Explanation</a></summary>
	    <ul>
	      <li>
		<a href="about-maas.html">About MAAS</a>
	      </li>
	      <li>
		<details>
		  <summary>Networking</summary>
		  <ul>
		    <li>
		      <a href="about-maas-networks.html">MAAS networks</a>
		    </li>
		    <li>
		      <a href="about-tcp-ip-networks.html">TCP/IP primer</a>
		    </li>
		    <li>
		      <a href="about-dhcp.html">DHCP primer</a>
		    </li>
		    <li>
		      <a href="about-cloud-networking.html">Cloud networking primer</a>
		    </li>
		  </ul>
		</details>
	      </li>
	      <li>
		<a href="about-images.html">Images</a>
              </li>
	      <li>
		<details>
		  <summary>Controllers</summary>
		  <ul>
		    <li>
		      <a href="about-region-and-rack-controllers.html">Region and rack controllers</a>
		    </li>
		    <li>
		      <a href="about-high-availability.html">High availability</a>
		    </li>
		  </ul>
		</details>
	      </li>
	      <li>
		<details>
		  <summary>Machines and devices</summary>
		  <ul>
		    <li>
		      <a href="about-machines.html">Machines</a>
		    </li>
		    <li>
		      <a href="about-virtual-machines.html">Virtual machines</a>
		    </li>
		    <li>
		      <a href="device-labels.html">Device labels</a>
		    </li>
		  </ul>
		</details>
	      </li>
	      <li>
		<details>
		  <summary>Events and logging</summary>
		  <ul>
		    <li>
		      <a href="about-maas-events.html">MAAS events</a>
		    </li>
		    <li>
		      <a href="about-audit-events.html">Audit events</a>
		    </li>
		    <li>
		      <a href="about-log-files.html">MAAS logging</a>
		    </li>
		    <li>
		      <a href="about-maas-security.html">MAAS security</a>
		    </li>
		    <li>
		      <a href="about-maas-performance.html">MAAS performance</a>
		    </li>
		    <li>
		      <a href="about-ansible.html">Ansible</a>
		    </li>
		  </ul>
		</details>
	      </li>
	    </ul>
	  </details>
	</li>
      </ul>
    </div>
    <div class="container" style="float:right; width:65%; margin-top:40px; margin-right:30px">
      <h1>How to make machines available</h1><!-- "How to make machines available" -->
<p>This article explains:</p>
<ul style="margin-left:4px; list-style-type:disc;">
<li><a href="#heading--how-to-create-delete-and-configure-machines">How to create, delete, and configure machines</a></li>
<li><a href="#heading--how-to-clone-machines">How to clone machines</a></li>
<li><a href="#heading--how-to-examine-machines-and-machine-details">How to examine machines and machine details</a></li>
<li><a href="#heading--how-to-use-resource-pools">How to use resource pools</a></li>
<li><a href="#heading--how-to-use-machine-storage">How to use machine storage</a></li>
</ul>
<p>This article also provides a <a href="#heading--storage-layouts-reference">storage layouts reference</a>.</p>
<p>Most of the day-to-day work of managing machines is covered here. Utilising machines to do work &ndash; for example, commissioning, testing, and deploying them &ndash; is discussed in <a href="how-to-put-machines-to-work.html">How to deploy machines</a>.</p>
<p><a href="#heading--how-to-create-delete-and-configure-machines"><h2 id="heading--how-to-create-delete-and-configure-machines">How to create, delete, and configure machines</h2></a></p>
<p>This section shows you:</p>
<ul style="margin-left:4px; list-style-type:disc;">
<li><a href="#heading--how-to-add-a-machine-manually">How to add a machine manually</a></li>
<li><a href="#heading--how-to-add-machines-via-a-chassis">How to add machines via a chassis</a></li>
<li><a href="#heading--usb-pci-devices">How to manage attached USB and PCI devices</a></li>
</ul>
<p><a href="#heading--how-to-add-a-machine-manually"><h3 id="heading--how-to-add-a-machine-manually">How to add a machine manually</h3></a></p>
<p>To add a machine manually,</p>
<ol>
<li>
<p>Select <em>Machines</em>.</p>
</li>
<li>
<p>Select <em>Add hardware &gt; Machine.</em></p>
</li>
<li>
<p>Fill in the form and select <em>Save machine</em> to register your choice.</p>
</li>
<li>
<p>Alternatively, you can select <em>Save and add another</em> to register your choice and repeat the form to add another machine.</p>
</li>
</ol>
<p>The fields on the &ldquo;Add machine&rdquo; screen include the following items:</p>
<ul style="margin-left:4px; list-style-type:disc;">
<li>
<p><strong>Machine name</strong>: This field is used to identify the machine to the user.  It can be set to anything, though it is often set to the MAC address of the machine in question.  This field is optional, in that MAAS will assign a unique, nonsense name if you leave it blank.  You can change this nonsense name later, if desired.</p>
</li>
<li>
<p><strong>Domain</strong>: This field sets the domain name of the domain managed by MAAS.  It can be set to anything; MAAS assigns the domain name &ldquo;maas&rdquo; by default.</p>
</li>
<li>
<p><strong>Architecture</strong>: This field refers to the architecture of the machine being added.</p>
</li>
<li>
<p><strong>Minimum Kernel</strong>: This field supplies a drop-down of possible kernels available for deployment on this machine.</p>
</li>
<li>
<p><strong>Zone</strong>: This field allows you to set the availability zone, selected from AZs that you have already created (if any).</p>
</li>
<li>
<p><strong>Resource pool</strong>: This field allows you to set the resource pool for this machine, selected from pools you have already created (if any).</p>
</li>
<li>
<p><strong>MAC Address</strong>: You should fill in this field with the MAC address of the machine you are adding.  Note that the MAC address entered here must use a colon (&ldquo;:&rdquo;) separator, although some MAC addresses are written with dash (&ldquo;-&ldquo;) separators.</p>
</li>
<li>
<p><strong>Power type</strong>: You must select the power type supported by the machine you are adding, and fill in additional required fields that appear.  See <a href="power-management-reference.html">Power management reference</a> for details on the available power types and the relevant parameters for each type.</p>
</li>
</ul>
<p><a href="#heading--how-to-add-machines-via-a-chassis"><h3 id="heading--how-to-add-machines-via-a-chassis">How to add machines via a chassis</h3></a></p>
<p>You can use the chassis feature to add multiple machines at once. To do this, instead of selecting <em>Machine</em> as above, choose <em>Chassis</em> from the drop-down menu.  The required fields will change based on the type of chassis you choose.</p>
<p><strong>NOTE:</strong> 
As with the manual method, the underlying machines will require netbooting.</p>
<p><a href="#heading--usb-pci-devices"><h3 id="heading--usb-pci-devices">How to manage attached USB and PCI devices</h3></a></p>
<p>To delete PCI/USB devices from the machine in any machine state, via the CLI only, using the following command:</p>
<pre><code class="language-nohighlight">maas $PROFILE node-device delete $SYSTEM_ID $DEVICE_ID
</code></pre>
<p>where:</p>
<ul style="margin-left:4px; list-style-type:disc;">
<li>$PROFILE   = your user profile (e.g., &ldquo;admin&rdquo;)</li>
<li>$SYSTEM_ID = the ID of the machine in question (e.g., &ldquo;ngx7ry&rdquo;)</li>
<li>$DEVICE_ID = the ID of the device you want to delete </li>
</ul>
<p>If the device is still present in the system, it will be recognised again (and thus &ldquo;recreated&rdquo;) when the machine is commissioned again.</p>
<p><a href="#heading--how-to-clone-machines"><h2 id="heading--how-to-clone-machines">How to clone machines</h2></a></p>
<ol>
<li>
<p>Select <em>Machines</em>.</p>
</li>
<li>
<p>Checkbox the machine you want to overwrite with a cloned copy of another machine.</p>
</li>
<li>
<p>Select <em>Actions &gt; Clone from</em>.</p>
</li>
<li>
<p><em>Select the source machine</em>.</p>
</li>
<li>
<p><em>Select what to clone</em>.</p>
</li>
<li>
<p>Select <em>Clone to machine</em>.</p>
</li>
</ol>
<p><a href="#heading--how-to-examine-machines-and-machine-details"><h2 id="heading--how-to-examine-machines-and-machine-details">How to examine machines and machine details</h2></a></p>
<p>This section describes the various ways you can evaluate the health and status of your MAAS machines, using the machine list.  It will show you:</p>
<ul style="margin-left:4px; list-style-type:disc;">
<li><a href="#heading--how-to-view-the-machine-list">How to view the machine list</a></li>
<li><a href="#heading--how-to-view-machine-details">How to view machine details</a></li>
<li><a href="#heading--machine-interfaces">How to find network info for a machine</a></li>
<li><a href="#heading--how-to-find-machine-storage-info">How to find storage info for a machine</a></li>
<li><a href="#heading--commissioning-log">How to find commissioning logs</a></li>
<li><a href="#heading--hardware-tests">How to find machine hardware &amp; test logs</a></li>
<li><a href="#heading--raw-log-output">How to find raw log output for a machine</a></li>
<li><a href="#heading--event-logs">How to find a machine&rsquo;s event logs</a></li>
<li><a href="#heading--machine-config">How to find machine configuration info</a></li>
</ul>
<p><a href="#heading--how-to-view-the-machine-list"><h3 id="heading--how-to-view-the-machine-list">How to view the machine list</h3></a></p>
<p>To view the machine list, simply select <em>Machines</em>.</p>
<p><a href="#heading--how-to-view-machine-details"><h3 id="heading--how-to-view-machine-details">How to view machine details</h3></a></p>
<p>To open a detailed view of a machine&rsquo;s status and configuration:</p>
<ol>
<li>
<p>Select <em>Machines</em>.</p>
</li>
<li>
<p>Click on a machine name.</p>
</li>
</ol>
<p><a href="#heading--machine-interfaces"><h3 id="heading--machine-interfaces">How to find network info for a machine</h3></a></p>
<p>To find network info for a specific machine:</p>
<ol>
<li>
<p>Select <em>Machines</em>.</p>
</li>
<li>
<p>Click on a machine name.</p>
</li>
<li>
<p>Select <em>Network</em>.</p>
</li>
</ol>
<p><a href="#heading--how-to-find-machine-storage-info"><h3 id="heading--how-to-find-machine-storage-info">How to find machine storage info</h3></a></p>
<p>To view/edit machine storage info:</p>
<ol>
<li>
<p>Select <em>Machines</em>.</p>
</li>
<li>
<p>Click on a machine name.</p>
</li>
<li>
<p>Select <em>Storage</em>.</p>
</li>
</ol>
<p><a href="#heading--How-to-view-PCI-devices-for-a-given-machine"><h3 id="heading--How-to-view-PCI-devices-for-a-given-machine">How to view PCI devices for a given machine</h3></a></p>
<p>To view the list of PCI devices associated with a given machine:</p>
<ol>
<li>
<p>Select <em>Machines</em>.</p>
</li>
<li>
<p>Click on a machine name.</p>
</li>
<li>
<p>Select <em>PCI devices</em></p>
</li>
</ol>
<p><a href="#heading--How-to-view-USB-devices-for-a-given-machine"><h3 id="heading--How-to-view-USB-devices-for-a-given-machine">How to view USB devices for a given machine</h3></a></p>
<p>To view the list of USB devices associated with a given machine:</p>
<ol>
<li>
<p>Select <em>Machines</em>.</p>
</li>
<li>
<p>Click on a machine name.</p>
</li>
<li>
<p>Select <em>USB</em>.</p>
</li>
</ol>
<p><a href="#heading--commissioning-log"><h3 id="heading--commissioning-log">How to find commissioning logs</h3></a></p>
<p>To view commissioning logs for a given machine:</p>
<ol>
<li>
<p>Select <em>Machines</em>.</p>
</li>
<li>
<p>Click on a machine name.</p>
</li>
<li>
<p>Select <em>Commissioning</em>.</p>
</li>
<li>
<p>To examine an individual log, select <em>View details</em> at the end of the row for that log.</p>
</li>
<li>
<p>To review the commissioning history, select <em>View previous tests</em> at the end of the row for that log.</p>
</li>
</ol>
<p><a href="#heading--hardware-tests"><h3 id="heading--hardware-tests">How to find machine hardware &amp; test logs</h3></a></p>
<p>To view commissioning logs for a given machine:</p>
<ol>
<li>
<p>Select <em>Machines</em>.</p>
</li>
<li>
<p>Click on a machine name.</p>
</li>
<li>
<p>Select <em>Test</em>.</p>
</li>
<li>
<p>To examine an individual log, select <em>View details</em> at the end of the row for that log.</p>
</li>
<li>
<p>To review the commissioning history, select <em>View previous tests</em> at the end of the row for that log.</p>
</li>
</ol>
<p><a href="#heading--raw-log-output"><h3 id="heading--raw-log-output">How to find raw log output for a machine</h3></a></p>
<ol>
<li>
<p>Select <em>Machines</em>.</p>
</li>
<li>
<p>Click on the machine name.</p>
</li>
<li>
<p>Select <em>Logs</em>.</p>
</li>
<li>
<p>Select <em>Installation output</em>.</p>
</li>
</ol>
<p><a href="#heading--event-logs"><h3 id="heading--event-logs">How to find a machine&rsquo;s event logs</h3></a></p>
<ol>
<li>
<p>Select <em>Machines</em>.</p>
</li>
<li>
<p>Click on the machine name.</p>
</li>
<li>
<p>Select <em>Logs</em>.</p>
</li>
<li>
<p>Using the <em>Download</em> dropdown, you can download logs in various formats.</p>
</li>
</ol>
<p><a href="#heading--machine-config"><h3 id="heading--machine-config">How to find machine configuration info</h3></a></p>
<ol>
<li>
<p>Select <em>Machines</em>.</p>
</li>
<li>
<p>Click on the machine name.</p>
</li>
<li>
<p>Select <em>Configuration</em>.</p>
</li>
</ol>
<p><a href="#heading--how-to-use-resource-pools"><h2 id="heading--how-to-use-resource-pools">How to use resource pools</h2></a></p>
<p>This section will explain:</p>
<ul style="margin-left:4px; list-style-type:disc;">
<li><a href="#heading--add-a-resource-pool">How to add a resource pool</a></li>
<li><a href="#heading--deleting-a-resource-pool">How to delete a resource pool</a></li>
<li><a href="#heading--add-a-node-to-a-resource-pool">How to add a node to a resource pool</a></li>
<li><a href="#heading--removing-a-node-from-a-resource-pool">How to remove a node from a resource pool</a></li>
<li><a href="#heading--add-a-vm-host-to-a-resource-pool">How to add a VM host to a resource pool</a></li>
<li><a href="#heading--removing-a-vm-host-from-a-resource-pool">How to remove a VM host from a resource pool</a></li>
</ul>
<p>Administrators can manage resource pools on the Machines page in the web UI, under the Resource pools tab.   Also note that all MAAS installations have a resource pool named &ldquo;default.&rdquo; MAAS automatically adds new machines to the default resource pool.</p>
<p><a href="#heading--add-a-resource-pool"><h3 id="heading--add-a-resource-pool">How to add a resource pool</h3></a></p>
<ol>
<li>
<p>Select <em>Organisation &gt; Pools &gt; Add pool</em>.</p>
</li>
<li>
<p>Enter a <em>Name</em> and &ndash; optionally &ndash; a <em>Description</em>.</p>
</li>
<li>
<p>Select <em>Save pool</em> to register your changes.</p>
</li>
</ol>
<p><a href="#heading--deleting-a-resource-pool"><h3 id="heading--deleting-a-resource-pool">How to delete a resource pool</h3></a></p>
<ol>
<li>
<p>Select <em>Organisation &gt; Pools</em>.</p>
</li>
<li>
<p>Select the trashcan icon at the end of the pool&rsquo;s row.</p>
</li>
<li>
<p>Select <em>Delete</em>.</p>
</li>
</ol>
<p><strong>NOTE:</strong> 
If you delete a resource pool, all machines that belong to that resource pool will return to the default pool.</p>
<p><a href="#heading--add-a-node-to-a-resource-pool"><h3 id="heading--add-a-node-to-a-resource-pool">How to add a machine to a resource pool</h3></a></p>
<ol>
<li>
<p>Select <em>Machines</em>.</p>
</li>
<li>
<p>Select the machine(s) you wish to add to a resource pool.</p>
</li>
<li>
<p>Select <em>Categorise &gt; Set pool</em>.</p>
</li>
<li>
<p>Choose <em>Select pool</em> and choose a pool from the <em>Resource pool</em> dropdown.</p>
</li>
<li>
<p>Alternatively, choose <em>Create pool</em>, and create a new pool to assign.</p>
</li>
<li>
<p>Select <em>Set pool&hellip;</em> to register your changes.</p>
</li>
</ol>
<p><a href="#heading--removing-a-node-from-a-resource-pool"><h3 id="heading--removing-a-node-from-a-resource-pool">How to remove a machine from a resource pool</h3></a></p>
<ol>
<li>
<p>Select <em>Machines</em>.</p>
</li>
<li>
<p>Select the machine(s) you wish to add to a resource pool.</p>
</li>
<li>
<p>Select <em>Categorise &gt; Set pool</em>.</p>
</li>
<li>
<p>Choose <em>Select pool</em> and choose &ldquo;default&rdquo; from the <em>Resource pool</em> dropdown.</p>
</li>
<li>
<p>Select <em>Set pool&hellip;</em> to register your changes.</p>
</li>
</ol>
<p><a href="#heading--add-a-vm-host-to-a-resource-pool"><h3 id="heading--add-a-vm-host-to-a-resource-pool">How to add a VM host to a resource pool</h3></a></p>
<ol>
<li>
<p>Select <em>KVM &gt; LXD</em>.</p>
</li>
<li>
<p>Click on the VM host you wish to add to a resource pool.</p>
</li>
<li>
<p>Select <em>KVM host settings</em>.</p>
</li>
<li>
<p>Choose a <em>Resource pool</em>.</p>
</li>
<li>
<p>Select <em>Save changes</em> to register your changes.</p>
</li>
</ol>
<p><a href="#heading--removing-a-vm-host-from-a-resource-pool"><h3 id="heading--removing-a-vm-host-from-a-resource-pool">How to remove a VM host from a resource pool</h3></a></p>
<ol>
<li>
<p>Select <em>KVM &gt; LXD</em>.</p>
</li>
<li>
<p>Click on the VM host you wish to add to a resource pool.</p>
</li>
<li>
<p>Select <em>KVM host settings</em>.</p>
</li>
<li>
<p>Choose the &ldquo;default&rdquo; <em>Resource pool</em>.</p>
</li>
<li>
<p>Select <em>Save changes</em> to register your changes.</p>
</li>
</ol>
<p><a href="#heading--how-to-use-machine-storage"><h2 id="heading--how-to-use-machine-storage">How to use machine storage</h2></a></p>
<p>This section will explain:</p>
<ul style="margin-left:4px; list-style-type:disc;">
<li><a href="#heading--how-to-set-global-storage-layouts">How to set global storage layouts</a></li>
<li><a href="#heading--how-to-set-per-machine-storage-layouts">How to set per-machine storage layouts</a></li>
<li><a href="#heading--how-to-specify-conditional-erasure-types">How to specify conditional erasure types</a></li>
<li><a href="#heading--how-to-erase-disks">How to erase disks</a></li>
<li><a href="#heading--how-to-manage-block-devices">How to manage block devices</a></li>
<li><a href="#heading--how-to-manage-partitions">How to manage partitions</a></li>
<li><a href="#heading--how-to-manage-vmfs-datastores">How to manage VMFS datastores</a></li>
<li><a href="#heading--how-to-define-custom-storage-layouts">How to define custom storage layouts</a></li>
</ul>
<p><a href="#heading--how-to-set-global-storage-layouts"><h3 id="heading--how-to-set-global-storage-layouts">How to set global storage layouts</h3></a></p>
<p>Layouts can be set globally and on a per-machine basis.</p>
<p><strong>NOTE:</strong> 
The new default will only apply to newly-commissioned machines.</p>
<p><a href="#heading--how-to-set-per-machine-storage-layouts"><h3 id="heading--how-to-set-per-machine-storage-layouts">How to set per-machine storage layouts</h3></a></p>
<p>An administrator can change the layout for a single machine as well as customise that layout providing this is done while the machine has a status of &lsquo;Ready&rsquo;. This is only possible via the CLI: to see how, click the &ldquo;CLI&rdquo; option for your version and delivery method above.</p>
<p><strong>NOTE:</strong> 
Only an administrator can modify storage at the block device level (providing the machine has a status of &lsquo;Ready&rsquo;).</p>
<p><a href="#heading--how-to-set-default-erasure-configuration"><h3 id="heading--how-to-set-default-erasure-configuration">How to set the default erasure configuration</h3></a></p>
<p>A default erasure configuration can be set on the &lsquo;Settings&rsquo; page by selecting the &lsquo;Storage&rsquo; tab.</p>
<p><a href="../images/4e90c4c7-installconfig-storage-erasure__defaults.png" target = "_blank"><img alt="unlabeled image" width="690" src="../images/4e90c4c7-installconfig-storage-erasure__defaults.png"></a></p>
<p>If option &lsquo;Erase machines&rsquo; disks prior to releasing&rsquo; is chosen then users will be compelled to use disk erasure. That option will be pre-filled in the machine&rsquo;s view and the user will be unable to remove the option.</p>
<p>With the above defaults, the machine&rsquo;s view will look like this when the Release action is chosen:</p>
<p><a href="../images/66e1dcc2-installconfig-storage-erasure__defaults-node.png" target = "_blank"><img alt="unlabeled image" width="690" src="../images/66e1dcc2-installconfig-storage-erasure__defaults-node.png"></a></p>
<p>Where &lsquo;secure erase&rsquo; and &lsquo;quick erase&rsquo; can then be configured by the user.</p>
<p><a href="#heading--how-to-define-custom-storage-layouts"><h2 id="heading--how-to-define-custom-storage-layouts">How to define custom storage layouts</h2></a></p>
<p>MAAS 3.1 allows you to define a custom storage layout for a machine, via a custom commissioning script.  You must upload a script which conforms to the following rules:</p>
<ul style="margin-left:4px; list-style-type:disc;">
<li>it must run after the <code>40-maas-01-machine-resources</code> script and before the <code>50-maas-01-commissioning</code> one, so it should have a name that starts with anything between <code>41-</code> and <code>49-</code>. This ensures the script can access the JSON file created by the former which provides info about the machine hardware and network resources. In addition, the custom script can directly inspect the machine it&rsquo;s running on to determine how to configure storage.</li>
<li>it can read machine hardware/network information from the JSON file at the path specified by <code>$MAAS_RESOURCES_FILE</code></li>
<li>it must output a JSON file at the path specified by <code>$MAAS_STORAGE_CONFIG_FILE</code> with the desired storage layout</li>
<li>names of disks provided in the custom layout must match the ones detected by MAAS and provided in the resources file.</li>
</ul>
<h3>Configuration format</h3>
<p>The configuration contains two main sections:
- <code>layout</code>, which lists the desired storage layout in terms of disks and volumes, along with their setup (partitions, volumes, &hellip;).
  This consists of a dictionary of device names and their configuration. Each device must have a <code>type</code> property (see below for supported types).
- <code>mounts</code>, which lists the desired filesystem mount points.
  As an example:</p>
<pre><code class="language-json">&quot;mounts&quot;: {
  &quot;/&quot;: {
    &quot;device&quot;: &quot;sda2&quot;,
    &quot;options&quot;: &quot;noatime&quot;
  },
  &quot;/boot/efi&quot;: {
    &quot;device&quot;: &quot;sda1&quot;
  },
  &quot;/data&quot;: {
    &quot;device&quot;: &quot;raid0&quot;
  }     
}
</code></pre>
<p>A complete <code>$MAAS_STORAGE_CONFIG_FILE</code> would look like this:</p>
<pre><code class="language-json">{
    &quot;layouts&quot;: {
        &quot;sda&quot;: {
           ...
        },
        &quot;raid0&quot;: {
           ...
        },
        ...
    },
    &quot;mounts&quot;: {
       &quot;/&quot;: {
           ...
       },
       ...
    }
}
</code></pre>
<p>The following device types are supported in the <code>"layout"</code> section:</p>
<h4>Disk</h4>
<pre><code class="language-json">&quot;sda&quot;: {
  &quot;type&quot;: &quot;disk&quot;,
  &quot;ptable&quot;: &quot;gpt&quot;,
  &quot;boot&quot;: true,
  &quot;partitions&quot;: [
    {
      &quot;name&quot;: &quot;sda1&quot;,
      &quot;fs&quot;: &quot;vfat&quot;,
      &quot;size&quot;: &quot;100M&quot;
      &quot;bootable&quot;: true,
    }
  ]
}
</code></pre>
<p>A <code>disk</code> entry defines a physical disk.
The following details can be specified:
- the partition table type (<code>ptable</code>), which can be <code>gpt</code> or <code>mbr</code>
- whether it should be selected as <code>boot</code> disk
- optionally, a list of partitions to create, with their <code>size</code> and filesystem type (<code>fs</code>)</p>
<h4>LVM</h4>
<pre><code class="language-json">&quot;lvm0&quot;: {
  &quot;type&quot;: &quot;lvm&quot;,
  &quot;members&quot;: [
    &quot;sda1&quot;,
    &quot;sdb1&quot;,
  ],
  &quot;volumes&quot;: [
    {
      &quot;name&quot;: &quot;data1&quot;,
      &quot;size&quot;: &quot;5G&quot;,
      &quot;fs&quot;: &quot;ext4&quot;
    },
    {
      &quot;name&quot;: &quot;data2&quot;,
      &quot;size&quot;: &quot;7G&quot;,
      &quot;fs&quot;: &quot;btrfs&quot;
    }
  ]
}
</code></pre>
<p>An <code>lvm</code> entry defines a VG (volume group) composed by a set of disks or partitions (listed as <code>members</code>). Optionally it&rsquo;s possible to specify the the LVs (logical volumes) to create.
Those are defined similarly to partitions, with a name and size (and optionally the filesystem).</p>
<h4>Bcache</h4>
<pre><code class="language-json">&quot;bcache0&quot;: {
  &quot;type&quot;: &quot;bcache&quot;,
  &quot;cache-device&quot;: &quot;sda&quot;,
  &quot;backing-device&quot;: &quot;sdf3&quot;,
  &quot;cache-mode&quot;: &quot;writeback&quot;,
  &quot;fs&quot;: &quot;ext4&quot;
}
</code></pre>
<p>A <code>bcache</code>  entry must specify a device to use as cache and one to use as storage. Both can be either a partition or a disk.
Optionally the <code>cache-mode</code> for the Bcache can be specified.</p>
<h4>RAID</h4>
<pre><code class="language-json">&quot;myraid&quot;: {
  &quot;type&quot;: &quot;raid&quot;,
  &quot;level&quot;: 5,
  &quot;members&quot;: [
    &quot;sda&quot;,
    &quot;sdb&quot;,
    &quot;sdc&quot;,
  ],
  &quot;spares&quot;: [
    &quot;sdd&quot;,
    &quot;sde&quot;
  ],
  &quot;fs&quot;: &quot;btrfs&quot;
</code></pre>
<p>A <code>raid</code> entry defines a RAID with a set of member devices.
Spare devices can also be specified.</p>
<h3>Configuration examples</h3>
<p>Here&rsquo;s a few examples of custom storage layout configurations that a script could output to the <code>$MAAS_STORAGE_CONFIG_FILE</code>. The examples assumes that the machine has 5 disks (named <code>sda</code> to <code>sde</code>).</p>
<p>Note that there&rsquo;s no need to add entries for those devices in the <code>layout</code> section if the disks are not explicitly partitioned, but just used by other devices (e.g. RAID or LVM).</p>
<h4>Simple single-disk layout with GPT partitioning</h4>
<pre><code class="language-json">{
  &quot;layout&quot;: {
    &quot;sda&quot;: {
      &quot;type&quot;: &quot;disk&quot;,
      &quot;ptable&quot;: &quot;gpt&quot;,
      &quot;boot&quot;: true,
      &quot;partitions&quot;: [
        {
          &quot;name&quot;: &quot;sda1&quot;,
          &quot;fs&quot;: &quot;vfat&quot;,
          &quot;size&quot;: &quot;500M&quot;,
          &quot;bootable&quot;: true
        },
        {
          &quot;name&quot;: &quot;sda2&quot;,
          &quot;size&quot;: &quot;5G&quot;,
          &quot;fs&quot;: &quot;ext4&quot;
        },
        {
          &quot;name&quot;: &quot;sda3&quot;,
          &quot;size&quot;: &quot;2G&quot;,
          &quot;fs&quot;: &quot;swap&quot;
        },
        {
          &quot;name&quot;: &quot;sda4&quot;,
          &quot;size&quot;: &quot;120G&quot;,
          &quot;fS&quot;: &quot;ext4&quot;
        }
      ]
    }
  },
  &quot;mounts&quot;: {
    &quot;/&quot;: {
      &quot;device&quot;: &quot;sda2&quot;,
      &quot;options&quot;: &quot;noatime&quot;
    },
    &quot;/boot/efi&quot;: {
      &quot;device&quot;: &quot;sda1&quot;
    },
    &quot;/data&quot;: {
      &quot;device&quot;: &quot;sda4&quot;
    },
    &quot;none&quot;: {
      &quot;device&quot;: &quot;sda3&quot;
    }
  }
}
</code></pre>
<p>In the <code>mounts</code> section, options for mount points can be specified. For swap, an entry must be present (with any unique name that doesn&rsquo;t start with a <code>/</code>), otherwise the swap will be created but not activated.</p>
<h4>RAID 5 setup (with spare devices)</h4>
<pre><code class="language-json">{
  &quot;layout&quot;: {
    &quot;storage&quot;: {
      &quot;type&quot;: &quot;raid&quot;,
      &quot;level&quot;: 5,
      &quot;members&quot;: [
        &quot;sda&quot;,
        &quot;sdb&quot;,
        &quot;sdc&quot;
      ],
      &quot;spares&quot;: [
        &quot;sdd&quot;,
        &quot;sde&quot;
      ],
      &quot;fs&quot;: &quot;btrfs&quot;
    }
  },
  &quot;mounts&quot;: {
    &quot;/data&quot;: {
      &quot;device&quot;: &quot;storage&quot;
    }
  }
}
</code></pre>
<p>Both full disks and partitions can be used as RAID members.</p>
<h4>LVM with pre-defined volumes</h4>
<pre><code class="language-json">{
  &quot;layout&quot;: {
    &quot;storage&quot;: {
      &quot;type&quot;: &quot;lvm&quot;,
      &quot;members&quot;: [
        &quot;sda&quot;,
        &quot;sdb&quot;,
        &quot;sdc&quot;,
        &quot;sdd&quot;
      ],
      &quot;volumes&quot;: [
        {
          &quot;name&quot;: &quot;data1&quot;,
          &quot;size&quot;: &quot;1T&quot;,
          &quot;fs&quot;: &quot;ext4&quot;
        },
        {
          &quot;name&quot;: &quot;data2&quot;,
          &quot;size&quot;: &quot;2.5T&quot;,
          &quot;fs&quot;: &quot;btrfs&quot;
        }
      ]
    }
  },
  &quot;mounts&quot;: {
    &quot;/data1&quot;: {
      &quot;device&quot;: &quot;data1&quot;
    },
    &quot;/data2&quot;: {
      &quot;device&quot;: &quot;data2&quot;
    }
  }
}
</code></pre>
<p>If no volumes are specified, the volume group is still created.</p>
<h4>Bcache</h4>
<pre><code class="language-json">{
  &quot;layout&quot;: {
     &quot;data1&quot;: {
      &quot;type&quot;: &quot;bcache&quot;,
      &quot;cache-device&quot;: &quot;sda&quot;,
      &quot;backing-device&quot;: &quot;sdb&quot;,
      &quot;cache-mode&quot;: &quot;writeback&quot;,
      &quot;fs&quot;: &quot;ext4&quot;
    },
    &quot;data2&quot;: {
      &quot;type&quot;: &quot;bcache&quot;,
      &quot;cache-device&quot;: &quot;sda&quot;,
      &quot;backing-device&quot;: &quot;sdc&quot;,
      &quot;fs&quot;: &quot;btrfs&quot;
    }
  },
  &quot;mounts&quot;: {
    &quot;/data1&quot;: {
      &quot;device&quot;: &quot;data1&quot;
    },
    &quot;/data2&quot;: {
      &quot;device&quot;: &quot;data2&quot;
    }
  }
}
</code></pre>
<p>The same cache set can be used by different bcaches by specifying the same <code>backing-device</code> for them.</p>
<h4>LVM on top of RAID with Bcache</h4>
<pre><code class="language-json">{
  &quot;layout&quot;: {
    &quot;bcache0&quot;: {
      &quot;type&quot;: &quot;bcache&quot;,
      &quot;backing-device&quot;: &quot;sda&quot;,
      &quot;cache-device&quot;: &quot;sdf&quot;
    },
    &quot;bcache1&quot;: {
      &quot;type&quot;: &quot;bcache&quot;,
      &quot;backing-device&quot;: &quot;sdb&quot;,
      &quot;cache-device&quot;: &quot;sdf&quot;
    },
    &quot;bcache2&quot;: {
      &quot;type&quot;: &quot;bcache&quot;,
      &quot;backing-device&quot;: &quot;sdc&quot;,
      &quot;cache-device&quot;: &quot;sdf&quot;
    },
    &quot;bcache3&quot;: {
      &quot;type&quot;: &quot;bcache&quot;,
      &quot;backing-device&quot;: &quot;sdd&quot;,
      &quot;cache-device&quot;: &quot;sdf&quot;
    },
    &quot;bcache4&quot;: {
      &quot;type&quot;: &quot;bcache&quot;,
      &quot;backing-device&quot;: &quot;sde&quot;,
      &quot;cache-device&quot;: &quot;sdf&quot;
    },
    &quot;raid&quot;: {
      &quot;type&quot;: &quot;raid&quot;,
      &quot;level&quot;: 5,
      &quot;members&quot;: [
        &quot;bcache0&quot;,
        &quot;bcache1&quot;,
        &quot;bcache2&quot;
      ],
      &quot;spares&quot;: [
        &quot;bcache3&quot;,
        &quot;bcache4&quot;
      ]
    },
    &quot;lvm&quot;: {
      &quot;type&quot;: &quot;lvm&quot;,
      &quot;members&quot;: [
        &quot;raid&quot;
      ],
      &quot;volumes&quot;: [
        {
          &quot;name&quot;: &quot;root&quot;,
          &quot;size&quot;: &quot;10G&quot;,
          &quot;fs&quot;: &quot;ext4&quot;
        },
        {
          &quot;name&quot;: &quot;data&quot;,
          &quot;size&quot;: &quot;3T&quot;,
          &quot;fs&quot;: &quot;btrfs&quot;
        }
      ]
    }
  },
  &quot;mounts&quot;: {
   &quot;/&quot;: {
      &quot;device&quot;: &quot;root&quot;
    },
    &quot;/data&quot;: {
      &quot;device&quot;: &quot;data&quot;
    }
  }
}
</code></pre>
<p>The RAID is created by using 5 bcache devices, each one using a different disk and the same SSD cache device. LVM is created on top of the RAID device and volumes are then created in it, to provide partitions.</p>
<p><a href="#heading--storage-layouts-reference"><h2 id="heading--storage-layouts-reference">Storage layouts reference</h2></a></p>
<p>There are three layout types:</p>
<ol>
<li>Flat layout</li>
<li>LVM layout</li>
<li>bcache layout</li>
</ol>
<p>The layout descriptions below will include the EFI partition. If your system is not using UEFI, regard <code>sda2</code> as <code>sda1</code> (with an additional 512 MB available to it).</p>
<p><a href="#heading--flat-storage-layout-reference"><h3 id="heading--flat-storage-layout-reference">Flat layout storage reference</h3></a></p>
<p>With the Flat layout, a partition spans the entire boot disk. The partition is formatted with the ext4 filesystem and uses the <code>/</code> mount point:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Name</th>
<th style="text-align: right;">Size</th>
<th style="text-align: center;">Type</th>
<th style="text-align: center;">Filesystem</th>
<th style="text-align: left;">Mount point</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">sda</td>
<td style="text-align: right;">-</td>
<td style="text-align: center;">disk</td>
<td style="text-align: center;"></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: center;">sda1</td>
<td style="text-align: right;">512 MB</td>
<td style="text-align: center;">part</td>
<td style="text-align: center;">FAT32</td>
<td style="text-align: left;">/boot/efi</td>
</tr>
<tr>
<td style="text-align: center;">sda2</td>
<td style="text-align: right;">rest of sda</td>
<td style="text-align: center;">part</td>
<td style="text-align: center;">ext4</td>
<td style="text-align: left;">/</td>
</tr>
</tbody>
</table>
<p>The following three options are supported:</p>
<ol>
<li>
<p><code>boot_size</code>: Size of the boot partition on the boot disk. Default is 0, meaning not to create the boot partition. The &lsquo;/boot&rsquo; will be placed on the root filesystem.</p>
</li>
<li>
<p><code>root_device</code>: The block device on which to place the root partition. The default is the boot disk.</p>
</li>
<li>
<p><code>root_size</code>: Size of the root partition. Default is 100%, meaning the entire size of the root device.</p>
</li>
</ol>
<p><a href="#heading--lvm-storage-layout-reference"><h3 id="heading--lvm-storage-layout-reference">LVM storage layout reference</h3></a></p>
<p>The LVM layout creates the volume group <code>vgroot</code> on a partition that spans the entire boot disk. A logical volume <code>lvroot</code> is created for the full size of the volume group; is formatted with the ext4 filesystem; and uses the <code>/</code> mount point:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Name</th>
<th style="text-align: right;">Size</th>
<th style="text-align: center;">Type</th>
<th style="text-align: center;">Filesystem</th>
<th style="text-align: left;">Mount point</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">sda</td>
<td style="text-align: right;">-</td>
<td style="text-align: center;">disk</td>
<td style="text-align: center;"></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: center;">sda1</td>
<td style="text-align: right;">512 MB</td>
<td style="text-align: center;">part</td>
<td style="text-align: center;">FAT32</td>
<td style="text-align: left;">/boot/efi</td>
</tr>
<tr>
<td style="text-align: center;">sda2</td>
<td style="text-align: right;">rest of sda</td>
<td style="text-align: center;">part</td>
<td style="text-align: center;">lvm-pv(vgroot)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: center;">lvroot</td>
<td style="text-align: right;">rest of sda</td>
<td style="text-align: center;">lvm</td>
<td style="text-align: center;">ext4</td>
<td style="text-align: left;">/</td>
</tr>
<tr>
<td style="text-align: center;">vgroot</td>
<td style="text-align: right;">rest of sda</td>
<td style="text-align: center;">lvm</td>
<td style="text-align: center;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p>The following six options are supported:</p>
<ol>
<li><code>boot_size</code>: Size of the boot partition on the boot disk. Default is 0, meaning not to create the boot partition. The &lsquo;/boot&rsquo; will be placed on the root filesystem.</li>
<li><code>root_device</code>: The block device on which to place the root partition. The default is the boot disk.</li>
<li><code>root_size</code>: Size of the root partition. Default is 100%, meaning the entire size of the root device.</li>
<li><code>vg_name</code>: Name of the created volume group. Default is <code>vgroot</code>.</li>
<li><code>lv_name</code>: Name of the created logical volume. Default is <code>lvroot</code>.</li>
<li><code>lv_size</code>: Size of the created logical volume. Default is 100%, meaning the entire size of the volume group.</li>
</ol>
<p><a href="#heading--bcache-storage-layout-reference"><h3 id="heading--bcache-storage-layout-reference">bcache storage layout reference</h3></a></p>
<p>A bcache layout will create a partition that spans the entire boot disk as the backing device. It uses the smallest block device tagged with &lsquo;ssd&rsquo; as the cache device. The bcache device is formatted with the ext4 filesystem and uses the <code>/</code> mount point. If there are no &lsquo;ssd&rsquo; tagged block devices on the machine, then the bcache device will not be created, and the Flat layout will be used instead:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Name</th>
<th style="text-align: right;">Size</th>
<th style="text-align: center;">Type</th>
<th style="text-align: center;">Filesystem</th>
<th style="text-align: left;">Mount point</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">sda</td>
<td style="text-align: right;">-</td>
<td style="text-align: center;">disk</td>
<td style="text-align: center;"></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: center;">sda1</td>
<td style="text-align: right;">512 MB</td>
<td style="text-align: center;">part</td>
<td style="text-align: center;">FAT32</td>
<td style="text-align: left;">/boot/efi</td>
</tr>
<tr>
<td style="text-align: center;">sda2</td>
<td style="text-align: right;">rest of sda</td>
<td style="text-align: center;">part</td>
<td style="text-align: center;">bc-backing</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: center;">sdb (ssd)</td>
<td style="text-align: right;">-</td>
<td style="text-align: center;">disk</td>
<td style="text-align: center;"></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: center;">sdb1</td>
<td style="text-align: right;">100% of sdb</td>
<td style="text-align: center;">part</td>
<td style="text-align: center;">bc-cache</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: center;">bcache0</td>
<td style="text-align: right;">per sda2</td>
<td style="text-align: center;">disk</td>
<td style="text-align: center;">ext4</td>
<td style="text-align: left;">/</td>
</tr>
</tbody>
</table>
<p>The following seven options are supported:</p>
<ol>
<li><code>boot_size</code>: Size of the boot partition on the boot disk. Default is 0, meaning not to create the boot partition. The &lsquo;/boot&rsquo; will be placed on the root filesystem.</li>
<li><code>root_device</code>: The block device upon which to place the root partition. The default is the boot disk.</li>
<li><code>root_size</code>: Size of the root partition. Default is 100%, meaning the entire size of the root device.</li>
<li><code>cache_device</code>: The block device to use as the cache device. Default is the smallest block device tagged ssd.</li>
<li><code>cache_mode</code>: The cache mode to which MAAS should set the created bcache device. The default is <code>writethrough</code>.</li>
<li><code>cache_size</code>: The size of the partition on the cache device. Default is 100%, meaning the entire size of the cache device.</li>
<li><code>cache_no_part</code>: Whether or not to create a partition on the cache device. Default is false, meaning to create a partition using the given <code>cache_size</code>. If set to true, no partition will be created, and the raw cache device will be used as the cache.</li>
</ol>
<p>vmfs6 storage layout reference
<a href="#heading--vmfs6-storage-layout-reference"><h3 id="heading--vmfs6-storage-layout-reference">VMFS6 storage layout reference</h3></a></p>
<p>The VMFS6 layout is used for VMware ESXi deployments only. It is required when configuring VMware VMFS Datastores. This layout creates all operating system partitions, in addition to the default datastore. The datastore may be modified.  New datastores may be created or extended to include other storage devices. The base operating system partitions may not be modified because VMware ESXi requires them. Once applied another storage layout must be applied to remove the operating system partitions.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Name</th>
<th style="text-align: right;">Size</th>
<th style="text-align: center;">Type</th>
<th style="text-align: left;">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">sda</td>
<td style="text-align: right;">-</td>
<td style="text-align: center;">disk</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">sda1</td>
<td style="text-align: right;">3 MB</td>
<td style="text-align: center;">part</td>
<td style="text-align: left;">EFI</td>
</tr>
<tr>
<td style="text-align: left;">sda2</td>
<td style="text-align: right;">4 GB</td>
<td style="text-align: center;">part</td>
<td style="text-align: left;">Basic Data</td>
</tr>
<tr>
<td style="text-align: left;">sda3</td>
<td style="text-align: right;">Remaining</td>
<td style="text-align: center;">part</td>
<td style="text-align: left;">VMFS Datastore 1</td>
</tr>
<tr>
<td style="text-align: left;">sda4</td>
<td style="text-align: right;">-</td>
<td style="text-align: center;">skipped</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">sda5</td>
<td style="text-align: right;">249 MB</td>
<td style="text-align: center;">part</td>
<td style="text-align: left;">Basic Data</td>
</tr>
<tr>
<td style="text-align: left;">sda6</td>
<td style="text-align: right;">249 MB</td>
<td style="text-align: center;">part</td>
<td style="text-align: left;">Basic Data</td>
</tr>
<tr>
<td style="text-align: left;">sda7</td>
<td style="text-align: right;">109 MB</td>
<td style="text-align: center;">part</td>
<td style="text-align: left;">VMware Diagnostic</td>
</tr>
<tr>
<td style="text-align: left;">sda8</td>
<td style="text-align: right;">285 MB</td>
<td style="text-align: center;">part</td>
<td style="text-align: left;">Basic Data</td>
</tr>
<tr>
<td style="text-align: left;">sda9</td>
<td style="text-align: right;">2.5 GB</td>
<td style="text-align: center;">part</td>
<td style="text-align: left;">VMware Diagnostic</td>
</tr>
</tbody>
</table>
<p>The following options are supported:</p>
<ul style="margin-left:4px; list-style-type:disc;">
<li>
<p><code>root_device</code>: The block device upon which to place the root partition. Default is the boot disk.</p>
</li>
<li>
<p><code>root_size</code>: Size of the default VMFS Datastore. Default is 100%, meaning the remaining size of the root disk.</p>
</li>
</ul>
<p><a href="#heading--blank-storage-layout-reference"><h3 id="heading--blank-storage-layout-reference">Blank storage layout reference</h3></a></p>
<p>The blank layout removes all storage configuration from all storage devices. It is useful when needing to apply a custom storage configuration.</p>
<p><strong>NOTE:</strong> 
Machines with the blank layout applied are not deployable; you must first configure storage manually.</p>
    </div>
  </body>
</html>