<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="css/stylesheet.css" />
    <style>
      #selector a:link{color:black;}
      #selector a:visited{color:black;}
      #selector a:active{color:black;}
      #selector a:hover{color:blue;}
      #sidebar a:link{color:black;}
      #sidebar a:visited{color:black;}
      #sidebar a:active{color:black;}
      #sidebar a:hover{color:blue;}
      ul {margin-left:0;list-style-type:none;}
      li {margin: 4px 0;}
    </style>
  </head>
  <body>
    <div id="selector" style="top:0; position:fixed; float:right; background-color:#d9d9d9; width:100%;border-bottom:1px solid black;">
      &nbsp;&nbsp;<strong>Offline docs</strong>
      <a href="https://maas.io/docs">(switch to live docs)</a>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <span style="background-color:white;border-top:1px solid black; border-left:1px solid black; border-right:1px solid black; border-bottom:5px solid white;">
	  UI-only
      </span>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	<a href="../cli/adding-a-vm-host.html">
	  CLI-only
	</a>
    </div>
    <div id="sidebar" style="float:left; width:25%;margin-top:40px; margin-left:20px">
      <strong>
	<a href="../maas-documentation.html">
	  Introduction
	</a>
      </strong>
      <ul>
	<li>
	  <a href="about-maas.html">
	    About MAAS
	  </a>
	</li>
	<li>
	  <a href="give-me-an-example-of-maas.html">
	    &ldquo;Give me an example&rdquo;
	  </a>
	</li>
	<li>
	  <a href="whats-new-in-maas.html">
	    What&rsquo;s new in 3.0
	  </a>
	</li>
	<li>
	  <a href="maas-requirements.html">
	    Requirements
	  </a>
	</li>
	<li>
	  <a href="maas-installation.html">
	    Installation
	  </a>
	</li>
	<li>
	  <a href="configuration-journey.html">
	    Configuration journey
	  </a>
	</li>
      <strong>
	<a href="controllers.html">
	  Controllers
	</a>
      </strong>
      <ul>
	<li>
	  <a href="maas-communication.html">
	    Communication
	  </a>
	</li>
	<li>
	  <a href="rack-controllers.html">
	    Rack controllers
	  </a>
	</li>
	<li>
	  <a href="region-controllers.html">
	    Region controllers
	  </a>
	</li>
	<li>
	  <a href="high-availability.html">
	    High availability
	  </a>
	</li>
      </ul>
      <strong>
	<a href="machines.html">
	  Machines
	</a>
      </strong>
      <ul>
	<li>
	  <a href="add-machines.html">
	    Add machines
	  </a>
	</li>
	<li>
	  <a href="power-management.html">
	    Power management
	  </a>
	</li>
	<li>
	  <a href="commission-machines.html">
	    Commission machines
	  </a>
	</li>
	<li>Testing
	</li>
	<li>
	  <a href="hardware-testing.html">
	    Hardware testing
	  </a>
	</li>
	<li>
	  <a href="network-testing.html">
	    Network testing
	  </a>
	</li>
	<li>
	  <a href="commissioning-and-hardware-testing-scripts.html">
	    Commissioning and hardware testing scripts
	  </a>
	</li>
	<li>
	  <a href="deploy-machines.html">
	    Deploy machines
	  </a>
	</li>
	<li>
	  <a href="maas-tags.html">
	    Tags
	  </a>
	</li>
	<li>
	  <a href="custom-machine-setup.html">
	    Custom machine setup
	  </a>
	</li>
	<li>
	  <a href="kernel-boot-options.html">
	    Kernel boot options
	  </a>
	</li>
	<li>
	  <a href="resource-pools.html">
	    Resource pools
	  </a>
	</li>
	<li>
	  <a href="storage.html">
	    Storage
	  </a>
	</li>
	<li>
	  <a href="vmware-vmfs-datastores.html">
	    VMware VMFS datastores
	  </a>
	</li>
	<li>
	  <a href="ubuntu-kernels.html">
	    Ubuntu kernels
	  </a>
	</li>
      </ul>
      <strong>
	<a href="images.html">
	  Images
	</a>
      </strong>
      <ul>
	<li>
	  <a href="select-and-import-images.html">
	    Select and import images
	  </a>
	</li>
	<li>
	  <a href="local-image-mirror.html">
	    Local image mirror
	  </a>
	</li>
	<li>
	  <a href="vmware-images.html">
	    VMWare images
	  </a>
	</li>
      </ul>
      <strong>
	<a href="networking.html">
	  Networking
	</a>
      </strong>
      <ul>
	<li>
	  <a href="subnet-management.html">
	    Subnet management
	  </a>
	</li>
	<li>
	  <a href="managing-dhcp.html">
	    DHCP
	  </a>
	</li>
	<li>
	  <a href="ip-ranges.html">
	    IP ranges
	  </a>
	</li>
	<li>
	  <a href="proxy.html">
	    Proxy
	  </a>
	</li>
	<li>
	  <a href="ntp-services.html">
	    NTP
	  </a>
	</li>
	<li>
	  <a href="network-discovery.html">
	    Network discovery
	  </a>
	</li>
	<li>
	  <a href="ipv6-addressing.html">
	    IPv6
	  </a>
	</li>
	<li>
	  <a href="configuring-tls-encryption.html">
	    SSL
	  </a>
	</li>
	<li>
	  <a href="managing-stp.html">
	    STP
	  </a>
	</li>
	<li>
	  <a href="availability-zones.html">
	    Availability zones (AZs)
	  </a>
	</li>
      </ul>
      <strong>
	<a href="vm-hosting.html">
	  VM hosting
	</a>
      </strong>
      <ul>
	<li>
	  <a href="vm-host-networking.html">
	    VM host networking
	  </a>
	</li>
	<li>
	  <a href="adding-a-vm-host.html">
	    Add a VM host
	  </a>
	</li>
	<li>
	  <a href="vm-host-storage-pools.html">
	    VM host storage pools
	  </a>
	</li>
	<li>
	  <a href="creating-and-deleting-vms.html">
	    Creating and deleting VMs
	  </a>
	</li>
      </ul>
      <strong>Operations
      </strong>
      <ul>
	<li>
	  <a href="prometheus-metrics.html">
	    Prometheus metrics
	  </a>
	</li>
	<li>
	  <a href="backup.html">
	    Backup
	  </a>
	</li>
	<li>
	  <a href="hardening-your-maas-installation.html">
	    MAAS security
	  </a>
	</li>
	<li>
	  <a href="maas-logging.html">
	    Logging
	  </a>
	</li>
	<li>
	  <a href="commissioning-logs.html">
	    Commissioning logs
	  </a>
	</li>
	<li>
	  <a href="user-accounts.html">
	    User accounts
	  </a>
	</li>
	<li>
	  <a href="interactive-search.html">
	    Interactive search
	  </a>
	</li>
      </ul>
      <strong>
	<a href="concepts-and-terms.html">
	  Concepts &amp; terms
	</a>
      </strong>
      <ul>
	<li>
	  <a href="concepts-and-terms.html#heading--network-tutorial">
	    Brief network tutorial
	  </a>
	</li>
      </ul>
      <strong>
	<a href="maas-cli.html">
	  CLI
	</a>
      </strong>
      <ul>
	<li>
	  <a href="common-cli-tasks.html">
	    The CLI cookbook
	  </a>
	</li>
	<li>
	  <a href="common-cli-tasks.html">
	    Common tasks
	  </a>
	</li>
	<li>
	  <a href="audit-event-logs.html">
	    Audit event logs
	  </a>
	</li>
	<li>
	  <a href="cli-kernel-management.html">
	    Kernel management
	  </a>
	</li>
	<li>
	  <a href="cli-image-management.html">
	    Image management
	  </a>
	</li>
	<li>
	  <a href="cli-interface-management.html">
	    Interface management
	  </a>
	</li>
	<li>
	  <a href="cli-advanced-tasks.html">
	    Advanced tasks
	  </a>
	</li>
	<li>
	  <a href="cli-composable-hardware.html">
	    Composable hardware
	  </a>
	</li>
	<li>
	  <a href="python-api-client.html">
	    API client
	  </a>
	</li>
      </ul>
      <strong>
	<a href="api.html">
	  API documentation
	</a>
      </strong>
      <ul>
	<li>
	  <a href="api-authentication.html">
	    API authentication
	  </a>
	</li>
      </ul>
      <strong>
	<a href="troubleshooting.html">
	  Troubleshoot
	</a>
      </strong>
      <ul>
	<li>
	  <a href="getting-help.html">
	    Getting help
	  </a>
	</li>
	<li>
	  <a href="tips-tricks-and-traps.html">
	    Tips, tricks, and traps
	  </a>
	</li>
	<li>
	  <a href="https://old-docs.maas.io/2.5/en/">
	    MAAS 2.5 (+ earlier) doc
	  </a>
	</li>
      </ul>
      <strong>
	<a href="whats-new-in-maas.html">
	  Release notes
	</a>
      </strong>
      <p/>
      <strong>
	<a href="writing-guide.html">
	  Help improve these docs
	</a>
      </strong>
    </div>
    <div class="container" style="float:right; width:65%; margin-top:40px; margin-right:30px">
      <h1>Adding a VM host</h1>
<p>A VM host is simply a machine which can run virtual machines (VMs) by allocating  resources across the VMs you want to create.  If needed, you can over-commit resources, allocating more resources than actually available, so long as you don&rsquo;t try to use more than the VM host has available at any one time. Once MAAS has enlisted, commissioned, and acquired a newly-added machine, you can deploy it as a VM host.  Alternatively, you can create a VM host from a machine you&rsquo;ve already got running.</p>
<!-- deb-2-9-cli
<strong>NOTE:</strong> 
You **must** [configure your network](vm-host-networking.html) to support a VM host before following the procedures in this section.  You will also want to make sure that you have [set up SSH](vm-host-networking.html#heading--set-up-ssh) (if needed) before you follow any procedures in this section.

#### Eight questions you may have:

1. [How do I configure networking for VM hosts?](vm-host-networking.html)
2. [How do I set up SSH when manually adding a VM host?](vm-host-networking.html#heading--set-up-ssh)
3. [How do I add a VM host?](#heading--adding-a-vm-host)
4.  [How do I configure a VM host after I've added it?](#heading--configuration)
5. [How do I over-commit resources on a host?](#heading--overcommit-resources)
6. [How do I add a VM host using MAAS versions below 2.5?](https://old-docs.maas.io/2.5/en/manage-kvm-add-host)
7. [How can I list resources of all VM hosts?](#heading--list-resources-of-all-vm-hosts)
8. [How can I list resources of a VM host?](#heading--list-resources-of-a-vm-host)
9. [How can I update a VM host's configuration?](#heading--update-vm-host-configuration)
10. [How can I list a VM host's connection parameters?](#heading--list-vm-host-connection-parameters)
 deb-2-9-cli -->

<!-- deb-3-0-ui
<strong>NOTE:</strong> 
You **must** [configure your network](vm-host-networking.html) to support a VM host before following the procedures in this section.  You will also want to make sure that you have [set up SSH](vm-host-networking.html#heading--set-up-ssh) (if needed) before you follow any procedures in this section.

#### Seven questions you may have:

1. [How do I configure networking for VM hosts?](vm-host-networking.html)
2. [How do I set up SSH when manually adding a VM host?](vm-host-networking.html#heading--set-up-ssh)
3. [How do I add a VM host?](#heading--adding-a-vm-host)
4. [How can I view a summary of my VM host project?(#heading--vm-host-project-summary)
5. [How can I view resource details for my VM host?(#heading--vm-host-resource-details)
6. [How do I change VM host settings after I've added it?](#heading--configuration)
7. [How do I over-commit resources on a host?](#heading--overcommit-resources)
8. [How do I add a VM host using MAAS versions below 2.5?](https://old-docs.maas.io/2.5/en/manage-kvm-add-host)
 deb-3-0-ui -->

<!-- deb-3-0-cli
<strong>NOTE:</strong> 
You **must** [configure your network](vm-host-networking.html) to support a VM host before following the procedures in this section.  You will also want to make sure that you have [set up SSH](vm-host-networking.html#heading--set-up-ssh) (if needed) before you follow any procedures in this section.

#### Eight questions you may have:

1. [How do I configure networking for VM hosts?](vm-host-networking.html)
2. [How do I set up SSH when manually adding a VM host?](vm-host-networking.html#heading--set-up-ssh)
3. [How do I add a VM host?](#heading--adding-a-vm-host)
4.  [How do I configure a VM host after I've added it?](#heading--configuration)
5. [How do I over-commit resources on a host?](#heading--overcommit-resources)
6. [How do I add a VM host using MAAS versions below 2.5?](https://old-docs.maas.io/2.5/en/manage-kvm-add-host)
7. [How can I list resources of all VM hosts?](#heading--list-resources-of-all-vm-hosts)
8. [How can I list resources of a VM host?](#heading--list-resources-of-a-vm-host)
9. [How can I update a VM host's configuration?](#heading--update-vm-host-configuration)
10. [How can I list a VM host's connection parameters?](#heading--list-vm-host-connection-parameters)
deb-3-0-cli -->

<!-- deb-2-9-ui
<strong>NOTE:</strong> 
You **must** [configure your network](vm-host-networking.html) to support a VM host before following the procedures in this section.  You will also want to make sure that you have [set up SSH](vm-host-networking.html#heading--set-up-ssh) (if needed) before you follow any procedures in this section.

#### Six questions you may have:

1. [How do I configure networking for VM hosts?](vm-host-networking.html)
2. [How do I set up SSH when manually adding a VM host?](vm-host-networking.html#heading--set-up-ssh)
3. [How do I add a VM host?](#heading--adding-a-vm-host)
4.  [How do I configure a VM host after I've added it?](#heading--configuration)
5. [How do I over-commit resources on a host?](#heading--overcommit-resources)
6. [How do I add a VM host using MAAS versions below 2.5?](https://old-docs.maas.io/2.5/en/manage-kvm-add-host)
 deb-2-9-ui -->

<!-- snap-2-9-cli
<strong>NOTE:</strong> 
You **must** [configure your network](vm-host-networking.html) to support a VM host before following the procedures in this section.  You will also want to make sure that you have [set up SSH](vm-host-networking.html#heading--set-up-ssh) (if needed) before you follow any procedures in this section.

#### Eight questions you may have:

1. [How do I configure networking for VM hosts?](vm-host-networking.html)
2. [How do I set up SSH when manually adding a VM host?](vm-host-networking.html#heading--set-up-ssh)
3. [How do I add a VM host?](#heading--adding-a-vm-host)
4.  [How do I configure a VM host after I've added it?](#heading--configuration)
5. [How do I over-commit resources on a host?](#heading--overcommit-resources)
6. [How do I add a VM host using MAAS versions below 2.5?](https://old-docs.maas.io/2.5/en/manage-kvm-add-host)
7. [How can I list resources of all VM hosts?](#heading--list-resources-of-all-vm-hosts)
8. [How can I list resources of a VM host?](#heading--list-resources-of-a-vm-host)
9. [How can I update a VM host's configuration?](#heading--update-vm-host-configuration)
10. [How can I list a VM host's connection parameters?](#heading--list-vm-host-connection-parameters)
 snap-2-9-cli -->

<!-- snap-2-9-ui
<strong>NOTE:</strong> 
You **must** [configure your network](vm-host-networking.html) to support a VM host before following the procedures in this section.  You will also want to make sure that you have [set up SSH](vm-host-networking.html#heading--set-up-ssh) (if needed) before you follow any procedures in this section.

#### Six questions you may have:

1. [How do I configure networking for VM hosts?](vm-host-networking.html)
2. [How do I set up SSH when manually adding a VM host?](vm-host-networking.html#heading--set-up-ssh)
3. [How do I add a VM host?](#heading--adding-a-vm-host)
4.  [How do I configure a VM host after I've added it?](#heading--configuration)
5. [How do I over-commit resources on a host?](#heading--overcommit-resources)
6. [How do I add a VM host using MAAS versions below 2.5?](https://old-docs.maas.io/2.5/en/manage-kvm-add-host)
 snap-2-9-ui -->

<!-- snap-3-0-cli
<strong>NOTE:</strong> 
You **must** [configure your network](vm-host-networking.html) to support a VM host before following the procedures in this section.  You will also want to make sure that you have [set up SSH](vm-host-networking.html#heading--set-up-ssh) (if needed) before you follow any procedures in this section.

#### Eight questions you may have:

1. [How do I configure networking for VM hosts?](vm-host-networking.html)
2. [How do I set up SSH when manually adding a VM host?](vm-host-networking.html#heading--set-up-ssh)
3. [How do I add a VM host?](#heading--adding-a-vm-host)
4.  [How do I configure a VM host after I've added it?](#heading--configuration)
5. [How do I over-commit resources on a host?](#heading--overcommit-resources)
6. [How do I add a VM host using MAAS versions below 2.5?](https://old-docs.maas.io/2.5/en/manage-kvm-add-host)
7. [How can I list resources of all VM hosts?](#heading--list-resources-of-all-vm-hosts)
8. [How can I list resources of a VM host?](#heading--list-resources-of-a-vm-host)
9. [How can I update a VM host's configuration?](#heading--update-vm-host-configuration)
10. [How can I list a VM host's connection parameters?](#heading--list-vm-host-connection-parameters)
 snap-3-0-cli -->

<p><strong>NOTE:</strong> 
You <strong>must</strong> <a href="vm-host-networking.html">configure your network</a> to support a VM host before following the procedures in this section.  You will also want to make sure that you have <a href="vm-host-networking.html#heading--set-up-ssh">set up SSH</a> (if needed) before you follow any procedures in this section. </p>
<h4>Six questions you may have:</h4>
<ol>
<li><a href="vm-host-networking.html">How do I configure networking for VM hosts?</a></li>
<li><a href="vm-host-networking.html#heading--set-up-ssh">How do I set up SSH when manually adding a VM host?</a></li>
<li><a href="#heading--adding-a-vm-host">How do I add a VM host?</a></li>
<li>[How can I view a summary of my VM host project?(#heading&ndash;vm-host-project-summary)</li>
<li>[How can I view resource details for my VM host?(#heading&ndash;vm-host-resource-details)</li>
<li><a href="#heading--configuration">How do I change VM host settings after I&rsquo;ve added it?</a></li>
<li><a href="#heading--overcommit-resources">How do I over-commit resources on a host?</a></li>
<li><a href="https://old-docs.maas.io/2.5/en/manage-kvm-add-host">How do I add a VM host using MAAS versions below 2.5?</a></li>
</ol>
<p><a href="#heading--adding-a-vm-host"><h2 id="heading--adding-a-vm-host">Adding a VM host</h2></a></p>
<p>After installing MAAS, the &lsquo;KVM&rsquo; page is typically empty:</p>
<p><a href="images/883a61d38dea2c04010bf9286f0c68700b14975c.png" target = "_blank"><img src="images/883a61d38dea2c04010bf9286f0c68700b14975c.png"></a></a></p>
<p>If you want to add a LXD (or <a href="https://ubuntu.com/server/docs/virtualization-libvirt">libvirt</a>) KVM host to a machine which is already installed, you can do so with the &lsquo;Add KVM&rsquo; button:</p>
<p><a href="images/93fcb7aecee3eeea31f3939a884c12fe89f790ba.jpeg" target = "_blank"><img src="images/93fcb7aecee3eeea31f3939a884c12fe89f790ba.jpeg"></a></a></p>
<p>Upon selecting &ldquo;Authenticate&rdquo; (assuming successful authentication), you will recieve a project selection screen similar to this:</p>
<p><a href="images/346c8e29fc8d4b74507843a956865ebd254aad57.jpeg" target = "_blank"><img src="images/346c8e29fc8d4b74507843a956865ebd254aad57.jpeg"></a></a></p>
<p>You must either enter a new project name (which cannot contain spaces or special characters), or you must select an existing project.  If you&rsquo;re not really planning on using projects, selecting the &ldquo;default&rdquo; project will allow you to continue working as you have in the past.</p>
<!--  deb-2-9-ui  snap-2-9-ui 
If you want to add a [libvirt](https://ubuntu.com/server/docs/virtualization-libvirt) or LXD VM host to a machine which is already installed, you can do so with the 'Add KVM' button:

<a href="images/197ae57b89b32546cf054fff49452f9025354af8.jpeg" target = "_blank"><img src="images/197ae57b89b32546cf054fff49452f9025354af8.jpeg"></a></a> 

Here, 'Virsh address' typically looks like the following for libvirt:

    qemu+ssh://<vm host IP>/system

of like this for LXD (Beta):

    https://10.0.0.100:8443
  deb-2-9-ui  snap-2-9-ui -->

<!-- snap-3-0-cli deb-3-0-cli
To add a VM host:

<pre><code class="bash">maas $PROFILE vm-host create type=$VM_HOST_TYPE power_address=$POWER_ADDRESS \
    [power_user=$USERNAME] power_pass=$PASSWORD {project=$PROJECT} \
    [zone=$ZONE] [tags=$TAG1,$TAG2,...]
</code></pre>


$VM_HOST_TYPE can currently take two values: `virsh` and `lxd`.

$POWER_ADDRESS typically looks like the following for libvirt:

    qemu+ssh://<vm host IP>/system

of like this for LXD (Beta):

    https://10.0.0.100:8443

Both $USERNAME and $PASSWORD are optional for the virsh power type. $ZONE and $TAGS are optional for all VM hosts.

The `power_...` parameters will vary with power type.  See the [API reference](/docs/api#power-types) for a listing of available power types.

For example, to create a LXD VM host, enter the following:


<pre><code class="bash">maas $PROFILE vm-hosts create type=lxd power_address=$LXD_BRIDGE_ADDRESS \
   power_pass=$LXD_TRUST_PASSWORD project=$PROJECT_NAME
</code></pre>


Note that for LXD VM hosts, a project name is not optional.  Project names cannot contain spaces or special characters. If you enter a project name which doesn't exist, MAAS will create the LXD project for you.
 snap-3-0-cli deb-3-0-cli -->

<!--  deb-2-9-cli  snap-2-9-cli 
To add a VM host:

<pre><code class="bash">maas $PROFILE vm-host create type=$VM_HOST_TYPE power_address=$POWER_ADDRESS \
    [power_user=$USERNAME] [power_pass=$PASSWORD] [zone=$ZONE] \
    [tags=$TAG1,$TAG2,...]
</code></pre>


$VM_HOST_TYPE can currently take three values: `rsd`, `virsh`, and `lxd`.

$POWER_ADDRESS typically looks like the following for libvirt:

    qemu+ssh://<vm host IP>/system

of like this for LXD (Beta):

    https://10.0.0.100:8443

Both $USERNAME and $PASSWORD are optional for the virsh power type. $ZONE and $TAGS are optional for all VM hosts.

The `power_...` parameters will vary with power type.  See the [API reference](/docs/api#power-types) for a listing of available power types.

<h3>Some examples</h3>

For example, to create an RSD VM host, enter:


<pre><code class="bash">maas $PROFILE vm-hosts create type=rsd power_address=10.3.0.1:8443 \
    power_user=admin power_pass=admin
</code></pre>


To create a KVM host, enter the following:


<pre><code class="bash">maas $PROFILE vm-hosts create type=virsh power_address=qemu+ssh://ubuntu@192.168.1.2/system
</code></pre>

 deb-2-9-cli  snap-2-9-cli -->

<p><strong>NOTE:</strong> 
MAAS will automatically discover and store the resources your VM host contains. Any existing machines will also appear on the &lsquo;Machines&rsquo; page, and MAAS will automatically attempt to commission them.</p>
<!--  deb-2-9-ui  snap-2-9-ui

<a href="#heading--configuration"><h2 id="heading--configuration">VM host configuration</h2></a>

VM hosts have several configuration options. Modify these by selecting the 'Configuration' tab and eidting options directly.  These options include a VM host's location, password, network zone, resource pool, and memory and CPU overcommit sliders.

<a href="images/8b3fc96a8f1a1e4b25413a9f60388dc04dd886c9.png" target = "_blank"><img src="images/8b3fc96a8f1a1e4b25413a9f60388dc04dd886c9.png"></a></a>
  deb-2-9-ui  snap-2-9-ui -->

<p><a href="#heading--vm-host-project-summary"><h2 id="heading--vm-host-project-summary">LXD VM host project summary</h2></a></p>
<p>Each LXD VM host provides a &ldquo;Project&rdquo; tab that summarizes the current state of the LXD KVM:</p>
<p><a href="images/e0cc264a17d67f9530ff8c2ef2bb9522fed0749a.png" target = "_blank"><img src="images/e0cc264a17d67f9530ff8c2ef2bb9522fed0749a.png"></a></a></p>
<p>This tab identifies the project, shows its current resource state, and provides the ability to select existing VM hosts and perform specific actions on them &ndash; as well as being able to compose new VMs on the spot.</p>
<p><a href="#heading--vm-host-resource-details"><h2 id="heading--vm-host-resource-details">LXD VM host resource details</h2></a></p>
<p>This tab presents a summary of the LXD VM host&rsquo;s resource usage:</p>
<p><a href="images/d67cf384d6fe903274893eb50a098518d2c1295d.png" target = "_blank"><img src="images/d67cf384d6fe903274893eb50a098518d2c1295d.png"></a></a></p>
<p>The only interactive option on this tab allows you to map or unmap resource usage to NUMA nodes.</p>
<p><a href="#heading--configuration"><h2 id="heading--configuration">VM host settings</h2></a></p>
<p>VM hosts have several settings. Modify these by selecting the &lsquo;Settings&rsquo; tab and editing items directly. Options include a VM host&rsquo;s address, password, network zone, resource pool, and memory and CPU overcommit sliders.</p>
<p><a href="images/253afc122d61145be656bb5c3811f9b6c6caa708.png" target = "_blank"><img src="images/253afc122d61145be656bb5c3811f9b6c6caa708.png"></a></a></p>
<!--  deb-2-9-cli  snap-2-9-cli snap-3-0-cli deb-3-0-cli 
Using the CLI, it's possible to update the configuration of a VM host.  You can change these configurable parameters with an `update` command -- but first, you'll want to know how to check the values of configurable parameters, both before and after the change.

<a href="#heading--list-vm-hosts"><h3 id="heading--list-vm-hosts">List VM-hosts</h3></a>

To begin, you can list your available KVM-hosts with the following command:


<pre><code>maas admin vm-hosts read | jq -r '([&quot;ID, &quot;VM-HOST&quot;,&quot;SYSID&quot;,&quot;CORES&quot;,
&quot;USED&quot;,&quot;RAM&quot;, &quot;USED&quot;,&quot;STORAGE&quot;, &quot;USED&quot;] | (., map(length*&quot;-&quot;))),
(.[]| [.id,.name,.host.system_id,.total.cores, .used.cores, .total.memory, .used.memory,.total.local_storage, .used.local_storage])
| @tsv' | column -t
</code></pre>


<a href="#heading--list-config-params"><h3 id="heading--list-config-params">List configurable VM host parameters</h3></a>

There are just a few parameters that you can change for a VM host.  You can list these, on a per-host basis, using the following two-step procedure:

1. Run the command above to get the VM host ID (different from the System ID, see the first column in the listing).

2. Enter the following command to list configurable parameters:


<pre><code>maas admin vm-host read $ID | jq -r '([&quot;ID&quot;,&quot;NAME&quot;,&quot;POOL&quot;,&quot;ZONE&quot;,
&quot;CPU-O/C&quot;, &quot;RAM-O/C&quot;, &quot;TAGS&quot;] | (., map(length*&quot;-&quot;))), (.| [.id,.name,
.pool.name, .zone.name,.cpu_over_commit_ratio, 
.memory_over_commit_ratio, .tags[]]) | @tsv' | column -t
</code></pre>


where $ID is the ID (not System ID) of the VM-host.

<a href="#heading--change-vm-host-name"><h3 id="heading--change-vm-host-name">Change the VM host's name</h3></a>

You can change the VM host's name very simply, with this command:

    maas admin vm-host update $ID name=$NEW_NAME

where $ID is the VM host's ID (not System ID), and $NEW_NAME is the new name you want to assign.  You can check that the change was successful by just printing out the ID and name, like this:


<pre><code>maas admin vm-host read $ID | jq -r '([&quot;ID&quot;,&quot;NAME&quot;] 
| (., map(length*&quot;-&quot;))), (.| [.id,.name]) 
| @tsv' | column -t
</code></pre>


<a href="#heading--change-vm-host-pool"><h3 id="heading--change-vm-host-pool">Change the VM host's pool</h3></a>

You can also change the VM host's pool with a simple command:

    maas admin vm-host update $ID pool=$VALID_POOL

where $ID is the VM host's ID (not System ID), and $VALID_POOL is the name of a pool that already exists.  If you mention a pool you haven't created yet, you'll get an error like this:


<pre><code>{&quot;pool&quot;: [&quot;Select a valid choice. That choice is not one of the available choices.&quot;]}
</code></pre>


    maas admin resource-pools read | jq -r '.[] | (.name)'

If you really want to set your VM host to a new one, you just need to create a new one with this command:

    maas admin resource-pools create name=$NEW_POOL_NAME

Then double-check it with `catvmpools`, and assign your VM host to it using the earlier command. 
  deb-2-9-cli  snap-2-9-cli  snap-3-0-cli deb-3-0-cli -->

<p><a href="#heading--overcommit-resources"><h3 id="heading--overcommit-resources">Over-commit resources</h3></a></p>
<p>Over-committed resources are those allocated beyond what&rsquo;s available in the physical resource. Using sliders on the configuration page, you can limit whether MAAS will attempt to overcommit CPU and memory. The input fields to the right of the sliders accept floating-point values from 0 to 10, with a default value of 1.</p>
<p>The following shows four theoretical examples of these ratios and how they affect physical resource allocation:</p>
<ol>
<li><code>8 physical CPU cores  * 1 multiplier     = 8 virtual CPU cores</code></li>
<li><code>8 physical CPU cores  * 0.5 multiplier   = 4 virtual CPU cores</code></li>
<li><code>32 physical CPU cores * 10.0 multiplier  = 320 virtual CPU cores</code></li>
<li><code>128GB physical memory  * 5.5 multiplier  = 704G virtual Memory</code></li>
</ol>
<p><a href="images/27a8f21392af3d29a500e33f99e1f79c578cf29c.jpeg" target = "_blank"><img src="images/27a8f21392af3d29a500e33f99e1f79c578cf29c.jpeg"></a></a> </p>
<p>Over-committing resources allows a user to compose many MAAS-managed machines without worrying about the physical limitations of the host. For example, on a physical host with four cores and 12 GB of memory, you could compose four libvirt machines, each using two cores and 4 GB of memory.  This arrangement over commits the available physical resources. Provided you never run all four VMs simultaneously, you would have all the benefits of MAAS-managed VMs without over-taxing your host.</p>
<!-- snap-2a-7-cli    snap-2-9-cli deb-2-9-cli snap-3-0-cli deb-3-0-cli
<a href="#heading--list-resources-of-all-vm-hosts"><h2 id="heading--list-resources-of-all-vm-hosts">List resources of all VM hosts</h2></a>

<pre><code class="bash">maas $PROFILE vm-hosts read
</code></pre>


A portion of the sample output:


<pre><code class="no-highlight">        &quot;id&quot;: 93,
        &quot;capabilities&quot;: [
            &quot;composable&quot;,
            &quot;fixed_local_storage&quot;,
            &quot;iscsi_storage&quot;
        ],
        &quot;name&quot;: &quot;civil-hermit&quot;,
</code></pre>


<a href="#heading--list-resources-of-a-vm-host"><h2 id="heading--list-resources-of-a-vm-host">List resources of a VM host</h2></a>

To list an individual VM host's resources:


<pre><code class="bash">maas $PROFILE vm-host read $VM_HOST_ID
</code></pre>


<a href="#heading--update-vm-host-configuration"><h2 id="heading--update-vm-host-configuration">Update VM host configuration</h2></a>

Update overcommit ratios for a KVM host:


<pre><code class="bash">maas $PROFILE vm-host update $VM_HOST_ID power_address=qemu+ssh://ubuntu@192.168.1.2/system \
        power_pass=example cpu_over_commit_ratio=2.5 memory_over_commit_ratio=10.0
</code></pre>


Update the default storage pool used by a KVM host:


<pre><code class="bash">maas $PROFILE vm-host update $VM_HOST_ID power_address=qemu+ssh://ubuntu@192.168.1.2/system \
        power_pass=example default_storage_pool=pool2
</code></pre>


<a href="#heading--list-vm-host-connection-parameters"><h2 id="heading--list-vm-host-connection-parameters">List VM host connection parameters</h2></a>

To list a VM host's connection parameters:


<pre><code class="bash">maas $PROFILE vm-host parameters $VM_HOST_ID
</code></pre>


Example output:


<pre><code class="no-highlight">{
    &quot;power_address&quot;: &quot;10.3.0.1:8443&quot;,
    &quot;power_pass&quot;: &quot;admin&quot;,
    &quot;power_user&quot;: &quot;admin&quot;
}
</code></pre>


snap-2a-7-cli    snap-2-9-cli deb-2-9-cli snap-3-0-cli deb-3-0-cli -->
    </div>
  </body>
</html>