<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="css/stylesheet.css" />
    <style>
      #selector a:link{color:black;}
      #selector a:visited{color:black;}
      #selector a:active{color:black;}
      #selector a:hover{color:blue;}
      #sidebar a:link{color:black;}
      #sidebar a:visited{color:black;}
      #sidebar a:active{color:black;}
      #sidebar a:hover{color:blue;}
      ul {margin-left:0;list-style-type:none;}
      li {margin: 4px 0;}
    </style>
  </head>
  <body>
    <div id="selector" style="top:0; position:fixed; float:right; background-color:#d9d9d9; width:100%;border-bottom:1px solid black;">
      &nbsp;&nbsp;<strong>Offline docs</strong>
      <a href="https://maas.io/docs">(switch to live docs)</a>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	<a href="../ui/power-management.html">
	  &nbsp;UI-only&nbsp;
	</a>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <span style="background-color:white;border-top:1px solid black; border-left:1px solid black; border-right:1px solid black; border-bottom:5px solid white;>"
	  CLI-only
      </span>
    </div>
    <div id="sidebar" style="float:left; width:25%;margin-top:40px; margin-left:20px">
      <strong>
	<a href="maas-documentation.html">
	  Introduction
	</a>
      </strong>
      <ul>
	<li>
	  <a href="about-maas.html">
	    About MAAS
	  </a>
	</li>
	<li>
	  <a href="give-me-an-example-of-maas.html">
	    &ldquo;Give me an example&rdquo;
	  </a>
	</li>
	<li>
	  <a href="whats-new-in-maas.html">
	    What&rsquo;s new in 3.0
	  </a>
	</li>
	<li>
	  <a href="maas-requirements.html">
	    Requirements
	  </a>
	</li>
	<li>
	  <a href="maas-installation.html">
	    Installation
	  </a>
	</li>
	<li>
	  <a href="configuration-journey.html">
	    Configuration journey
	  </a>
	</li>
      <strong>
	<a href="controllers.html">
	  Controllers
	</a>
      </strong>
      <ul>
	<li>
	  <a href="maas-communication.html">
	    Communication
	  </a>
	</li>
	<li>
	  <a href="rack-controllers.html">
	    Rack controllers
	  </a>
	</li>
	<li>
	  <a href="region-controllers.html">
	    Region controllers
	  </a>
	</li>
	<li>
	  <a href="high-availability.html">
	    High availability
	  </a>
	</li>
      </ul>
      <strong>
	<a href="machines.html">
	  Machines
	</a>
      </strong>
      <ul>
	<li>
	  <a href="add-machines.html">
	    Add machines
	  </a>
	</li>
	<li>
	  <a href="power-management.html">
	    Power management
	  </a>
	</li>
	<li>
	  <a href="commission-machines.html">
	    Commission machines
	  </a>
	</li>
	<li>Testing
	</li>
	<li>
	  <a href="hardware-testing.html">
	    Hardware testing
	  </a>
	</li>
	<li>
	  <a href="network-testing.html">
	    Network testing
	  </a>
	</li>
	<li>
	  <a href="commissioning-and-hardware-testing-scripts.html">
	    Commissioning and hardware testing scripts
	  </a>
	</li>
	<li>
	  <a href="deploy-machines.html">
	    Deploy machines
	  </a>
	</li>
	<li>
	  <a href="maas-tags.html">
	    Tags
	  </a>
	</li>
	<li>
	  <a href="custom-machine-setup.html">
	    Custom machine setup
	  </a>
	</li>
	<li>
	  <a href="kernel-boot-options.html">
	    Kernel boot options
	  </a>
	</li>
	<li>
	  <a href="resource-pools.html">
	    Resource pools
	  </a>
	</li>
	<li>
	  <a href="storage.html">
	    Storage
	  </a>
	</li>
	<li>
	  <a href="vmware-vmfs-datastores.html">
	    VMware VMFS datastores
	  </a>
	</li>
	<li>
	  <a href="ubuntu-kernels.html">
	    Ubuntu kernels
	  </a>
	</li>
      </ul>
      <strong>
	<a href="images.html">
	  Images
	</a>
      </strong>
      <ul>
	<li>
	  <a href="select-and-import-images.html">
	    Select and import images
	  </a>
	</li>
	<li>
	  <a href="local-image-mirror.html">
	    Local image mirror
	  </a>
	</li>
	<li>
	  <a href="vmware-images.html">
	    VMWare images
	  </a>
	</li>
      </ul>
      <strong>
	<a href="networking.html">
	  Networking
	</a>
      </strong>
      <ul>
	<li>
	  <a href="subnet-management.html">
	    Subnet management
	  </a>
	</li>
	<li>
	  <a href="managing-dhcp.html">
	    DHCP
	  </a>
	</li>
	<li>
	  <a href="ip-ranges.html">
	    IP ranges
	  </a>
	</li>
	<li>
	  <a href="proxy.html">
	    Proxy
	  </a>
	</li>
	<li>
	  <a href="ntp-services.html">
	    NTP
	  </a>
	</li>
	<li>
	  <a href="network-discovery.html">
	    Network discovery
	  </a>
	</li>
	<li>
	  <a href="ipv6-addressing.html">
	    IPv6
	  </a>
	</li>
	<li>
	  <a href="configuring-tls-encryption.html">
	    SSL
	  </a>
	</li>
	<li>
	  <a href="managing-stp.html">
	    STP
	  </a>
	</li>
	<li>
	  <a href="availability-zones.html">
	    Availability zones (AZs)
	  </a>
	</li>
      </ul>
      <strong>
	<a href="vm-hosting.html">
	  VM hosting
	</a>
      </strong>
      <ul>
	<li>
	  <a href="vm-host-networking.html">
	    VM host networking
	  </a>
	</li>
	<li>
	  <a href="adding-a-vm-host.html">
	    Add a VM host
	  </a>
	</li>
	<li>
	  <a href="vm-host-storage-pools.html">
	    VM host storage pools
	  </a>
	</li>
	<li>
	  <a href="creating-and-deleting-vms.html">
	    Creating and deleting VMs
	  </a>
	</li>
      </ul>
      <strong>Operations
      </strong>
      <ul>
	<li>
	  <a href="prometheus-metrics.html">
	    Prometheus metrics
	  </a>
	</li>
	<li>
	  <a href="backup.html">
	    Backup
	  </a>
	</li>
	<li>
	  <a href="hardening-your-maas-installation.html">
	    MAAS security
	  </a>
	</li>
	<li>
	  <a href="maas-logging.html">
	    Logging
	  </a>
	</li>
	<li>
	  <a href="commissioning-logs.html">
	    Commissioning logs
	  </a>
	</li>
	<li>
	  <a href="user-accounts.html">
	    User accounts
	  </a>
	</li>
	<li>
	  <a href="interactive-search.html">
	    Interactive search
	  </a>
	</li>
      </ul>
      <strong>
	<a href="concepts-and-terms.html">
	  Concepts &amp; terms
	</a>
      </strong>
      <ul>
	<li>
	  <a href="concepts-and-terms.html#heading--network-tutorial">
	    Brief network tutorial
	  </a>
	</li>
      </ul>
      <strong>
	<a href="maas-cli.html">
	  CLI
	</a>
      </strong>
      <ul>
	<li>
	  <a href="common-cli-tasks.html">
	    The CLI cookbook
	  </a>
	</li>
	<li>
	  <a href="common-cli-tasks.html">
	    Common tasks
	  </a>
	</li>
	<li>
	  <a href="audit-event-logs.html">
	    Audit event logs
	  </a>
	</li>
	<li>
	  <a href="cli-kernel-management.html">
	    Kernel management
	  </a>
	</li>
	<li>
	  <a href="cli-image-management.html">
	    Image management
	  </a>
	</li>
	<li>
	  <a href="cli-interface-management.html">
	    Interface management
	  </a>
	</li>
	<li>
	  <a href="cli-advanced-tasks.html">
	    Advanced tasks
	  </a>
	</li>
	<li>
	  <a href="cli-composable-hardware.html">
	    Composable hardware
	  </a>
	</li>
	<li>
	  <a href="python-api-client.html">
	    API client
	  </a>
	</li>
      </ul>
      <strong>
	<a href="api.html">
	  API documentation
	</a>
      </strong>
      <ul>
	<li>
	  <a href="api-authentication.html">
	    API authentication
	  </a>
	</li>
      </ul>
      <strong>
	<a href="troubleshooting.html">
	  Troubleshoot
	</a>
      </strong>
      <ul>
	<li>
	  <a href="getting-help.html">
	    Getting help
	  </a>
	</li>
	<li>
	  <a href="tips-tricks-and-traps.html">
	    Tips, tricks, and traps
	  </a>
	</li>
	<li>
	  <a href="https://old-docs.maas.io/2.5/en/">
	    MAAS 2.5 (+ earlier) doc
	  </a>
	</li>
      </ul>
      <strong>
	<a href="whats-new-in-maas.html">
	  Release notes
	</a>
      </strong>
      <p/>
      <strong>
	<a href="writing-guide.html">
	  Help improve these docs
	</a>
      </strong>
    </div>
    <div class="container" style="float:right; width:65%; margin-top:40px; margin-right:30px">
      <h1>Power management</h1><p>||2.9|3.0|</p>
<p>To manage a machine, MAAS must be able to power cycle it, usually through the machine&rsquo;s <a href="https://en.wikipedia.org/wiki/Intelligent_Platform_Management_Interface#Baseboard_management_controller">BMC</a> card.  Until you configure the power type, a newly-added machine can&rsquo;t be enlisted and used by MAAS.</p>
<!--   snap-2-9-ui   deb-2-9-ui   snap-2-9-cli   deb-2-9-cli 
#### Four questions you may have:

1. [How do I configure a machine's power type?](#heading--config-power-type)
2. [Show me a catalogue of power parameters, by type.](#heading--power-catalogue)
3. [Can you give me an example of the virsh power type?](#heading--example-virsh-kvm-power-type)
4. [Which BMC drivers are supported?](#heading--bmc-driver-support)
   snap-2-9-ui   deb-2-9-ui   snap-2-9-cli   deb-2-9-cli -->

<h4>Five questions you may have:</h4>
<ol>
<li><a href="#heading--config-power-type">How do I configure a machine&rsquo;s power type?</a></li>
<li><a href="#heading--power-catalogue">Show me a catalogue of power parameters, by type.</a></li>
<li><a href="#heading--example-virsh-kvm-power-type">Can you give me an example of the virsh power type?</a></li>
<li><a href="#heading--bmc-driver-support">Which BMC drivers are supported?</a></li>
<li><a href="#heading--configure-use-ibm-z">How do I configure and use IBM Z with MAAS?</a></li>
</ol>
<!--   snap-2-9-ui   deb-2-9-ui snap-3-0-ui deb-3-0-ui 
<a href="#heading--config-power-type"><h2 id="heading--config-power-type">Configure a machine's power type</h2></a>

To configure a machine's power type, click on the machine from the 'Machines' page of the web UI, then select its 'Configuration' tab. Scroll down until you find the Power configuration. If the power type is undefined, the following will be displayed:

<a href="images/4fae5977-nodes-power-types__2.4_undefined.png" target = "_blank"><img src="images/4fae5977-nodes-power-types__2.4_undefined.png"></a></a>

Choose a type in the drop-down menu that corresponds to the machine's underlying machine's BMC card.

<a href="images/b53c6613-nodes-power-types__2.4_selection.png" target = "_blank"><img src="images/b53c6613-nodes-power-types__2.4_selection.png"></a></a>

Fill in the resulting form; the information required will depends on the power type:
  snap-2-9-ui   deb-2-9-ui  snap-3-0-ui deb-3-0-ui -->

<!-- snap-2-9-ui deb-2-9-ui snap-3-0-ui deb-3-0-ui 
| CLI power_type code | Description |
|-----|-----|
| [amt](#heading--amt) |Intel AMT |
| [apc](#heading--apc) | American Power Conversion (APC) PDU |
| [dli](#heading--dli) | Digital Loggers, Inc. PDU |
| [hmc](#heading--hmc) | IBM Hardware Management Console (HMC) |
| [lxd](#heading--lxd) | LXD VM |
| [ipmi](#heading--ipmi) | IPMI |
| [manual](#heading--manual) | Manual power configuration |
| [moonshot](#heading--moonshot) | HP Moonshot - iLO4 (IPMI) |
| [mscm](#heading--mscm) | HP Moonshot - iLO Chassis Manager |
| [msftocs](#heading--mscm) | Microsoft OCS - Chassis Manager |
| [nova](#heading--nova) | OpenStack Nova |
| [openbmc](#heading--openbmc) | OpenBMC Power Driver |
| [proxmox](#heading--proxmox) | ProxMox Power Driver |
| [recs_box](#heading--recs_box) | Christmann RECS-Box Power Driver |
| [redfish](#heading--redfish) | Redfish |
| [sm15k](#heading--sm15k) | SeaMicro 15000 |
| [ucsm](#heading--ucsm) | Cisco UCS Manager |
| [virsh](#heading--virsh) | libvirt KVM |
| [vmware](#heading--vmware) | VMware |
| [webhook](#heading--webhook) | Webhook |
| [wedge](#heading--wedge) | Facebook's Wedge |
 snap-2-9-ui deb-2-9-ui snap-3-0-ui deb-3-0-ui -->

<!--   snap-2-9-ui   deb-2-9-ui snap-3-0-ui deb-3-0-ui 
Click 'Save changes' to finish. Once that's done, MAAS performs a power check on the machine. A successful power check is a good indication that MAAS can properly communicate with the machine, that is, it should quickly result in a power status of "Power off". A failed attempt will show:

<a href="images/3bd5e93b-nodes-power-types__2.4_power-error.png" target = "_blank"><img src="images/3bd5e93b-nodes-power-types__2.4_power-error.png"></a></a>

If you see this error, double-check your entered values by editing the power type, or  consider another power type altogether.

Another possible cause for this error may be the networking: traffic may be getting filtered between the rack controller and the BMC card.

<a href="#heading--power-catalogue"><h2 id="heading--power-catalogue">Power catalogue</h2></a>

The following catalogue helps to explain the fields in the "create machine" dialogue above.  Note that most of the multiple-choice fields have drop-down menus to assist with your choice.

<a href="#heading--amt"><h3 id="heading--amt">Intel AMT</h3></a>

| Form field | Description | Required |
|-----|-----|-----|
| Power password | Password to access unit | Optional |
| Power address | IP address of unit | Required |

<a href="#heading--apc"><h3 id="heading--apc">American Power Conversion (APC) PDU</h3></a>

| Form field | Description | Required |
|-----|-----|-----|
| IP for APC PDU | IP address of unit | Required |
| APU PDU node outlet number (1-16) | PDU node outlet number | Required |
| Power ON outlet delay (seconds) | outlet power ON delay | Optional, default=5 |

<a href="#heading--dli"><h3 id="heading--dli">Digital Loggers, Inc. PDU</h3></a>

| Form field | Description | Required |
|-----|-----|-----|
| Outlet ID | outlet ID | Required |
| Power address | IP address of unit | Required |
| Power user | Username to login | Optional |
| Power password | Password to access unit | Optional |

<a href="#heading--hmc"><h3 id="heading--hmc">IBM Hardware Management Console (HMC)</h3></a>

| Form field | Description | Required |
|-----|-----|-----|
| IP for HMC | IP address of unit | Required |
| HMC username | Username to login | Optional |
| HMC password | Password to access unit | Optional |
| HMC Managed System server name | HMC managed server name | Required |
| HMC logical partition | HMC logical partition of unit | Required |
  snap-2-9-ui   deb-2-9-ui snap-3-0-ui deb-3-0-ui -->

<!--  snap-2-9-ui  deb-2-9-ui snap-3-0-ui deb-3-0-ui 
<a href="#heading--lxd"><h3 id="heading--lxd">LXD VMs</h3></a>

| Form field | Description | Required |
|-----|-----|-----|
| LXD address | IP address of unit | Required |
| Instance name | LXD container instance name | Required |
| LXD password | Password to access unit | Optional |
 snap-2-9-ui  deb-2-9-ui  snap-3-0-ui deb-3-0-ui -->

<!--   snap-2-9-ui   deb-2-9-ui snap-3-0-ui deb-3-0-ui

<a href="#heading--ipmi"><h3 id="heading--ipmi">IPMI</h3></a>

  snap-2-9-ui   deb-2-9-ui  snap-3-0-ui deb-3-0-ui -->

<!-- snap-2-9-ui deb-2-9-ui snap-3-0-ui deb-3-0-ui

Some of the fields for this power type have fixed choices, indicated in the "Choices" column.

| Form field | Description | Choices | Required |
|-----|-----|-----|-----|
| Power driver | Power driver |`LAN [IPMI 1.5]` | Required |
| | | `LAN_2_0 [IPMI 2.0]`|
| Power boot type | Boot type | `Automatic` | Required |
| | | `Legacy boot` | |
| | | `EFI boot` | |
| IP address | IP address of unit || Required |
| Power user | Username to login || Optional |
| Power password | Password to access unit || Optional |
| Power MAC | MAC address of unit || Optional |
| K_g | K_g BMC key | | Optional (BETA) |
| Cipher suite | Cipher suite ID | - `17` <small>(17 - HMAC-SHA256::HMAC_SHA256_128::AES-CBC-128)</small> | Optional (BETA) |
| | |`3` <small>(3 - HMAC-SHA1::HMAC-SHA1-96::AES-CBC-128)</small> | |
| | |` ` (blank) <small>(freeipmi-tools default)</small> | |
| | |`8` <small>(8 - HMAC-MD5::HMAC-MD5-128::AES-CBC-128)</small> | |
| | |`12` <small>(12 - HMAC-MD5::MD5-128::AES-CBC-128)</small> | |
| Privilege level | IPMI privilege level | `User` | Optional (BETA) |
| | | `Operator` | |
| | | `Administrator` | |
snap-2-9-ui deb-2-9-ui  snap-3-0-ui deb-3-0-ui -->

<!--   snap-2-9-ui   deb-2-9-ui snap-3-0-ui deb-3-0-ui

<a href="#heading--manual"><h3 id="heading--manual">Manual power configuration</h3></a>

Manual power configuration means exactly that -- manually configured at the unit -- hence there are no parameters to set in the "create machine" UI.

  snap-2-9-ui   deb-2-9-ui snap-3-0-ui deb-3-0-ui -->

<p><a href="#heading--moonshot"><h3 id="heading--moonshot">HP Moonshot - iLO4 (IPMI)</h3></a></p>
<table>
<thead>
<tr>
<th>Form field</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>Power address</td>
<td>IP address of unit</td>
<td>Required</td>
</tr>
<tr>
<td>Power user</td>
<td>Username to login</td>
<td>Optional</td>
</tr>
<tr>
<td>Power password</td>
<td>Password to access unit</td>
<td>Optional</td>
</tr>
<tr>
<td>Power hardware address</td>
<td>Hardware address of unit</td>
<td>Required</td>
</tr>
</tbody>
</table>
<p><a href="#heading--mscm"><h3 id="heading--mscm">HP Moonshot - iLO Chassis Manager</h3></a></p>
<table>
<thead>
<tr>
<th>Form field</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>IP for MSCM CLI API</td>
<td>IP address of unit</td>
<td>Required</td>
</tr>
<tr>
<td>MSCM CLI API user</td>
<td>Username to login</td>
<td>Optional</td>
</tr>
<tr>
<td>MSCM CLI API password</td>
<td>Password to access unit</td>
<td>Optional</td>
</tr>
<tr>
<td>Node ID</td>
<td>cXnY</td>
<td>Required</td>
</tr>
<tr>
<td>- where</td>
<td>X = cartridge number</td>
<td></td>
</tr>
<tr>
<td></td>
<td>Y = node number</td>
<td></td>
</tr>
</tbody>
</table>
<p><a href="#heading--mscm"><h3 id="heading--mscm">Microsoft OCS - Chassis Manager</h3></a></p>
<table>
<thead>
<tr>
<th>Form field</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>Power address</td>
<td>IP address of unit</td>
<td>Required</td>
</tr>
<tr>
<td>Power port</td>
<td>Port where unit is attached</td>
<td>Optional</td>
</tr>
<tr>
<td>Power user</td>
<td>Username to login</td>
<td>Optional</td>
</tr>
<tr>
<td>Power password</td>
<td>Password to access unit</td>
<td>Optional</td>
</tr>
<tr>
<td>Blade ID</td>
<td>Blade ID (usu. 1-24)</td>
<td>Required</td>
</tr>
</tbody>
</table>
<p><a href="#heading--nova"><h3 id="heading--nova">OpenStack Nova</h3></a></p>
<table>
<thead>
<tr>
<th>Form field</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>Host UUID</td>
<td>Host UUID</td>
<td>Required</td>
</tr>
<tr>
<td>Tenant name</td>
<td>Tenant name</td>
<td>Required</td>
</tr>
<tr>
<td>Username</td>
<td>Username to login</td>
<td>Required</td>
</tr>
<tr>
<td>Password</td>
<td>Password to access unit</td>
<td>Required</td>
</tr>
<tr>
<td>Auth URL</td>
<td>URL to access unit</td>
<td>Required</td>
</tr>
</tbody>
</table>
<!-- snap-2-9-ui deb-2-9-ui snap-3-0-ui deb-3-0-ui 
<a href="#heading--proxmox"><h3 id="heading--proxmox">Proxmox</h3></a>

| Form field | Description | Required |
|-----|-----|-----|
| Power type | Proxmox | Required |
| Host name or IP | Power address for the Proxmox driver | Required |
| Username, including realm | Power user, along with realm (i.e., Username@Realm | Required |
| Password | Required if a token name and secret aren't given | Provisional |
| API token name | Token name: must include Username without realm (i.e., Username!Token-name | Provisional |
| API token secret | Token secret | Provisional |
| Node ID | VM name or ID | Optional |
| Verify SSL connections... | Boolean, whether or not to verify SSL connections with the system's root CA certificate | Required |

 snap-2-9-ui deb-2-9-ui  snap-3-0-ui deb-3-0-ui -->

<p><a href="#heading--openbmc"><h3 id="heading--openbmc">OpenBMC Power Driver</h3></a></p>
<table>
<thead>
<tr>
<th>Form field</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>OpenBMC address</td>
<td>IP address of unit</td>
<td>Required</td>
</tr>
<tr>
<td>OpenBMC user</td>
<td>Username to login</td>
<td>Required</td>
</tr>
<tr>
<td>OpenBMC password</td>
<td>Password to access unit</td>
<td>Required</td>
</tr>
</tbody>
</table>
<p><a href="#heading--recs_box"><h3 id="heading--recs_box">Christmann RECS-Box Power Driver</h3></a></p>
<table>
<thead>
<tr>
<th>Form field</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>Node ID</td>
<td>Node ID</td>
<td>Required</td>
</tr>
<tr>
<td>Power address</td>
<td>IP address of unit</td>
<td>Required</td>
</tr>
<tr>
<td>Power port</td>
<td>Port where unit is attached</td>
<td>Optional</td>
</tr>
<tr>
<td>Power user</td>
<td>Username to login</td>
<td>Optional</td>
</tr>
<tr>
<td>Power password</td>
<td>Password to access unit</td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p><a href="#heading--redfish"><h3 id="heading--redfish">Redfish</h3></a></p>
<table>
<thead>
<tr>
<th>Form field</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>Redfish address</td>
<td>IP address of unit</td>
<td>Required</td>
</tr>
<tr>
<td>Redfish user</td>
<td>Username to login</td>
<td>Required</td>
</tr>
<tr>
<td>Redfish password</td>
<td>Password to access unit</td>
<td>Required</td>
</tr>
<tr>
<td>Node ID</td>
<td>Node ID</td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p><a href="#heading--sm15k"><h3 id="heading--sm15k">SeaMicro 15000</h3></a></p>
<p>Some of the fields for this power type have fixed choices, indicated in the &ldquo;Choices&rdquo; column.</p>
<table>
<thead>
<tr>
<th>Form field</th>
<th>Description</th>
<th>Choices</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>System ID</td>
<td>System ID</td>
<td></td>
<td>Required</td>
</tr>
<tr>
<td>Power address</td>
<td>IP address of unit</td>
<td></td>
<td>Required</td>
</tr>
<tr>
<td>Power user</td>
<td>Username to login</td>
<td></td>
<td>Optional</td>
</tr>
<tr>
<td>Power password</td>
<td>Password to access unit</td>
<td></td>
<td>Optional</td>
</tr>
<tr>
<td>Power control type</td>
<td>Password to access unit</td>
<td>IPMI</td>
<td>Required</td>
</tr>
<tr>
<td></td>
<td></td>
<td>REST API v0.9</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>REST API v2.0</td>
<td></td>
</tr>
</tbody>
</table>
<p><a href="#heading--ucsm"><h3 id="heading--ucsm">Cisco UCS Manager</h3></a></p>
<table>
<thead>
<tr>
<th>Form field</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>Server UUID</td>
<td>Server UUID</td>
<td>Required</td>
</tr>
<tr>
<td>URL for XML API</td>
<td>XML API URL</td>
<td>Required</td>
</tr>
<tr>
<td>API user</td>
<td>API user</td>
<td>Optional</td>
</tr>
<tr>
<td>API password</td>
<td>API password</td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p><a href="#heading--virsh"><h3 id="heading--virsh">virsh - libvirt KVM</h3></a></p>
<table>
<thead>
<tr>
<th>Form field</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>Address</td>
<td>URL of VM</td>
<td>Required</td>
</tr>
<tr>
<td>Password</td>
<td>API password</td>
<td>Optional</td>
</tr>
<tr>
<td>Virsh VM ID</td>
<td>libvirt VM UUID</td>
<td>Required</td>
</tr>
</tbody>
</table>
<p><a href="#heading--vmware"><h3 id="heading--vmware">VMware</h3></a></p>
<table>
<thead>
<tr>
<th>Form field</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>VM Name</td>
<td>VM name (if UUID unknown)</td>
<td>Optional</td>
</tr>
<tr>
<td>VM UUID</td>
<td>VM UUID (if known)</td>
<td>Optional</td>
</tr>
<tr>
<td>VMware IP</td>
<td>IP address of VM</td>
<td>Required</td>
</tr>
<tr>
<td>VMware username</td>
<td>Username to access VM</td>
<td>Required</td>
</tr>
<tr>
<td>VMware password</td>
<td>Password to access VM</td>
<td>Required</td>
</tr>
<tr>
<td>VMware API port</td>
<td>VMware API port number</td>
<td>Optional</td>
</tr>
<tr>
<td>VMware API protocol</td>
<td>VMware API protocol</td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p><a href="#heading--wedge"><h3 id="heading--wedge">Facebook&rsquo;s Wedge</h3></a></p>
<table>
<thead>
<tr>
<th>Form field</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>IP address</td>
<td>IP address of unit</td>
<td>Required</td>
</tr>
<tr>
<td>Power user</td>
<td>Username to access unit</td>
<td>Optional</td>
</tr>
<tr>
<td>Power password</td>
<td>Password to access unit</td>
<td>Optional</td>
</tr>
</tbody>
</table>
<!--   snap-2-9-ui   deb-2-9-ui  snap-3-0-ui deb-3-0-ui 
<a href="#heading--example-virsh-kvm-power-type"><h2 id="heading--example-virsh-kvm-power-type">An example: the Virsh power type</h2></a>

Consider a machine backed by VM. Below, a 'Power type' of `Virsh` has been selected, and the 'Power address' of `qemu+ssh://ubuntu@192.168.1.2/system` has been entered (replace values as appropriate).  The value of 'Power ID' is the VM domain (guest) name, here `node2`.

<a href="images/c75e00a8-nodes-power-types__2.4_example-virsh.png" target = "_blank"><img src="images/c75e00a8-nodes-power-types__2.4_example-virsh.png"></a></a>

<strong>NOTE:</strong> 
The machine's hostname -- according to MAAS -- is a randomly chosen string (here `dear.ant`). You should change this hostname to something descriptive, that helps you remember why this machine is in your MAAS network.

  snap-2-9-ui   deb-2-9-ui  snap-3-0-ui deb-3-0-ui -->

<!-- snap-2-9-ui deb-2-9-ui snap-3-0-ui deb-3-0-ui 
<a href="#heading--webhook"><h3 id="heading--webhook">Webhook</h3></a>

It's important to understand that the Webhook power driver is more generic than other drivers, so it has some flexibility that the underlying power driver may not support.  For example, Webhook doesn't require a username or password for the power driver, because not all power drivers work that way.  Nevertheless, the power driver you're connecting to Webhook may actually require a username and/or password.  Understanding and implementing these fields correctly for the chosen back-end power driver is the user's responsibility.

To that end, the "Required" column for this driver refers only to whether Webhook requires a value in each field.  Just because a field is optional for Webhook itself does not mean that the underlying power driver will ultimately allow that field to be unspecified.

| Form field | Description | Required (by Webhook) |
|-----|-----|-----|
| Power type | Webhook (from drop-down list) | Required |
| URI to power on the node | URI to access power driver's API for power on | Required |
| URI to power off the node | URI to access power driver's API for power off | Required |
| URI to query the nodes power status | URI to access power driver's API for power status | Required |
| Regex to confirm the node is on | Regex expression that will return a string if the power is on, and no string if the power is off | Required, defaults supplied |
| Regex to confirm the node is off | Regex expression that will return a string if the power is off, and no string if the power is on | Required, defaults supplied |
| Power user | Username to log into the power driver | Optional |
| Power password | Password to access unit | Optional |
| Power token | Power driver API token (used instead of user and password, if set) | Optional |
| Verify SSL connections... | Boolean, whether or not to verify SSL connections with the system's root CA certificate | Required |

 snap-2-9-ui deb-2-9-ui  snap-3-0-ui deb-3-0-ui -->

<p><a href="#heading--config-power-type"><h2 id="heading--config-power-type">Configure a machine&rsquo;s power type</h2></a></p>
<p>To (re)configure a machine&rsquo;s power type, first find the machine&rsquo;s $SYSTEM_ID with the following recipe:</p>
<pre><code>maas admin machines read | jq -r '([&quot;HOSTNAME&quot;,&quot;SIS'S&quot;] | (., map(length*&quot;-&quot;))),
(.[] | [.hostname, .system_id]) | @tsv' | column -t
</code></pre>

<p>Next, use the <a href="maas-cli.html">MAAS CLI</a> command <code>maas machines...</code> to (re)set the machine&rsquo;s power type, like this:</p>
<pre><code>maas $PROFILE machine update $SYSTEM_ID power_type="$POWER_TYPE"
</code></pre>
<p>where $POWER_TYPE can have the following values:</p>
<table>
<thead>
<tr>
<th>CLI power_type code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#heading--amt">amt</a></td>
<td>Intel AMT</td>
</tr>
<tr>
<td><a href="#heading--apc">apc</a></td>
<td>American Power Conversion (APC) PDU</td>
</tr>
<tr>
<td><a href="#heading--dli">dli</a></td>
<td>Digital Loggers, Inc. PDU</td>
</tr>
<tr>
<td><a href="#heading--eaton">eaton</a></td>
<td>Eaton PDU</td>
</tr>
<tr>
<td><a href="#heading--hmc">hmc</a></td>
<td>IBM Hardware Management Console (HMC)</td>
</tr>
<tr>
<td><a href="#heading--lxd">lxd</a></td>
<td>LXD VM</td>
</tr>
<tr>
<td><a href="#heading--ipmi">ipmi</a></td>
<td>IPMI</td>
</tr>
<tr>
<td><a href="#heading--manual">manual</a></td>
<td>Manual power configuration</td>
</tr>
<tr>
<td><a href="#heading--moonshot">moonshot</a></td>
<td>HP Moonshot - iLO4 (IPMI)</td>
</tr>
<tr>
<td><a href="#heading--mscm">mscm</a></td>
<td>HP Moonshot - iLO Chassis Manager</td>
</tr>
<tr>
<td><a href="#heading--mscm">msftocs</a></td>
<td>Microsoft OCS - Chassis Manager</td>
</tr>
<tr>
<td><a href="#heading--nova">nova</a></td>
<td>OpenStack Nova</td>
</tr>
<tr>
<td><a href="#heading--openbmc">openbmc</a></td>
<td>OpenBMC Power Driver</td>
</tr>
<tr>
<td><a href="#heading--recs_box">recs_box</a></td>
<td>Christmann RECS-Box Power Driver</td>
</tr>
<tr>
<td><a href="#heading--redfish">redfish</a></td>
<td>Redfish</td>
</tr>
<tr>
<td><a href="#heading--sm15k">sm15k</a></td>
<td>SeaMicro 15000</td>
</tr>
<tr>
<td><a href="#heading--ucsm">ucsm</a></td>
<td>Cisco UCS Manager</td>
</tr>
<tr>
<td><a href="#heading--virsh">virsh</a></td>
<td>libvirt KVM</td>
</tr>
<tr>
<td><a href="#heading--vmware">vmware</a></td>
<td>VMware</td>
</tr>
<tr>
<td><a href="#heading--wedge">wedge</a></td>
<td>Facebook&rsquo;s Wedge</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>CLI power_type code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#heading--amt">amt</a></td>
<td>Intel AMT</td>
</tr>
<tr>
<td><a href="#heading--apc">apc</a></td>
<td>American Power Conversion (APC) PDU</td>
</tr>
<tr>
<td><a href="#heading--dli">dli</a></td>
<td>Digital Loggers, Inc. PDU</td>
</tr>
<tr>
<td><a href="#heading--eaton">eaton</a></td>
<td>Eaton PDU</td>
</tr>
<tr>
<td><a href="#heading--hmc">hmc</a></td>
<td>IBM Hardware Management Console (HMC)</td>
</tr>
<tr>
<td><a href="#heading--lxd">lxd</a></td>
<td>LXD VM</td>
</tr>
<tr>
<td><a href="#heading--ipmi">ipmi</a></td>
<td>IPMI</td>
</tr>
<tr>
<td><a href="#heading--manual">manual</a></td>
<td>Manual power configuration</td>
</tr>
<tr>
<td><a href="#heading--moonshot">moonshot</a></td>
<td>HP Moonshot - iLO4 (IPMI)</td>
</tr>
<tr>
<td><a href="#heading--mscm">mscm</a></td>
<td>HP Moonshot - iLO Chassis Manager</td>
</tr>
<tr>
<td><a href="#heading--mscm">msftocs</a></td>
<td>Microsoft OCS - Chassis Manager</td>
</tr>
<tr>
<td><a href="#heading--nova">nova</a></td>
<td>OpenStack Nova</td>
</tr>
<tr>
<td><a href="#heading--openbmc">openbmc</a></td>
<td>OpenBMC Power Driver</td>
</tr>
<tr>
<td><a href="#heading--recs_box">recs_box</a></td>
<td>Christmann RECS-Box Power Driver</td>
</tr>
<tr>
<td><a href="#heading--redfish">redfish</a></td>
<td>Redfish</td>
</tr>
<tr>
<td><a href="#heading--sm15k">sm15k</a></td>
<td>SeaMicro 15000</td>
</tr>
<tr>
<td><a href="#heading--ucsm">ucsm</a></td>
<td>Cisco UCS Manager</td>
</tr>
<tr>
<td><a href="#heading--virsh">virsh</a></td>
<td>libvirt KVM</td>
</tr>
<tr>
<td><a href="#heading--vmware">vmware</a></td>
<td>VMware</td>
</tr>
<tr>
<td><a href="#heading--wedge">wedge</a></td>
<td>Facebook&rsquo;s Wedge</td>
</tr>
</tbody>
</table>
<p>Note the required and optional parameters associated with each power type.</p>
<p>Once you&rsquo;ve successfully processed the command (as indicated by a stream of JSON, headed by &ldquo;Success!&rdquo;), MAAS performs a power check on the machine. A successful power check is a good indication that MAAS can properly communicate with the machine, that is, it should quickly result in a power status of &ldquo;Power off&rdquo;. A failed attempt will return errors that should guide you to fix your power_parameters.</p>
<p><a href="#heading--power-catalogue"><h2 id="heading--power-catalogue">Power catalogue</h2></a></p>
<p><a href="#heading--amt"><h3 id="heading--amt">Intel AMT</h3></a></p>
<p>All parameters are entered as <code>key=value</code>, e.g., <code>power_type=amt</code>.  The MAAS CLI will refuse the request with informative errors if required parameters are excluded.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>power_type</code></td>
<td><code>amt</code></td>
<td>Required</td>
</tr>
<tr>
<td><code>power_address</code></td>
<td>IP address of unit</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_pass</code></td>
<td>Password to access unit</td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p><a href="#heading--apc"><h3 id="heading--apc">American Power Conversion (APC) PDU</h3></a></p>
<p>All parameters are entered as <code>key=value</code>, e.g., <code>power_type=apc</code>.  The MAAS CLI will refuse the request with informative errors if required parameters are excluded.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>power_type</code></td>
<td><code>apc</code></td>
<td>Required</td>
</tr>
<tr>
<td><code>power_address</code></td>
<td>IP address of unit</td>
<td>Required</td>
</tr>
<tr>
<td><code>node_outlet</code></td>
<td>PDU node outlet number</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_on_delay</code></td>
<td>outlet power ON delay</td>
<td>Optional, default=5</td>
</tr>
</tbody>
</table>
<p><a href="#heading--dli"><h3 id="heading--dli">Digital Loggers, Inc. PDU</h3></a></p>
<p>All parameters are entered as <code>key=value</code>, e.g., <code>power_type=dli</code>.  The MAAS CLI will refuse the request with informative errors if required parameters are excluded.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>power_type</code></td>
<td><code>dli</code></td>
<td>Required</td>
</tr>
<tr>
<td><code>outlet_id</code></td>
<td>outlet ID</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_address</code></td>
<td>IP address of unit</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_user</code></td>
<td>Username to login</td>
<td>Optional</td>
</tr>
<tr>
<td><code>power_pass</code></td>
<td>Password to access unit</td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p><a href="#heading--eaton"><h3 id="heading--eaton">Eaton PDU</h3></a></p>
<p>All parameters are entered as <code>key=value</code>, e.g., <code>power_type=eaton</code>.  The MAAS CLI will refuse the request with informative errors if required parameters are excluded.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>power_type</code></td>
<td><code>eaton</code></td>
<td>Required</td>
</tr>
<tr>
<td><code>power_address</code></td>
<td>IP address of unit</td>
<td>Required</td>
</tr>
<tr>
<td><code>node_outlet</code></td>
<td>PDU node outlet number</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_on_delay</code></td>
<td>outlet power ON delay</td>
<td>Optional, default=5</td>
</tr>
</tbody>
</table>
<p><a href="#heading--hmc"><h3 id="heading--hmc">IBM Hardware Management Console (HMC)</h3></a></p>
<p>All parameters are entered as <code>key=value</code>, e.g., <code>power_type=hmc</code>.  The MAAS CLI will refuse the request with informative errors if required parameters are excluded.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>power_type</code></td>
<td><code>hmc</code></td>
<td>Required</td>
</tr>
<tr>
<td><code>power_address</code></td>
<td>IP address of unit</td>
<td>Required</td>
</tr>
<tr>
<td><code>server_name</code></td>
<td>HMC managed server name</td>
<td>Required</td>
</tr>
<tr>
<td><code>lpar</code></td>
<td>HMC logical partition of unit</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_user</code></td>
<td>Username to login</td>
<td>Optional</td>
</tr>
<tr>
<td><code>power_pass</code></td>
<td>Password to access unit</td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p><a href="#heading--lxd"><h3 id="heading--lxd">LXD VMs</h3></a></p>
<p>All parameters are entered as <code>key=value</code>, e.g., <code>power_type=lxd</code>.  The MAAS CLI will refuse the request with informative errors if required parameters are excluded.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>power_type</code></td>
<td><code>lxd</code></td>
<td>Required</td>
</tr>
<tr>
<td><code>power_address</code></td>
<td>IP address of unit</td>
<td>Required</td>
</tr>
<tr>
<td><code>instance_name</code></td>
<td>LXD container instance name</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_pass</code></td>
<td>Password to access unit</td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p><a href="#heading--ipmi"><h3 id="heading--ipmi">IPMI</h3></a></p>
<p>All parameters are entered as <code>key=value</code>, e.g., <code>power_type=amt</code>.  The MAAS CLI will refuse the request with informative errors if required parameters are excluded.</p>
<p>Some of the fields for this power type have fixed choices, indicated in the &ldquo;Choices&rdquo; column.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Choices</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>power_type</code></td>
<td><code>ipmi</code></td>
<td></td>
<td>Required</td>
</tr>
<tr>
<td><code>power_driver</code></td>
<td>Power driver</td>
<td><code>LAN [IPMI 1.5]</code></td>
<td>Required</td>
</tr>
<tr>
<td></td>
<td></td>
<td><code>LAN_2_0 [IPMI 2.0]</code></td>
<td></td>
</tr>
<tr>
<td><code>power_boot_type</code></td>
<td>Boot type</td>
<td><code>Automatic</code></td>
<td>Required</td>
</tr>
<tr>
<td></td>
<td></td>
<td><code>Legacy boot</code></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td><code>EFI boot</code></td>
<td></td>
</tr>
<tr>
<td><code>power_address</code></td>
<td>IP address of unit</td>
<td></td>
<td>Required</td>
</tr>
<tr>
<td><code>power_user</code></td>
<td>Username to login</td>
<td></td>
<td>Optional</td>
</tr>
<tr>
<td><code>power_pass</code></td>
<td>Password to access unit</td>
<td></td>
<td>Optional</td>
</tr>
<tr>
<td><code>mac_address</code></td>
<td>MAC address of unit</td>
<td></td>
<td>Optional</td>
</tr>
<tr>
<td><code>k_g</code></td>
<td>K_g BMC key</td>
<td></td>
<td>Optional</td>
</tr>
<tr>
<td><code>cipher_suite_id</code></td>
<td>Cipher suite ID</td>
<td>- <code>17</code> <small>(17 - HMAC-SHA256::HMAC_SHA256_128::AES-CBC-128)</small></td>
<td>Optional</td>
</tr>
<tr>
<td></td>
<td></td>
<td><code>3</code> <small>(3 - HMAC-SHA1::HMAC-SHA1-96::AES-CBC-128)</small></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td><code></code> (blank) <small>(freeipmi-tools default)</small></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td><code>8</code> <small>(8 - HMAC-MD5::HMAC-MD5-128::AES-CBC-128)</small></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td><code>12</code> <small>(12 - HMAC-MD5::MD5-128::AES-CBC-128)</small></td>
<td></td>
</tr>
<tr>
<td><code>privilege_level</code></td>
<td>IPMI privilege level</td>
<td><code>User</code></td>
<td>Optional</td>
</tr>
<tr>
<td></td>
<td></td>
<td><code>Operator</code></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td><code>Administrator</code></td>
<td></td>
</tr>
<tr>
<td><code>mac_address</code></td>
<td>MAC address of unit</td>
<td></td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p><a href="#heading--manual"><h3 id="heading--manual">Manual power configuration</h3></a></p>
<p>Manual power configuration means exactly that &ndash; manually configured at the unit.  The only MAAS CLI parameter is <code>power_type=amt</code>. </p>
<p><a href="#heading--moonshot"><h3 id="heading--moonshot">HP Moonshot - iLO4 (IPMI)</h3></a></p>
<p>All parameters are entered as <code>key=value</code>, e.g., <code>power_type=moonshot</code>.  The MAAS CLI will refuse the request with informative errors if required parameters are excluded.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>power_type |</code>moonshot`</td>
<td>Required</td>
<td></td>
</tr>
<tr>
<td><code>power_address</code></td>
<td>IP address of unit</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_hwaddress</code></td>
<td>Hardware address of unit</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_user</code></td>
<td>Username to login</td>
<td>Optional</td>
</tr>
<tr>
<td><code>power_pass</code></td>
<td>Password to access unit</td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p><a href="#heading--mscm"><h3 id="heading--mscm">HP Moonshot - iLO Chassis Manager</h3></a></p>
<p>All parameters are entered as <code>key=value</code>, e.g., <code>power_type=mscm</code>.  The MAAS CLI will refuse the request with informative errors if required parameters are excluded.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>power_type |</code>mscm`</td>
<td>Required</td>
<td></td>
</tr>
<tr>
<td><code>power_address</code></td>
<td>IP address of unit</td>
<td>Required</td>
</tr>
<tr>
<td><code>node_id</code></td>
<td>cXnY</td>
<td>Required</td>
</tr>
<tr>
<td>- where</td>
<td>X = cartridge number</td>
<td></td>
</tr>
<tr>
<td></td>
<td>Y = node number</td>
<td></td>
</tr>
<tr>
<td><code>power_user</code></td>
<td>Username to login</td>
<td>Optional</td>
</tr>
<tr>
<td><code>power_pass</code></td>
<td>Password to access unit</td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p><a href="#heading--mscm"><h3 id="heading--mscm">Microsoft OCS - Chassis Manager</h3></a></p>
<p>All parameters are entered as <code>key=value</code>, e.g., <code>power_type=msftocs</code>.  The MAAS CLI will refuse the request with informative errors if required parameters are excluded.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>power_type |</code>msftocs`</td>
<td>Required</td>
<td></td>
</tr>
<tr>
<td><code>power_address</code></td>
<td>IP address of unit</td>
<td>Required</td>
</tr>
<tr>
<td><code>blade_id</code></td>
<td>Blade ID (usu. 1-24)</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_port</code></td>
<td>Port where unit is attached</td>
<td>Optional</td>
</tr>
<tr>
<td><code>power_user</code></td>
<td>Username to login</td>
<td>Optional</td>
</tr>
<tr>
<td><code>power_pass</code></td>
<td>Password to access unit</td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p><a href="#heading--nova"><h3 id="heading--nova">OpenStack Nova</h3></a></p>
<p>All parameters are entered as <code>key=value</code>, e.g., <code>power_type=nova</code>.  The MAAS CLI will refuse the request with informative errors if required parameters are excluded.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>power_type |</code>nova`</td>
<td>Required</td>
<td></td>
</tr>
<tr>
<td><code>nova_id</code></td>
<td>Host UUID</td>
<td>Required</td>
</tr>
<tr>
<td><code>os_tenantname</code></td>
<td>Tenant name</td>
<td>Required</td>
</tr>
<tr>
<td><code>os_username</code></td>
<td>Username to login</td>
<td>Required</td>
</tr>
<tr>
<td><code>os_password</code></td>
<td>Password to access unit</td>
<td>Required</td>
</tr>
<tr>
<td><code>os_authurl</code></td>
<td>URL to access unit</td>
<td>Required</td>
</tr>
</tbody>
</table>
<p><a href="#heading--openbmc"><h3 id="heading--openbmc">OpenBMC Power Driver</h3></a></p>
<p>All parameters are entered as <code>key=value</code>, e.g., <code>power_type=openbmc</code>.  The MAAS CLI will refuse the request with informative errors if required parameters are excluded.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>power_type</code></td>
<td><code>openbmc</code></td>
<td>Required</td>
</tr>
<tr>
<td><code>power_address</code></td>
<td>IP address of unit</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_user</code></td>
<td>Username to login</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_pass</code></td>
<td>Password to access unit</td>
<td>Required</td>
</tr>
</tbody>
</table>
<p><a href="#heading--recs_box"><h3 id="heading--recs_box">Christmann RECS-Box Power Driver</h3></a></p>
<p>All parameters are entered as <code>key=value</code>, e.g., <code>power_type=recs_box</code>.  The MAAS CLI will refuse the request with informative errors if required parameters are excluded.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>power_type |</code>recs_box`</td>
<td>Required</td>
<td></td>
</tr>
<tr>
<td><code>node_id</code></td>
<td>Node ID</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_address</code></td>
<td>IP address of unit</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_port</code></td>
<td>Port where unit is attached</td>
<td>Optional</td>
</tr>
<tr>
<td><code>power_user</code></td>
<td>Username to login</td>
<td>Optional</td>
</tr>
<tr>
<td><code>power_pass</code></td>
<td>Password to access unit</td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p><a href="#heading--redfish"><h3 id="heading--redfish">Redfish</h3></a></p>
<p>All parameters are entered as <code>key=value</code>, e.g., <code>power_type=redfish</code>.  The MAAS CLI will refuse the request with informative errors if required parameters are excluded.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>power_type |</code>redfish`</td>
<td>Required</td>
<td></td>
</tr>
<tr>
<td><code>power_address</code></td>
<td>IP address of unit</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_user</code></td>
<td>Username to login</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_pass</code></td>
<td>Password to access unit</td>
<td>Required</td>
</tr>
<tr>
<td><code>node_id</code></td>
<td>Node ID</td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p><a href="#heading--sm15k"><h3 id="heading--sm15k">SeaMicro 15000</h3></a></p>
<p>All parameters are entered as <code>key=value</code>, e.g., <code>power_type=sm15k</code>.  The MAAS CLI will refuse the request with informative errors if required parameters are excluded.</p>
<p>Some of the fields for this power type have fixed choices, indicated in the &ldquo;Choices&rdquo; column.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Choices</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>power_type</code></td>
<td><code>sm15k</code></td>
<td></td>
<td>Required</td>
</tr>
<tr>
<td><code>system_id</code></td>
<td>System ID</td>
<td></td>
<td>Required</td>
</tr>
<tr>
<td><code>power_address</code></td>
<td>IP address of unit</td>
<td></td>
<td>Required</td>
</tr>
<tr>
<td><code>power_control</code></td>
<td>Password to access unit</td>
<td>ipmi</td>
<td>Required</td>
</tr>
<tr>
<td></td>
<td></td>
<td>restapi</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>restapi2</td>
<td></td>
</tr>
<tr>
<td><code>power_user</code></td>
<td>Username to login</td>
<td></td>
<td>Optional</td>
</tr>
<tr>
<td><code>power_pass</code></td>
<td>Password to access unit</td>
<td></td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p><a href="#heading--ucsm"><h3 id="heading--ucsm">Cisco UCS Manager</h3></a></p>
<p>All parameters are entered as <code>key=value</code>, e.g., <code>power_type=ucsm</code>.  The MAAS CLI will refuse the request with informative errors if required parameters are excluded.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>power_type</code></td>
<td><code>ucsm</code></td>
<td>Required</td>
</tr>
<tr>
<td><code>uuid</code></td>
<td>Server UUID</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_address</code></td>
<td>URL for XML API</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_user</code></td>
<td>API user</td>
<td>Optional</td>
</tr>
<tr>
<td><code>power_pass</code></td>
<td>API password</td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p><a href="#heading--virsh"><h3 id="heading--virsh">virsh - libvirt KVM</h3></a></p>
<p>All parameters are entered as <code>key=value</code>, e.g., <code>power_type=virsh</code>.  The MAAS CLI will refuse the request with informative errors if required parameters are excluded.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>power_type</code></td>
<td><code>virsh</code></td>
<td>Required</td>
</tr>
<tr>
<td><code>power_id</code></td>
<td>libvirt VM UUID</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_address</code></td>
<td>URL of VM</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_pass</code></td>
<td>API password</td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p><a href="#heading--vmware"><h3 id="heading--vmware">VMware</h3></a></p>
<p>All parameters are entered as <code>key=value</code>, e.g., <code>power_type=vmware</code>.  The MAAS CLI will refuse the request with informative errors if required parameters are excluded.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>power_type</code></td>
<td><code>vmware</code></td>
<td>Required</td>
</tr>
<tr>
<td><code>power_vm_name</code></td>
<td>VM name (if UUID unknown)</td>
<td>Optional</td>
</tr>
<tr>
<td><code>power_uuid</code></td>
<td>VM UUID (if known)</td>
<td>Optional</td>
</tr>
<tr>
<td><code>power_address</code></td>
<td>IP address of VM</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_user</code></td>
<td>Username to access VM</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_pass</code></td>
<td>Password to access VM</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_port</code></td>
<td>VMware API port number</td>
<td>Optional</td>
</tr>
<tr>
<td><code>power_protocol</code></td>
<td>VMware API protocol</td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p><a href="#heading--wedge"><h3 id="heading--wedge">Facebook&rsquo;s Wedge</h3></a></p>
<p>All parameters are entered as <code>key=value</code>, e.g., <code>power_type=amt</code>.  The MAAS CLI will refuse the request with informative errors if required parameters are excluded.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>power_type</code></td>
<td><code>wedge</code></td>
<td>Required</td>
</tr>
<tr>
<td><code>power_address</code></td>
<td>IP address of unit</td>
<td>Required</td>
</tr>
<tr>
<td><code>power_user</code></td>
<td>Username to access unit</td>
<td>Optional</td>
</tr>
<tr>
<td><code>power_pass</code></td>
<td>Password to access unit</td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p><a href="#heading--example-virsh-kvm-power-type"><h2 id="heading--example-virsh-kvm-power-type">An example: the Virsh power type</h2></a></p>
<p>Consider a machine backed by a KVM, accessed via <code>virsh</code>.  You can create a corresponding MAAS machine and set its power parameters with a command like this one:</p>
<pre><code>maas admin machines create \
architecture=amd64 \
mac_addresses=52:54:00:15:36:f2 \
power_type=virsh \
power_parameters_power_id=f677a842-571c-4e65-adc9-11e2cf92d363 \
power_parameters_power_address=qemu+ssh://stormrider@192.168.123.1/system \
power_parameters_power_pass=xxxxxxxx
</code></pre>
<p>If successful, this will return: </p>
<pre><code>Success.
</code></pre>
<p>Machine-readable output follows this announcement.  The JSON generated by this command is shown in the detail block.</p>
<p><details><summary>MAAS command JSON response</summary></p>
<pre><code>{
    &quot;storage&quot;: 0.0,
    &quot;tag_names&quot;: [],
    &quot;special_filesystems&quot;: [],
    &quot;memory&quot;: 0,
    &quot;boot_disk&quot;: null,
    &quot;virtualblockdevice_set&quot;: [],
    &quot;hardware_info&quot;: {
        &quot;system_vendor&quot;: &quot;Unknown&quot;,
        &quot;system_product&quot;: &quot;Unknown&quot;,
        &quot;system_family&quot;: &quot;Unknown&quot;,
        &quot;system_version&quot;: &quot;Unknown&quot;,
        &quot;system_sku&quot;: &quot;Unknown&quot;,
        &quot;system_serial&quot;: &quot;Unknown&quot;,
        &quot;cpu_model&quot;: &quot;Unknown&quot;,
        &quot;mainboard_vendor&quot;: &quot;Unknown&quot;,
        &quot;mainboard_product&quot;: &quot;Unknown&quot;,
        &quot;mainboard_serial&quot;: &quot;Unknown&quot;,
        &quot;mainboard_version&quot;: &quot;Unknown&quot;,
        &quot;mainboard_firmware_vendor&quot;: &quot;Unknown&quot;,
        &quot;mainboard_firmware_date&quot;: &quot;Unknown&quot;,
        &quot;mainboard_firmware_version&quot;: &quot;Unknown&quot;,
        &quot;chassis_vendor&quot;: &quot;Unknown&quot;,
        &quot;chassis_type&quot;: &quot;Unknown&quot;,
        &quot;chassis_serial&quot;: &quot;Unknown&quot;,
        &quot;chassis_version&quot;: &quot;Unknown&quot;
    },
    &quot;address_ttl&quot;: null,
    &quot;memory_test_status&quot;: -1,
    &quot;other_test_status_name&quot;: &quot;Unknown&quot;,
    &quot;osystem&quot;: &quot;&quot;,
    &quot;status_message&quot;: &quot;Commissioning&quot;,
    &quot;netboot&quot;: true,
    &quot;physicalblockdevice_set&quot;: [],
    &quot;node_type&quot;: 0,
    &quot;cpu_test_status&quot;: -1,
    &quot;memory_test_status_name&quot;: &quot;Unknown&quot;,
    &quot;bcaches&quot;: [],
    &quot;storage_test_status&quot;: 0,
    &quot;system_id&quot;: &quot;bhxws3&quot;,
    &quot;status&quot;: 1,
    &quot;commissioning_status&quot;: 0,
    &quot;power_type&quot;: &quot;virsh&quot;,
    &quot;locked&quot;: false,
    &quot;numanode_set&quot;: [
        {
            &quot;index&quot;: 0,
            &quot;memory&quot;: 0,
            &quot;cores&quot;: []
        }
    ],
    &quot;bios_boot_method&quot;: null,
    &quot;fqdn&quot;: &quot;ace-swan.maas&quot;,
    &quot;node_type_name&quot;: &quot;Machine&quot;,
    &quot;hostname&quot;: &quot;ace-swan&quot;,
    &quot;volume_groups&quot;: [],
    &quot;testing_status&quot;: 0,
    &quot;network_test_status&quot;: -1,
    &quot;other_test_status&quot;: -1,
    &quot;interface_test_status&quot;: -1,
    &quot;hwe_kernel&quot;: null,
    &quot;blockdevice_set&quot;: [],
    &quot;testing_status_name&quot;: &quot;Pending&quot;,
    &quot;power_state&quot;: &quot;unknown&quot;,
    &quot;min_hwe_kernel&quot;: &quot;&quot;,
    &quot;owner&quot;: &quot;admin&quot;,
    &quot;distro_series&quot;: &quot;&quot;,
    &quot;storage_test_status_name&quot;: &quot;Pending&quot;,
    &quot;cpu_speed&quot;: 0,
    &quot;swap_size&quot;: null,
    &quot;cpu_test_status_name&quot;: &quot;Unknown&quot;,
    &quot;hardware_uuid&quot;: null,
    &quot;architecture&quot;: &quot;amd64/generic&quot;,
    &quot;pool&quot;: {
        &quot;name&quot;: &quot;default&quot;,
        &quot;description&quot;: &quot;Default pool&quot;,
        &quot;id&quot;: 0,
        &quot;resource_uri&quot;: &quot;/MAAS/api/2.0/resourcepool/0/&quot;
    },
    &quot;cache_sets&quot;: [],
    &quot;pod&quot;: null,
    &quot;iscsiblockdevice_set&quot;: [],
    &quot;disable_ipv4&quot;: false,
    &quot;status_action&quot;: &quot;&quot;,
    &quot;boot_interface&quot;: {
        &quot;name&quot;: &quot;eth0&quot;,
        &quot;id&quot;: 10,
        &quot;product&quot;: null,
        &quot;system_id&quot;: &quot;bhxws3&quot;,
        &quot;effective_mtu&quot;: 1500,
        &quot;children&quot;: [],
        &quot;link_connected&quot;: true,
        &quot;enabled&quot;: true,
        &quot;interface_speed&quot;: 0,
        &quot;numa_node&quot;: 0,
        &quot;firmware_version&quot;: null,
        &quot;parents&quot;: [],
        &quot;discovered&quot;: null,
        &quot;params&quot;: &quot;&quot;,
        &quot;links&quot;: [],
        &quot;sriov_max_vf&quot;: 0,
        &quot;tags&quot;: [],
        &quot;type&quot;: &quot;physical&quot;,
        &quot;vlan&quot;: null,
        &quot;vendor&quot;: null,
        &quot;link_speed&quot;: 0,
        &quot;mac_address&quot;: &quot;52:54:00:15:36:f2&quot;,
        &quot;resource_uri&quot;: &quot;/MAAS/api/2.0/nodes/bhxws3/interfaces/10/&quot;
    },
    &quot;cpu_count&quot;: 0,
    &quot;domain&quot;: {
        &quot;authoritative&quot;: true,
        &quot;ttl&quot;: null,
        &quot;resource_record_count&quot;: 0,
        &quot;name&quot;: &quot;maas&quot;,
        &quot;is_default&quot;: true,
        &quot;id&quot;: 0,
        &quot;resource_uri&quot;: &quot;/MAAS/api/2.0/domains/0/&quot;
    },
    &quot;current_testing_result_id&quot;: 7,
    &quot;default_gateways&quot;: {
        &quot;ipv4&quot;: {
            &quot;gateway_ip&quot;: null,
            &quot;link_id&quot;: null
        },
        &quot;ipv6&quot;: {
            &quot;gateway_ip&quot;: null,
            &quot;link_id&quot;: null
        }
    },
    &quot;interface_set&quot;: [
        {
            &quot;name&quot;: &quot;eth0&quot;,
            &quot;id&quot;: 10,
            &quot;product&quot;: null,
            &quot;system_id&quot;: &quot;bhxws3&quot;,
            &quot;effective_mtu&quot;: 1500,
            &quot;children&quot;: [],
            &quot;link_connected&quot;: true,
            &quot;enabled&quot;: true,
            &quot;interface_speed&quot;: 0,
            &quot;numa_node&quot;: 0,
            &quot;firmware_version&quot;: null,
            &quot;parents&quot;: [],
            &quot;discovered&quot;: null,
            &quot;params&quot;: &quot;&quot;,
            &quot;links&quot;: [],
            &quot;sriov_max_vf&quot;: 0,
            &quot;tags&quot;: [],
            &quot;type&quot;: &quot;physical&quot;,
            &quot;vlan&quot;: null,
            &quot;vendor&quot;: null,
            &quot;link_speed&quot;: 0,
            &quot;mac_address&quot;: &quot;52:54:00:15:36:f2&quot;,
            &quot;resource_uri&quot;: &quot;/MAAS/api/2.0/nodes/bhxws3/interfaces/10/&quot;
        }
    ],
    &quot;status_name&quot;: &quot;Commissioning&quot;,
    &quot;commissioning_status_name&quot;: &quot;Pending&quot;,
    &quot;owner_data&quot;: {},
    &quot;ip_addresses&quot;: [],
    &quot;raids&quot;: [],
    &quot;network_test_status_name&quot;: &quot;Unknown&quot;,
    &quot;description&quot;: &quot;&quot;,
    &quot;current_commissioning_result_id&quot;: 6,
    &quot;interface_test_status_name&quot;: &quot;Unknown&quot;,
    &quot;current_installation_result_id&quot;: null,
    &quot;zone&quot;: {
        &quot;name&quot;: &quot;default&quot;,
        &quot;description&quot;: &quot;&quot;,
        &quot;id&quot;: 1,
        &quot;resource_uri&quot;: &quot;/MAAS/api/2.0/zones/default/&quot;
    },
    &quot;resource_uri&quot;: &quot;/MAAS/api/2.0/machines/bhxws3/&quot;
}
</code></pre>

<p></details></p>
<p><a href="#heading--bmc-driver-support"><h2 id="heading--bmc-driver-support">Which BMC drivers are supported</h2></a></p>
<p>MAAS supports many types of BMC hardware, though not all the drivers have the same capabilities. See the below table for a feature comparison of the BMC drivers currently supported by MAAS.</p>
<p><details><summary>Tell me about BMC</summary></p>
<p>BMC, or &ldquo;Baseboard Management Controller,&rdquo; is an extra micro-controller on the motherboard of a server which forms the interface between system-management software and the device&rsquo;s hardware.  The BMC can collect data from attached sensors, alert administrators to issues, and respond to remote-control commands to control system operation or power state, independent of the system&rsquo;s CPU.</p>
<p>In the context of MAAS, the BMC is generally controlled by SNMP commands.  Any given BMC will function in the context of one or more &ldquo;power types,&rdquo; which are physical interfaces that permit use of the IPMI (&ldquo;Intelligent Platform Management Interface&rdquo;) protocol.  Each power type has a different set of expected parameters required to access and command the BMC.</p>
<p></details></p>
<table>
<colgroup>
<col width="35%" />
<col width="12%" />
<col width="10%" />
<col width="14%" />
<col width="15%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Power Driver (<em>X=supported</em>)</th>
<th>PXE Next Boot</th>
<th>Power Querying</th>
<th>Chassis/Pod Configuration</th>
<th>Enhanced UI Error Reporting</th>
<th>BMC Enlistment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">American Power Conversion (APC) - PDU</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td align="left">Cisco UCS Manager</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td align="left">Digital Loggers, Inc. - PDU</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td align="left">Facebook's Wedge <code>*</code></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td align="left">HP Moonshot - iLO Chassis Manager</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td align="left">HP Moonshot - iLO4 (IPMI)</td>
<td>X</td>
<td>X</td>
<td></td>
<td></td>
<td>X</td>
</tr>
<tr class="odd">
<td align="left">IBM Hardware Management Console (HMC)</td>
<td>X</td>
<td>X</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td align="left">IPMI</td>
<td>X</td>
<td>X</td>
<td></td>
<td>X</td>
<td>X</td>
</tr>
<tr class="odd">
<td align="left">Intel AMT</td>
<td>X</td>
<td>X</td>
<td></td>
<td>X</td>
<td></td>
</tr>
<tr class="even">
<td align="left">Manual</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td align="left">Microsoft OCS - Chassis Manager</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td align="left">OpenStack Nova</td>
<td></td>
<td>X</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td align="left">Rack Scale Design</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td align="left">SeaMicro 15000</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td align="left">Sentry Switch CDU - PDU</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td align="left">VMWare</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td align="left">Virsh (virtual systems)</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

<p><code>*</code> The &lsquo;Facebook&rsquo;s Wedge&rsquo; OpenBMC power driver is considered experimental at this time.</p>
<p><a href="#heading--configure-use-ibm-z"><h2 id="heading--configure-use-ibm-z">How do I configure and use IBM Z with MAAS?</h2></a></p>
<p>The IBM Z or LinuxONE system can host MAAS controllers and is able to deploy predefined logical partitions (LPARs) KVM host(s), and virtual machines, if the mainframe is set up properly for MAAS.</p>
<p>The basic architecture is similar to this:</p>
<p><a href="images/d78aec0bd5d5f485697701ed7316944f918fef94.png" target = "_blank"><img src="images/d78aec0bd5d5f485697701ed7316944f918fef94.png"></a></a></p>
<p>Networking would be structured like this:</p>
<p><a href="images/841305949182ba64037f9806396a0e60fdc46d23.png" target = "_blank"><img src="images/841305949182ba64037f9806396a0e60fdc46d23.png"></a></a></p>
<p>Note that net-booting the KVM guests (through the two bridges) can be problematic.  There are two options:</p>
<ol>
<li>
<p>Adding VNIC characteristics to enable &ldquo;learning&rdquo; on the network interface that&rsquo;s the base for bridge &ldquo;br2.&rdquo;  This is the recommended approach.</p>
</li>
<li>
<p>Enable full promiscuous bridge port mode at the network interface that&rsquo;s the base for bridge &ldquo;br2.&rdquo;  This approach is not recommended because it has some built-in limitations.</p>
</li>
</ol>
<p>MAAS will automatically configure option 1 for you, in case an LPAR is deployed as KVM host (the bridge names may differ).</p>
<p>In order to achieve this configuration, there are a number of steps that must be executed; specifically, you must know how to:</p>
<ul>
<li><a href="#heading--ibm-z-requirements">Evaluate IBM Z requirements</a></li>
<li><a href="#heading--ibm-z-login">Login to the IBM Z</a></li>
<li><a href="#heading--set-up-ibm-z-partition">Set up a suitable partition for MAAS</a></li>
<li><a href="#heading--set-up-ibm-z-networking">Set up networking for MAAS</a></li>
<li><a href="#heading--set-up-ibm-z-storage">Set up storage for MAAS</a></li>
<li><a href="#heading--set-the-boot-parameters">Set the partition boot parameters</a></li>
<li><a href="#heading--set-up-ibm-z-enlistment">Set up your IBM Z virtual machines for enlistment</a></li>
</ul>
<p>The MAAS controller does not necessarily need to run on an LPAR on the IBM Z system itself, but can also run on a different system outside. But since the MAAS controller requires a network connection to the hardware management console (HMC), it is recommended to keep it co-located and (for security reasons) as close as possible to the HMC and run it in a dedicated LPAR.</p>
<p>Such a MAAS controller LPAR should have at least two SMT hardware threads (one IFL), since it runs several services (bind, rack-, region-controller and more), 16 GB RAM and 100 GB disk space - recommended is to use the double amount of these resources.</p>
<p>The resources of the LPARs to deploy on (&lsquo;machines&rsquo; in terms of MAAS) depending on the use case. LPARs that are deployed as KVM host would of course require significantly more resources to be able to host KVM guest on top.</p>
<p>There are several constraints on the definition and setup of the &lsquo;machine&rsquo; LPARs - please see below.</p>
<p><a href="#heading--ibm-z-requirements"><h3 id="heading--ibm-z-requirements">Evaluate IBM Z requirements</h3></a></p>
<p>The system requirements to host MAAS and its virtual machines on the IBM Z platform are as follows:</p>
<ul>
<li>IBM z14 GA2 (or newer) or IBM LinuxONE III (or newer)</li>
<li>HMC running in DPM mode (mandatory, traditional mode is not supported!)</li>
<li>HMC firmware level H39 - (HMC at H40 and SE at S55) </li>
<li>HMCs Rest-API enabled </li>
<li>python-zhmcclient (0.29 or later) running on the MAAS controller system, connected to the HMC</li>
<li>HMC user ID for the zhmcclient access to the HMC API (must have permissions for the “Manage Web Services API Logs” role and “Manage Web Services API Logs” role)</li>
<li>I/O auto-configuration enabled for the ‘machine’ LPARs</li>
<li>zFCP (SCSI) disk storage (only, no DASD support), recommended are two disks, one defined as type ‘boot,’ the second as type ‘data’</li>
<li>a dedicated storage group per ‘machine’ LPAR; these must include the dedicated zFCP storage for this particular managed LPAR only (‘boot’ and ‘data’ for LPAR n) - but no additional shared storage!</li>
<li>qeth network devices (Hipersockets or OSA, recommended); at least one qeth NIC, recommended two (or more)</li>
<li>Ubuntu Server 20.04 installed on a dedicated system (LPAR or PC), that acts as MAAS Controller</li>
<li>one or more LPARs as ‘machines’ (aka MAAS deployment targets)</li>
</ul>
<p>Be aware that these are minimum system requirements.</p>
<p><a href="#heading--ibm-z-login"><h3 id="heading--ibm-z-login">Access the HMC and login to the IBM Z</h3></a></p>
<p>To login to the HMC, you must have at least “system programmer” privileges. Gaining that level of access is beyond the scope of this document. Once you are sure that you have the necessary access, you first need to navigate to the Hardware Management Console (HMC) application in your Web browser:</p>
<p><a href="images/d085c8113e403546484778c858c27344e8986597.png" target = "_blank"><img src="images/d085c8113e403546484778c858c27344e8986597.png"></a></a></p>
<p>Click on the &ldquo;Log on&hellip;&rdquo; link, which will bring you to a login screen:</p>
<p><a href="images/5ccdfac4dc985260dcedd01284d24c5e8e5199d9.png" target = "_blank"><img src="images/5ccdfac4dc985260dcedd01284d24c5e8e5199d9.png"></a></a></p>
<p>Upon successfully logging on, you will land on the Welcome Screen:</p>
<p><a href="images/d18afe140a1971621ed44fa5fae36033927e293e.png" target = "_blank"><img src="images/d18afe140a1971621ed44fa5fae36033927e293e.png"></a></a></p>
<p>Select the &ldquo;Tasks Index&rdquo; on the left-hand navigation:</p>
<p><a href="images/c030c8280b0a6dcfdd0365f9cf50238ae708e34b.jpeg" target = "_blank"><img src="images/c030c8280b0a6dcfdd0365f9cf50238ae708e34b.jpeg"></a></a></p>
<p>From here, you will be able to access the commands needed to prepare your IBM Z to host MAAS.</p>
<p><a href="#heading--set-up-ibm-z-partition"><h3 id="heading--set-up-ibm-z-partition">Set up a suitable IBM Z partition for a MAAS machine</h3></a></p>
<p>In order to prevent MAAS from taking over the entire system, you must assign both the controller and the ‘machines’ / KVM hosts to specific partitions, with suitable limitations. To set up suitable IBM Z partitions for hosting MAAS, you must choose “Partition Details” from the “Tasks Index,” which will bring you to a screen like this one:</p>
<p><a href="images/29e0cc00d68a5add1b13b1d50313ff6966f251a9.png" target = "_blank"><img src="images/29e0cc00d68a5add1b13b1d50313ff6966f251a9.png"></a></a></p>
<p>You must then choose the “target object” (in this case we’ve chosen TA05) to be operated upon:</p>
<p><a href="images/754c4926ecf5d9330b60c9b58bdd15bde6f24144.png" target = "_blank"><img src="images/754c4926ecf5d9330b60c9b58bdd15bde6f24144.png"></a></a></p>
<p>Click “OK,” and you’ll arrive at a screen similar to the one below:</p>
<p><a href="images/0ecf9bd89c132fd2c7ff8b879dd6c1b4d3090a99.png" target = "_blank"><img src="images/0ecf9bd89c132fd2c7ff8b879dd6c1b4d3090a99.png"></a></a></p>
<p>Make sure you’re on the “Partitions” tab, and select the desired object (“TA05…”):</p>
<p><a href="images/018d8309a1a16571df56a6672cff26e60f42075a.jpeg" target = "_blank"><img src="images/018d8309a1a16571df56a6672cff26e60f42075a.jpeg"></a></a></p>
<p>Right-click on the selected object and select “Partition Details:”</p>
<p><a href="images/5a7f696435b504eb212234acdd09c928f16b1670.jpeg" target = "_blank"><img src="images/5a7f696435b504eb212234acdd09c928f16b1670.jpeg"></a></a></p>
<p>On the “General” tab, edit the partition details to suit your proposed MAAS deployment:</p>
<p><a href="images/60ff5ca98d8b615ee4a947607872c973cf2c7f41.png" target = "_blank"><img src="images/60ff5ca98d8b615ee4a947607872c973cf2c7f41.png"></a></a></p>
<p>Next, you will set up the networking details for this partition, as shown in the following section.</p>
<p><a href="#heading--set-up-ibm-z-networking"><h3 id="heading--set-up-ibm-z-networking">Set up IBM Z networking for a MAAS machine</h3></a></p>
<p>To properly enable networking within the IBMZ partitions, you must change to the “Network” tab under “Partition Details:”</p>
<p><a href="images/daf386497781df42ba7ffaa518c1f186ebef66ee.png" target = "_blank"><img src="images/daf386497781df42ba7ffaa518c1f186ebef66ee.png"></a></a></p>
<p>Click on the NIC of interest to bring up the “NIC Details” screen:</p>
<p><a href="images/e9b65711cf97dd722db1b1df4b69d4f590166a99.png" target = "_blank"><img src="images/e9b65711cf97dd722db1b1df4b69d4f590166a99.png"></a></a></p>
<p>Confirm that the parameters on this screen are consistent with your planned MAAS deployment, then bring up the network adapter(either OSA or Hipersockets) by selecting it:</p>
<p><a href="images/0a0873d7cd40147884c861d1fcde15ddc37c8853.png" target = "_blank"><img src="images/0a0873d7cd40147884c861d1fcde15ddc37c8853.png"></a></a></p>
<p>Ensure that all settings on the “General” tab conform to your planned MAAS deployment; then select the “Network Interface Cards” tab on the left-hand navigation:</p>
<p><a href="images/0a0873d7cd40147884c861d1fcde15ddc37c8853.png" target = "_blank"><img src="images/0a0873d7cd40147884c861d1fcde15ddc37c8853.png"></a></a></p>
<p>Again, ensure that the parameters associated with the networking arrangement are consistent with your planned MAAS deployment.</p>
<p>Next, you will set up the storage layout for your MAAS partition(s).</p>
<p><a href="#heading--set-up-ibm-z-storage"><h3 id="heading--set-up-ibm-z-storage">Set up IBM Z storage for a MAAS machine</h3></a></p>
<p>To set up suitable storage for a MAAS deployment, you should bring up the “Partition Details” for your chosen MAAS partition and select the “Storage” tab from the left-hand navigation:</p>
<p><a href="images/c25792eeacd5aef57ca74a68b203c23ed74268d7.png" target = "_blank"><img src="images/c25792eeacd5aef57ca74a68b203c23ed74268d7.png"></a></a></p>
<p>Choose the “VOLUMES” sub-tab, and lick on the hyperlinked partition name to bring up the storage configuration tab:</p>
<p><a href="images/cf8d1427abda94ccd3b79966d06bee210ac1240b.png" target = "_blank"><img src="images/cf8d1427abda94ccd3b79966d06bee210ac1240b.png"></a></a></p>
<p>Click on “GET DETAILS” for the Boot Volume in the Volume list to bring up the “Configuration details” screen:</p>
<p><a href="images/a081c97b8196e708495156187b983b70c32fcdc5.png" target = "_blank"><img src="images/a081c97b8196e708495156187b983b70c32fcdc5.png"></a></a></p>
<p>Ensure that the Boot Volume is configured appropriately for your planned MAAS deployment, then click “Done.” Then return to the storage configuration tab and choose the Data Volume, and tune it to the appropriate parameters.</p>
<p>Next, choose the “ADAPTERS” sub-tab to bring up information on the storage adapters:</p>
<p><a href="images/821edff17e3fe8f2fbf9b5cb1682928dc9bb34d7.png" target = "_blank"><img src="images/821edff17e3fe8f2fbf9b5cb1682928dc9bb34d7.png"></a></a></p>
<p>Set any necessary parameters to conform to your planned MAAS deployment.</p>
<p><a href="#heading--set-the-boot-parameters"><h3 id="heading--set-the-boot-parameters">Set the partition boot parameters</h3></a></p>
<p>Return to the “Partition Details” screen and select the “Boot” tab in the left-hand navigation:</p>
<p><a href="images/c5df4937135c1a9a1758b20855742bd038700c65.png" target = "_blank"><img src="images/c5df4937135c1a9a1758b20855742bd038700c65.png"></a></a></p>
<p>Change any settings as necessary to support your planned MAAS deployment.</p>
<p><a href="#heading--set-up-ibm-z-enlistment"><h3 id="heading--set-up-ibm-z-enlistment">Set up your IBM Z virtual machine for enlistment</h3></a></p>
<p>To cause IBM Z KVM partition guests to enlist, it’s necessary to manually put in the BMC information for each guest. MAAS can then detect the guest, enlist it, and boot it as necessary.</p>
    </div>
  </body>
</html>