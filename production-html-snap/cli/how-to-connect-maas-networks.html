<!DOCTYPE html>
    <html>
    <body>
    <div class="container">
    <h1>How to connect MAAS networks</h1><!-- "How to connect MAAS networks" -->
<p>You can easily manage the basic networking elements of MAAS, including subnets, fabrics, VLANs, spaces, IP ranges, machine interfaces, and proxies.  This section shows how to access and edit these elements. </p>
<p>This article will help you learn:</p>
<ul style="margin-left:4px; list-style-type:disc;">
<li><a href="#heading--how-to-manage-MAAS-network-elements">How to manage MAAS network elements</a></li>
<li><a href="#heading--how-to-manage-machine-interfaces">How to manage machine interfaces</a></li>
<li><a href="#heading--how-to-manage-proxies">How to manage proxies</a></li>
<li><a href="#heading--how-to-set-up-ntp">How to set up Network Time Protocol (NTP)</a></li>
</ul>
<p><a href="#heading--how-to-manage-MAAS-network-elements"><h2 id="heading--how-to-manage-MAAS-network-elements">How to manage MAAS network elements</h2></a></p>
<p>This section will show you:</p>
<p><a href="#heading--how-to-enable-network-discovery"><h3 id="heading--how-to-enable-network-discovery">How to enable network discovery</h3></a></p>
<p><a href="#heading--how-to-toggle-subnet-management"><h3 id="heading--how-to-toggle-subnet-management">How to toggle subnet management</h3></a></p>
<p><a href="#heading--how-to-manage-static-routes"><h3 id="heading--how-to-manage-static-routes">How to manage static routes between subnets</h3></a></p>
<p><a href="#heading--how-to-set-up-a-bridge-with-maas"><h3 id="heading--how-to-set-up-a-bridge-with-maas">How to set up a bridge with MAAS</h3></a></p>
<p>At various times in your MAAS network, you may need to set up a bridge to connect between your machines and MAAS, as shown in this section.</p>
<p><strong>NOTE:</strong> 
It&rsquo;s essential to enforce usage of IP addresses to avoid domain name conflicts, should different controllers resolve the same domain name with different IP addresses. You should also avoid using 127.0.0.1 when running multiple controllers, as it would confuse MAAS.</p>
<p><a href="#heading--how-to-set-up-a-bridge-with-netplan"><h3 id="heading--how-to-set-up-a-bridge-with-netplan">How to set up a bridge with netplan</h3></a></p>
<p>You can also use netplan to configure a bridge:</p>
<ol>
<li>
<p>Open your netplan configuration file.  This should be in <code>/etc/netplan</code>.  It could be called <code>50-cloud-init.yaml</code>, <code>netplan.yaml</code>, or something else.  </p>
</li>
<li>
<p>Modify the file to add a bridge, using the following example as a guide:</p>
</li>
</ol>
<pre><code class="language-nohighlight">network:
    bridges:
        br0:
            addresses:
            - 10.0.0.101/24
            gateway4: 10.0.0.1
            interfaces:
            - enp1s0
            mac address: 52:54:00:39:9d:f9
            mtu: 1500
            name servers:
                addresses:
                - 10.0.0.2
                search:
                - maas
            parameters:
                forward-delay: 15
                stp: false
    Ethernet's:
        enp1s0:
            match:
                mac address: 52:54:00:39:9d:f9
            mtu: 1500
            set-name: enp1s0
        enp2s0:
            match:
                mac address: 52:54:00:df:87:ac
            mtu: 1500
            set-name: enp2s0
        enp3s0:
            match:
                mac address: 52:54:00:a7:ac:46
            mtu: 1500
            set-name: enp3s0
    version: 2
</code></pre>
<ol>
<li>Apply the new configuration with <code>netplan apply</code>.</li>
</ol>
<p><a href="#heading--how-to-manage-machine-interfaces"><h2 id="heading--how-to-manage-machine-interfaces">How to manage machine interfaces</h2></a></p>
<p>This section will explain the following procedures related to machine interfaces:</p>
<ul style="margin-left:4px; list-style-type:disc;">
<li><a href="#heading--how-to-edit-interfaces&quot;">How to edit machine interfaces</a></li>
<li><a href="#heading--bond-interfaces">How to create a bond interface</a></li>
<li><a href="#heading--bridge-interfaces">How to create a bridge interface</a></li>
<li><a href="#heading--delete-an-interface">How to delete an interface</a></li>
<li><a href="#heading--assign-a-network-interface-to-a-fabric">How to assign a network interface to a fabric</a></li>
<li><a href="#heading--interface-identifiers">How to discover interface identifiers</a></li>
<li><a href="#heading--create-a-vlan-interface">How to create a VLAN interface</a></li>
<li><a href="#heading--delete-a-vlan-interface">How to delete a VLAN interface</a></li>
</ul>
<p><a href="#heading--how-to-edit-interfaces"><h3 id="heading--how-to-edit-interfaces">How to edit machine interfaces</h3></a></p>
<p>See <a href="maas-concepts-and-terms-reference.html#heading--ip-ranges">Concepts and terms</a> for the definitions of reserved range types.</p>
<p><a href="#heading--bond-interfaces"><h3 id="heading--bond-interfaces">How to create a bond interface</h3></a></p>
<p><a href="#heading--bridge-interfaces"><h3 id="heading--bridge-interfaces">How to create a bridge interface</h3></a></p>
<p><a href="#heading--delete-an-interface"><h3 id="heading--delete-an-interface">How to delete an interface</h3></a></p>
<p>The &ldquo;delete&rdquo; command can be used to delete a bridge interface, a bond interface or a physical interface:</p>
<pre><code>maas $PROFILE interface delete $SYSTEM_ID $IFACE_ID
</code></pre>
<p>For example:</p>
<pre><code>maas admin interface delete 4efwb4 15
</code></pre>
<p>The following is output after the successful deletion of an interface:</p>
<pre><code>Success.
Machine-readable output follows:
</code></pre>
<p>Note that while the label is presented, there is no machine-readable output expected after the successful execution of the delete command.</p>
<p><a href="#heading--assign-a-network-interface-to-a-fabric"><h3 id="heading--assign-a-network-interface-to-a-fabric">How to assign a network interface to a fabric</h3></a></p>
<p><a href="#heading--interface-identifiers"><h3 id="heading--interface-identifiers">How to discover interface identifiers</h3></a></p>
<p><a href="#heading--create-a-vlan-interface"><h3 id="heading--create-a-vlan-interface">How to create a VLAN interface</h3></a></p>
<p><a href="#heading--delete-a-vlan-interface"><h3 id="heading--delete-a-vlan-interface">How to delete a VLAN interface</h3></a></p>
<p><a href="#heading--how-to-manage-proxies"><h2 id="heading--how-to-manage-proxies">How to manage proxies</h2></a></p>
<p>MAAS provides a way for its managed machines to use a proxy server when they need to access HTTP/HTTPS-based resources, such as the Ubuntu package archive.</p>
<p>There are three possible options:</p>
<ol>
<li>internal proxy (default)</li>
<li>external proxy</li>
<li>no proxy</li>
</ol>
<p>Configuring a proxy with MAAS consists of enabling/disabling one of the above three options and enabling/disabling proxying on a specific subnet. This article will help you learn:</p>
<ul style="margin-left:4px; list-style-type:disc;">
<li><a href="#heading--internal-proxy-maas-proxy">About the MAAS internal proxy</a></li>
<li><a href="#heading--configure-proxy">How to create an external proxy</a></li>
</ul>
<p><a href="#heading--internal-proxy-maas-proxy"><h3 id="heading--internal-proxy-maas-proxy">About the MAAS internal proxy</h3></a></p>
<p>MAAS provides an internal proxy server. Although it is set up to work well with APT/package requests, it is effectively an HTTP caching proxy server. If you configure the MAAS region controller as the default gateway for the machines it manages then the proxy will work transparently (on TCP port 3128). Otherwise, machines will need to access it on TCP port 8000.</p>
<p>By default, the proxy is available to all hosts residing in any subnet detected by MAAS, not just MAAS-managed machines. It is therefore recommended to disable access to those subnets that represent untrusted networks.</p>
<p><a href="#heading--configure-proxy"><h3 id="heading--configure-proxy">How to create an external proxy</h3></a></p>
<p><strong>NOTE</strong> that the proxy service will still be running.</p>
<p><a href="#heading--how-to-set-up-ntp"><h2 id="heading--how-to-set-up-ntp">How to set up Network Time Protocol (NTP)</h2></a></p>
<p>MAAS provides managed NTP services (with <a href="https://chrony.tuxfamily.org/">Chrony</a>) for all region and rack controllers. This arrangement allows MAAS to both keep its controllers synchronised, and keep deployed machines synchronised as well. You can configure NTP on the &lsquo;Network services&rsquo; tab of the &lsquo;Settings&rsquo; page.</p>
<p>The region controller configures the NTP service to keep its time synchronised from one or more external sources. By default, the MAAS region controller uses <code>ntp.ubuntu.com</code>. Rack controllers also configure the NTP service, synchronising their time with the region controllers.  Rack controllers also configure DHCP with the correct NTP information. Any machine on the network that obtains a DHCP lease from MA/snap/3AS will benefit from NTP support.</p>
<p><a href="#heading--setting-ntp-server"><h2 id="heading--setting-ntp-server">Setting an external NTP server</h2></a></p>
<p>External sites, such as an existing NTP infrastructure, can be used directly as a time source for both rack controllers and machines.</p>
    </div>
    </body>
    </html>
    