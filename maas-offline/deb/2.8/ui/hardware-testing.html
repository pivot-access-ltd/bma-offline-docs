<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="css/stylesheet.css" />
    <style>
      #selector a:link{color:black;}
      #selector a:visited{color:black;}
      #selector a:active{color:black;}
      #selector a:hover{color:blue;}
      #sidebar a:link{color:black;}
      #sidebar a:visited{color:black;}
      #sidebar a:active{color:black;}
      #sidebar a:hover{color:blue;}
      ul {margin-left:0;list-style-type:none;}
      li {margin: 4px 0;}
    </style>
  </head>
  <body>
    <div id="selector" style="top:0; position:fixed; float:right; background-color:#d9d9d9; width:100%;border-bottom:1px solid black;">
      &nbsp;&nbsp;<strong>Offline docs</strong>
      <a href="https://maas.io/docs">(switch to live docs)</a>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <strong>
	  UI-only
      </strong>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	<a href="../cli/hardware-testing.html" style="background-color:white;border-top:1px solid black; border-left:1px solid black; border-right:1px solid black; border-bottom:5px solid white;">
	  CLI-only
	</a>
    </div>
    <div id="sidebar" style="float:left; width:25%;margin-top:40px; margin-left:20px">
      <strong>
	<a href="../maas-documentation-25.html">
	  Introduction
	</a>
      </strong>
      <ul>
	<li>
	  <a href="about-maas.html">
	    About MAAS
	  </a>
	</li>
	<li>
	  <a href="give-me-an-example-of-maas.html">
	    &ldquo;Give me an example&rdquo;
	  </a>
	</li>
	<li>
	  <a href="whats-new-in-maas.html">
	    What&rsquo;s new in 2.8
	  </a>
	</li>
	<li>
	  <a href="maas-requirements.html">
	    Requirements
	  </a>
	</li>
	<li>
	  <a href="maas-installation.html">
	    Installation
	  </a>
	</li>
	<li>
	  <a href="configuration-journey.html">
	    Configuration journey
	  </a>
	</li>
      <strong>
	<a href="controllers.html">
	  Controllers
	</a>
      </strong>
      <ul>
	<li>
	  <a href="maas-communication.html">
	    Communication
	  </a>
	</li>
	<li>
	  <a href="rack-controllers.html">
	    Rack controllers
	  </a>
	</li>
	<li>
	  <a href="region-controllers.html">
	    Region controllers
	  </a>
	</li>
	<li>
	  <a href="high-availability.html">
	    High availability
	  </a>
	</li>
      </ul>
      <strong>
	<a href="machines.html">
	  Machines
	</a>
      </strong>
      <ul>
	<li>
	  <a href="add-machines.html">
	    Add machines
	  </a>
	</li>
	<li>
	  <a href="power-management.html">
	    Power management
	  </a>
	</li>
	<li>
	  <a href="commission-machines.html">
	    Commission machines
	  </a>
	</li>
	<li>Testing
	</li>
	<li>
	  <a href="hardware-testing.html">
	    Hardware testing
	  </a>
	</li>
	<li>
	  <a href="network-testing.html">
	    Network testing
	  </a>
	</li>
	<li>
	  <a href="commissioning-and-hardware-testing-scripts.html">
	    Commissioning and hardware testing scripts
	  </a>
	</li>
	<li>
	  <a href="deploy-machines.html">
	    Deploy machines
	  </a>
	</li>
	<li>
	  <a href="maas-tags.html">
	    Tags
	  </a>
	</li>
	<li>
	  <a href="custom-machine-setup.html">
	    Custom machine setup
	  </a>
	</li>
	<li>
	  <a href="kernel-boot-options.html">
	    Kernel boot options
	  </a>
	</li>
	<li>
	  <a href="resource-pools.html">
	    Resource pools
	  </a>
	</li>
	<li>
	  <a href="storage.html">
	    Storage
	  </a>
	</li>
	<li>
	  <a href="vmware-vmfs-datastores.html">
	    VMware VMFS datastores
	  </a>
	</li>
	<li>
	  <a href="ubuntu-kernels.html">
	    Ubuntu kernels
	  </a>
	</li>
      </ul>
      <strong>
	<a href="images.html">
	  Images
	</a>
      </strong>
      <ul>
	<li>
	  <a href="select-and-import-images.html">
	    Select and import images
	  </a>
	</li>
	<li>
	  <a href="local-image-mirror.html">
	    Local image mirror
	  </a>
	</li>
	<li>
	  <a href="vmware-images.html">
	    VMWare images
	  </a>
	</li>
      </ul>
      <strong>
	<a href="networking.html">
	  Networking
	</a>
      </strong>
      <ul>
	<li>
	  <a href="subnet-management.html">
	    Subnet management
	  </a>
	</li>
	<li>
	  <a href="managing-dhcp.html">
	    DHCP
	  </a>
	</li>
	<li>
	  <a href="ip-ranges.html">
	    IP ranges
	  </a>
	</li>
	<li>
	  <a href="proxy.html">
	    Proxy
	  </a>
	</li>
	<li>
	  <a href="ntp-services.html">
	    NTP
	  </a>
	</li>
	<li>
	  <a href="network-discovery.html">
	    Network discovery
	  </a>
	</li>
	<li>
	  <a href="ipv6-addressing.html">
	    IPv6
	  </a>
	</li>
	<li>
	  <a href="configuring-tls-encryption.html">
	    SSL
	  </a>
	</li>
	<li>
	  <a href="managing-stp.html">
	    STP
	  </a>
	</li>
	<li>
	  <a href="availability-zones.html">
	    Availability zones (AZs)
	  </a>
	</li>
      </ul>
      <strong>
	<a href="vm-hosting.html">
	  VM hosting
	</a>
      </strong>
      <ul>
	<li>
	  <a href="vm-host-networking.html">
	    VM host networking
	  </a>
	</li>
	<li>
	  <a href="adding-a-vm-host.html">
	    Add a VM host
	  </a>
	</li>
	<li>
	  <a href="vm-host-storage-pools.html">
	    VM host storage pools
	  </a>
	</li>
	<li>
	  <a href="creating-and-deleting-vms.html">
	    Creating and deleting VMs
	  </a>
	</li>
      </ul>
      <strong>Operations
      </strong>
      <ul>
	<li>
	  <a href="prometheus-metrics.html">
	    Prometheus metrics
	  </a>
	</li>
	<li>
	  <a href="backup.html">
	    Backup
	  </a>
	</li>
	<li>
	  <a href="hardening-your-maas-installation.html">
	    MAAS security
	  </a>
	</li>
	<li>
	  <a href="maas-logging.html">
	    Logging
	  </a>
	</li>
	<li>
	  <a href="commissioning-logs.html">
	    Commissioning logs
	  </a>
	</li>
	<li>
	  <a href="user-accounts.html">
	    User accounts
	  </a>
	</li>
	<li>
	  <a href="interactive-search.html">
	    Interactive search
	  </a>
	</li>
      </ul>
      <strong>
	<a href="concepts-and-terms.html">
	  Concepts &amp; terms
	</a>
      </strong>
      <ul>
	<li>
	  <a href="concepts-and-terms.html#heading--network-tutorial">
	    Brief network tutorial
	  </a>
	</li>
      </ul>
      <strong>
	<a href="maas-cli.html">
	  CLI
	</a>
      </strong>
      <ul>
	<li>
	  <a href="common-cli-tasks.html">
	    The CLI cookbook
	  </a>
	</li>
	<li>
	  <a href="common-cli-tasks.html">
	    Common tasks
	  </a>
	</li>
	<li>
	  <a href="audit-event-logs.html">
	    Audit event logs
	  </a>
	</li>
	<li>
	  <a href="cli-kernel-management.html">
	    Kernel management
	  </a>
	</li>
	<li>
	  <a href="cli-image-management.html">
	    Image management
	  </a>
	</li>
	<li>
	  <a href="cli-interface-management.html">
	    Interface management
	  </a>
	</li>
	<li>
	  <a href="cli-advanced-tasks.html">
	    Advanced tasks
	  </a>
	</li>
	<li>
	  <a href="cli-composable-hardware.html">
	    Composable hardware
	  </a>
	</li>
	<li>
	  <a href="python-api-client.html">
	    API client
	  </a>
	</li>
      </ul>
      <strong>
	<a href="https://maas.io/docs/api">
	  API documentation
	</a>
      </strong>
      <ul>
	<li>
	  <a href="api-authentication.html">
	    API authentication
	  </a>
	</li>
      </ul>
      <strong>
	<a href="troubleshooting.html">
	  Troubleshoot
	</a>
      </strong>
      <ul>
	<li>
	  <a href="getting-help.html">
	    Getting help
	  </a>
	</li>
	<li>
	  <a href="tips-tricks-and-traps.html">
	    Tips, tricks, and traps
	  </a>
	</li>
	<li>
	  <a href="https://old-docs.maas.io/2.5/en/">
	    MAAS 2.5 (+ earlier) doc
	  </a>
	</li>
      </ul>
      <strong>
	<a href="whats-new-in-maas.html">
	  Release notes
	</a>
      </strong>
      <p/>
      <strong>
	<a href="writing-guide.html">
	  Help improve these docs
	</a>
      </strong>
    </div>
    <div class="container" style="float:right; width:65%; margin-top:40px; margin-right:30px">
      <h1>Hardware testing</h1><p>If you wish, you can tell MAAS to test machine hardware using well-known Linux utilities.  MAAS can test machines that have  a status of <strong>Ready</strong>, <strong>Broken</strong>, or <strong>Deployed</strong>.  You can include testing as part of the commissioning process. When you choose the &lsquo;Commission&rsquo; action, MAAS will display the dialog described below.  Be aware, though, that if the hardware tests fail, the machine will become unavailable for Deployment.</p>
<p>[note]
The majority of testing scripts only work with machines that are backed by physical hardware (e.g. they may be incompatible with VM-based machines).
[/note]</p>
<!-- snap-2-7-cli snap-2-8-cli snap-2-9-cli deb-2-7-cli deb-2-8-cli deb-2-9-cli
With MAAS, you can easily write, upload and execute your hardware testing scripts and see the results.

#### Quick questions you may have:

* [How do I upload and manage test scripts?](cli-commissioning-and-hardware-testing-scripts-832.html#heading--script-management)
* [How do I use tags to help with test scripts?](cli-commissioning-and-hardware-testing-scripts-832.html#heading--tags)
* [How do I view test results?](cli-commissioning-and-hardware-testing-scripts-832.html#heading--results)
* [What metadata fields are available to me for test scripts?](commissioning-and-hardware-testing-scripts-833.html#heading--metadata-fields)

<h2 id="heading--script-management">Script management</h2>

To upload a hardware testing script to MAAS, enter the following:


<pre><code class="bash">maas $PROFILE node-scripts create name=$SCRIPT_NAME name&gt; \
 script=$PATH_TO_SCRIPT type=testing
</code></pre>


Changing the type to commissioning adds the test script to the commissioning process.

You can list all uploaded scripts with the following command:


<pre><code class="bash">maas $PROFILE node-scripts read type=testing filters=$TAG
</code></pre>


The optional filters argument lets you search for tags assigned to a script, such as using `TAG=cpu` with the above example.

A [script's metadata](commissioning-and-hardware-testing-scripts-833.html#hardware-test-script-sample), and even the script itself, can be updated from the command line:


<pre><code class="bash">maas $PROFILE node-script update \
 $SCRIPT_NAME script=$PATH_TO_SCRIPT comment=$COMMENT
</code></pre>


The JSON formatted output to the above command will include 'history' dictionary entries, detailing script modification times and associated comments:


<pre><code class="json">&quot;history&quot;: [
    {
        &quot;id&quot;: 40,
        &quot;created&quot;: &quot;Tue, 12 Sep 2017 12:12:08 -0000&quot;,
        &quot;comment&quot;: &quot;Updated version&quot;
    },
    {
        &quot;id&quot;: 34,
        &quot;created&quot;: &quot;Fri, 08 Sep 2017 17:07:46 -0000&quot;,
        &quot;comment&quot;: null
    }
]
</code></pre>


MAAS keeps a history of all uploaded script versions, allowing you to easily revert to a previous version using the `id` of the version you wish to revert to:


<pre><code class="bash">maas $PROFILE node-script revert $SCRIPT_NAME to=$VERSION_ID
</code></pre>


[note type="negative" status="Warning"]
The history for later modifications will be lost when reverting to an earlier version of the script.
[/note]

To download a script, enter the following:


<pre><code class="bash">maas $PROFILE node-script download $SCRIPT_NAME &gt; $LOCAL_FILENAME
</code></pre>


To delete a script, use `delete`:


<pre><code class="bash">maas $PROFILE node-script delete $SCRIPT_NAME
</code></pre>


<h2 id="heading--tags">Tags</h2>

As with general [tag management](cli-tag-management-801.html), tags make scripts easier to manage; grouping scripts together for commissioning and testing, for example:


<pre><code class="bash">maas $PROFILE node-script add-tag $SCRIPT_NAME tag=$TAG
maas $PROFILE node-script remove-tag $SCRIPT_NAME tag=$TAG
</code></pre>


MAAS runs all commissioning scripts by default. However, you can select which custom scripts to run during commissioning by name or tag:


<pre><code class="bash">maas $PROFILE machine commission \
 commissioning_scripts=$SCRIPT_NAME,$SCRIPT_TAG
</code></pre>


You can also select which testing scripts to run by name or tag:


<pre><code class="bash">maas $PROFILE machine commission \
 testing_scripts=$SCRIPT_NAME,$SCRIPT_TAG
</code></pre>


Any testing scripts tagged with commissioning will also run during commissioning.

<h2 id="heading--results">Results</h2>

The command line allows you to not only view the current script's progress but also retrieve the verbatim output from any previous runs too.

If you only want to see the latest or currently-running result, you can use `current-commissioning`, `current-testing`, or `current-installation` instead of an id:


<pre><code class="bash">maas $PROFILE node-script-result read $SYSTEM_ID $RESULTS
</code></pre>


You can also limit which results are returned by type (commissioning, testing, or installation), script name, or script run:


<pre><code class="bash">maas $PROFILE node-script-results read \
 $SYSTEM_ID type=$SCRIPT_TYPE filters=$SCRIPT_NAME,$TAGS
</code></pre>


You can also suppress failed results, which is useful if you want to ignore a known failure:


<pre><code class="bash">maas $PROFILE node-script-results update \
 $SYSTEM_ID type=$SCRIPT_TYPE filters=$SCRIPT_NAME,$TAGS suppressed=$SUPPRESSED
</code></pre>


where `$SUPPRESSED` is either `True` or `False`. The JSON formatted output to the above command will include 'results' dictionary with an entry for `suppressed`:


<pre><code class="json">&quot;results&quot;: [
    {
        &quot;id&quot;: 21,
        &quot;created&quot;: &quot;Tue, 02 Apr 2019 17:00:36 -0000&quot;,
        &quot;updated&quot;: &quot;Tue, 02 Apr 2019 20:56:41 -0000&quot;,
        &quot;name&quot;: &quot;smartctl-validate&quot;,
        &quot;status&quot;: 5,
        &quot;status_name&quot;: &quot;Aborted&quot;,
        &quot;exit_status&quot;: null,
        &quot;started&quot;: &quot;Tue, 02 Apr 2019 20:56:41 -0000&quot;,
        &quot;ended&quot;: &quot;Tue, 02 Apr 2019 20:56:41 -0000&quot;,
        &quot;runtime&quot;: &quot;0:00:00&quot;,
        &quot;starttime&quot;: 1554238601.765214,
        &quot;endtime&quot;: 1554238601.765214,
        &quot;estimated_runtime&quot;: &quot;0:00:00&quot;,
        &quot;parameters&quot;: {
            &quot;storage&quot;: {
                &quot;argument_format&quot;: &quot;{path}&quot;,
                &quot;type&quot;: &quot;storage&quot;,
                &quot;value&quot;: {
                    &quot;id_path&quot;: &quot;/dev/vda&quot;,
                    &quot;model&quot;: &quot;&quot;,
                    &quot;name&quot;: &quot;sda&quot;,
                    &quot;physical_blockdevice_id&quot;: 1,
                    &quot;serial&quot;: &quot;&quot;
                }
            }
        },
        &quot;script_id&quot;: 1,
        &quot;script_revision_id&quot;: null,
        &quot;suppressed&quot;: true
    }
]
</code></pre>


Finally, results can be downloaded, either to stdout, stderr, as combined output or as a tar.xz:


<pre><code class="bash">maas $PROFILE node-script-result download $SYSTEM_ID $RUN_ID output=all \
 filetype=tar.xz &gt; $LOCAL_FILENAME
</code></pre>


[note]
**$RUN_ID** is labelled `id` in the verbose result output.
[/note]
snap-2-7-cli snap-2-8-cli snap-2-9-cli deb-2-7-cli deb-2-8-cli deb-2-9-cli -->

<h4>Quick questions you may have:</h4>
<ul>
<li><a href="#heading--apply-a-hardware-test">How do I apply a hardware test?</a></li>
<li><a href="#heading--included-scripts">What scripts are available for testing?</a></li>
</ul>
<h2 id="heading--apply-a-hardware-test">Apply a hardware test</h2>

<p>To launch a test, select the target machine from the &lsquo;Machines&rsquo; page and use the &lsquo;Take action&rsquo; drop-down menu to select &lsquo;Test hardware&rsquo;. When ready, hit the &lsquo;Test machine&rsquo; button. Here, a test is applied to a deployed machine:</p>
<p><a href="images/8e876889-nodes-hw-testing__2.4_deployed.png" target = "_blank"><img src="images/8e876889-nodes-hw-testing__2.4_deployed.png"></a></a></p>
<p>There is the option of not powering off the machine and to allow SSH access.</p>
<p>A default test will be selected (<code>smartctl-validate</code>, a hard drive test) but you can choose others by clicking the &lsquo;Select scripts&rsquo; label. Doing so will reveal the following choices:</p>
<p><a href="images/ccfefe25-nodes-hw-testing__2.4_deployed-choices.png" target = "_blank"><img src="images/ccfefe25-nodes-hw-testing__2.4_deployed-choices.png"></a></a></p>
<h2 id="heading--included-scripts">Scripts available for testing</h2>

<p>The following hardware testing scripts can be selected from the web UI:</p>
<table style="width:17%;">
<colgroup>
<col width="5%" />
<col width="5%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Name</th>
<th align="center">Category Tags</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>smartctl-short</strong></td>
<td align="center">storage</td>
<td align="center">Run the short SMART self-test and validate SMART health on all drives in parallel</td>
</tr>
<tr class="even">
<td align="center"><strong>smartctl-long</strong></td>
<td align="center">storage</td>
<td align="center">Run the long SMART self-test and validate SMART health on all drives in parallel</td>
</tr>
<tr class="odd">
<td align="center"><strong>smartctl-conveyance</strong></td>
<td align="center">storage</td>
<td align="center">Run the conveyance SMART self-test and validate SMART health on all drives in parallel</td>
</tr>
<tr class="even">
<td align="center"><strong>memtester</strong></td>
<td align="center">memory</td>
<td align="center">Run memtester against all available userspace memory.</td>
</tr>
<tr class="odd">
<td align="center"><strong>internet-connectivity</strong></td>
<td align="center">network, internet, node</td>
<td align="center">Check if the system has access to the internet.</td>
</tr>
<tr class="even">
<td align="center"><strong>stress-ng-cpu-long</strong></td>
<td align="center">cpu</td>
<td align="center">Run stress-ng memory tests for 12 hours.</td>
</tr>
<tr class="odd">
<td align="center"><strong>stress-ng-cpu-short</strong></td>
<td align="center">cpu</td>
<td align="center">Run stress-ng memory tests for 5 minutes.</td>
</tr>
<tr class="even">
<td align="center"><strong>stress-ng-memory-long</strong></td>
<td align="center">memory</td>
<td align="center">Run stress-ng memory tests for 12 hours.</td>
</tr>
<tr class="odd">
<td align="center"><strong>stress-ng-memory-short</strong></td>
<td align="center">memory</td>
<td align="center">Run stress-ng memory tests for 5 minutes.</td>
</tr>
<tr class="even">
<td align="center"><strong>ntp</strong></td>
<td align="center">network, ntp, node</td>
<td align="center">Run ntp clock set to verify NTP connectivity.</td>
</tr>
<tr class="odd">
<td align="center"><strong>badblocks</strong></td>
<td align="center">storage</td>
<td align="center">Run badblocks on disk in read-only mode.</td>
</tr>
<tr class="even">
<td align="center"><strong>badblocks-destructive</strong></td>
<td align="center">destructive, storage</td>
<td align="center">Run badblocks on a disk in read/write destructive mode.</td>
</tr>
<tr class="odd">
<td align="center"><strong>7z</strong></td>
<td align="center">cpu</td>
<td align="center">Run <em>7zip</em> CPU benchmarking.</td>
</tr>
<tr class="even">
<td align="center"><strong>fio</strong></td>
<td align="center">storage, destructive</td>
<td align="center">Run Fio benchmarking against selected storage devices.</td>
</tr>
</tbody>
</table>

<p>After either commissioning, testing, or installation has started, MAAS reports in real-time which script is running.</p>
<p>You can access the verbatim output from any test by selecting a machine, selecting the &lsquo;Hardware tests&rsquo; page and clicking on the &lsquo;Log view&rsquo; link in the &lsquo;Results&rsquo; column for the specific test.</p>
<!-- deb-2-7-cli
See [Commissioning and Hardware Testing Scripts](commissioning-and-hardware-testing-scripts-2484.html) for more details on how these scripts work and how you can write your own.
 deb-2-7-cli -->

<!-- deb-2-7-ui
See [Commissioning and Hardware Testing Scripts](commissioning-and-hardware-testing-scripts-2485.html) for more details on how these scripts work and how you can write your own.
 deb-2-7-ui -->

<!-- deb-2-8-cli
See [Commissioning and Hardware Testing Scripts](commissioning-and-hardware-testing-scripts-2486.html) for more details on how these scripts work and how you can write your own.
 deb-2-8-cli -->

<p>See <a href="commissioning-and-hardware-testing-scripts-2487.html">Commissioning and Hardware Testing Scripts</a> for more details on how these scripts work and how you can write your own.</p>
<!-- deb-2-9-cli
See [Commissioning and Hardware Testing Scripts](commissioning-and-hardware-testing-scripts-2488.html) for more details on how these scripts work and how you can write your own.
 deb-2-9-cli -->

<!-- deb-2-9-ui
See [Commissioning and Hardware Testing Scripts](commissioning-and-hardware-testing-scripts-2489.html) for more details on how these scripts work and how you can write your own.
 deb-2-9-ui -->

<!-- snap-2-7-cli
See [Commissioning and Hardware Testing Scripts](commissioning-and-hardware-testing-scripts-2478.html) for more details on how these scripts work and how you can write your own.
 snap-2-7-cli -->

<!-- snap-2-7-ui
See [Commissioning and Hardware Testing Scripts](commissioning-and-hardware-testing-scripts-2479.html) for more details on how these scripts work and how you can write your own.
 snap-2-7-ui -->

<!-- snap-2-8-cli
See [Commissioning and Hardware Testing Scripts](commissioning-and-hardware-testing-scripts-2480.html) for more details on how these scripts work and how you can write your own.
 snap-2-8-cli -->

<!-- snap-2-8-ui
See [Commissioning and Hardware Testing Scripts](commissioning-and-hardware-testing-scripts-2481.html) for more details on how these scripts work and how you can write your own.
 snap-2-8-ui -->

<!-- snap-2-9-cli
See [Commissioning and Hardware Testing Scripts](commissioning-and-hardware-testing-scripts-2482.html) for more details on how these scripts work and how you can write your own.
 snap-2-9-cli -->

<!-- snap-2-9-ui
See [Commissioning and Hardware Testing Scripts](commissioning-and-hardware-testing-scripts-2483.html) for more details on how these scripts work and how you can write your own.
 snap-2-9-ui -->
    </div>
  </body>
</html>