<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="css/stylesheet.css" />
    <style>
      #selector a:link{color:black;}
      #selector a:visited{color:black;}
      #selector a:active{color:black;}
      #selector a:hover{color:blue;}
      #sidebar a:link{color:black;}
      #sidebar a:visited{color:black;}
      #sidebar a:active{color:black;}
      #sidebar a:hover{color:blue;}
      ul {margin-left:0;list-style-type:none;}
      li {margin: 4px 0;}
    </style>
  </head>
  <body>
    <div id="selector" style="top:0; position:fixed; float:right; background-color:#d9d9d9; width:100%;border-bottom:1px solid black;">
      &nbsp;&nbsp;<strong>Offline docs</strong>
      <a href="https://maas.io/docs">(switch to live docs)</a>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <strong>
	<a href="../maas-vanilla/cli-tag-management-801.html" style="background-color:white;border-top:1px solid black; border-left:1px solid black; border-right:1px solid black; border-bottom:5px solid white;">
	  &nbsp;Full&nbsp;
	</a>
      </strong>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <a href="../maas-ui-only/cli-tag-management-801.html" style="border-top:1px solid black; border-left:1px solid black; border-right:1px solid black;">
	UI-only
      </a>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <a href="../maas-cli-only/cli-tag-management-801.html" style="border-top:1px solid black; border-left:1px solid black; border-right:1px solid black;">
	CLI-only
      </a>
    </div>
    <div id="sidebar" style="float:left; width:25%;margin-top:40px; margin-left:20px">
      <strong>
	<a href="maas-documentation-25.html">
	  Introduction
	</a>
      </strong>
      <ul>
	<li>
	  <a href="about-maas-840.html">
	    About MAAS
	  </a>
	</li>
	<li>
	  <a href="give-me-an-example-of-maas-1314.html">
	    &ldquo;Give me an example&rdquo;
	  </a>
	</li>
	<li>
	  <a href="explore-maas-787.html">
	    Explore MAAS
	  </a>
	</li>
	<li>
	  <a href="whats-new-in-maas-2-8-1655.html">
	    What&rsquo;s new in 2.8
	  </a>
	</li>
	<li>
	  <a href="https://maas.io/install">
	    Quick start
	  </a>
	</li>
      </ul>
      <strong>Installing MAAS
      </strong>
      <ul>
	<li>
	  <a href="maas-requirements-789.html">
	    Requirements
	  </a>
	</li>
	<li>
	  <a href="maas-installation-from-a-snap-773.html">
	    Installation
	  </a>
	</li>
	<li>
	  <a href="configuration-journey-781.html">
	    Configuration journey
	  </a>
	</li>
	<li>
	  <a href="installation-and-configuration-checklist-750.html">
	    Setup checklist
	  </a>
	</li>
      </ul>
      <strong>
	<a href="introduction-to-controllers-786.html">
	  Controllers
	</a>
      </strong>
      <ul>
	<li>
	  <a href="maas-communication-783.html">
	    Communication
	  </a>
	</li>
	<li>
	  <a href="rack-controllers-771.html">
	    Rack controllers
	  </a>
	</li>
	<li>
	  <a href="region-controllers-772.html">
	    Region controllers
	  </a>
	</li>
	<li>
	  <a href="high-availability-804.html">
	    High availability
	  </a>
	</li>
      </ul>
      <strong>
	<a href="introduction-to-machines-829.html">
	  Machines
	</a>
      </strong>
      <ul>
	<li>
	  <a href="add-machines-821.html">
	    Add machines
	  </a>
	</li>
	<li>
	  <a href="power-management-830.html">
	    Power management
	  </a>
	</li>
	<li>
	  <a href="commission-machines-822.html">
	    Commission machines
	  </a>
	</li>
	<li>Testing
	</li>
	<li>
	  <a href="hardware-testing-826.html">
	    Hardware testing
	  </a>
	</li>
	<li>
	  <a href="network-testing-1267.html">
	    Network testing
	  </a>
	</li>
	<li>
	  <a href="commissioning-and-hardware-testing-scripts-833.html">
	    Commissioning and hardware testing scripts
	  </a>
	</li>
	<li>
	  <a href="deploy-machines-825.html">
	    Deploy machines
	  </a>
	</li>
	<li>
	  <a href="maas-tags-834.html">
	    Tags
	  </a>
	</li>
	<li>
	  <a href="custom-machine-setup-824.html">
	    Custom machine setup
	  </a>
	</li>
	<li>
	  <a href="kernel-boot-options-827.html">
	    Kernel boot options
	  </a>
	</li>
	<li>
	  <a href="resource-pools-831.html">
	    Resource pools
	  </a>
	</li>
	<li>
	  <a href="storage-775.html">
	    Storage
	  </a>
	</li>
	<li>
	  <a href="vmware-vmfs-datastores-780.html">
	    VMware VMFS datastores
	  </a>
	</li>
	<li>
	  <a href="ubuntu-kernels-828.html">
	    Ubuntu kernels
	  </a>
	</li>
      </ul>
      <strong>
	<a href="images-754.html">
	  Images
	</a>
      </strong>
      <ul>
	<li>
	  <a href="select-and-import-images-751.html">
	    Select and import images
	  </a>
	</li>
	<li>
	  <a href="local-image-mirror-752.html">
	    Local image mirror
	  </a>
	</li>
	<li>
	  <a href="vmware-images-753.html">
	    VMWare images
	  </a>
	</li>
      </ul>
      <strong>
	<a href="networking-768.html">
	  Networking
	</a>
      </strong>
      <ul>
	<li>
	  <a href="subnet-management-766.html">
	    Subnet management
	  </a>
	</li>
	<li>
	  <a href="managing-dhcp-759.html">
	    DHCP
	  </a>
	</li>
	<li>
	  <a href="ip-ranges-760.html">
	    IP ranges
	  </a>
	</li>
	<li>
	  <a href="proxy-763.html">
	    Proxy
	  </a>
	</li>
	<li>
	  <a href="ntp-services-762.html">
	    NTP
	  </a>
	</li>
	<li>
	  <a href="network-discovery-758.html">
	    Network discovery
	  </a>
	</li>
	<li>
	  <a href="ipv6-addressing-761.html">
	    IPv6
	  </a>
	</li>
	<li>
	  <a href="configuring-tls-encryption-764.html">
	    SSL
	  </a>
	</li>
	<li>
	  <a href="managing-stp-765.html">
	    STP
	  </a>
	</li>
	<li>
	  <a href="availability-zones-820.html">
	    Availability zones (AZs)
	  </a>
	</li>
      </ul>
      <strong>
	<a href="introduction-to-vm-hosting-1524.html">
	  VM hosting
	</a>
      </strong>
      <ul>
	<li>
	  <a href="vm-host-networking-1526.html">
	    VM host networking
	  </a>
	</li>
	<li>
	  <a href="adding-a-vm-host-1549.html">
	    Add a VM host
	  </a>
	</li>
	<li>
	  <a href="vm-host-storage-pools-1525.html">
	    VM host storage pools
	  </a>
	</li>
	<li>
	  <a href="creating-and-deleting-vms-806.html">
	    Creating and deleting VMs
	  </a>
	</li>
      </ul>
      <strong>Operations
      </strong>
      <ul>
	<li>
	  <a href="prometheus-metrics-813.html">
	    Prometheus metrics
	  </a>
	</li>
	<li>
	  <a href="backup-792.html">
	    Backup
	  </a>
	</li>
	<li>
	  <a href="hardening-your-maas-installation-1381.html">
	    MAAS security
	  </a>
	</li>
	<li>
	  <a href="maas-logging-1468.html">
	    Logging
	  </a>
	</li>
	<li>
	  <a href="commissioning-logs-1478.html">
	    Commissioning logs
	  </a>
	</li>
	<li>
	  <a href="user-accounts-790.html">
	    User accounts
	  </a>
	</li>
	<li>
	  <a href="interactive-search-819.html">
	    Interactive search
	  </a>
	</li>
      </ul>
      <strong>
	<a href="concepts-and-terms-785.html">
	  Concepts &amp; terms
	</a>
      </strong>
      <ul>
	<li>
	  <a href="concepts-and-terms-785.html#heading--network-tutorial">
	    Brief network tutorial
	  </a>
	</li>
      </ul>
      <strong>
	<a href="maas-cli-802.html">
	  CLI
	</a>
      </strong>
      <ul>
	<li>
	  <a href="common-cli-tasks-794.html">
	    Common tasks
	  </a>
	</li>
	<li>
	  <a href="audit-event-logs-791.html">
	    Audit event logs
	  </a>
	</li>
	<li>
	  <a href="cli-kernel-management-799.html">
	    Kernel management
	  </a>
	</li>
	<li>
	  <a href="cli-image-management-797.html">
	    Image management
	  </a>
	</li>
	<li>
	  <a href="cli-interface-management-798.html">
	    Interface management
	  </a>
	</li>
	<li>
	  <a href="cli-tag-management-801.html">
	    Tag management
	  </a>
	</li>
	<li>
	  <a href="cli-resource-pool-management-800.html">
	    Resource pool management
	  </a>
	</li>
	<li>
	  <a href="cli-dhcp-snippet-management-796.html">
	    DHCP snippet management
	  </a>
	</li>
	<li>
	  <a href="cli-commissioning-and-hardware-testing-scripts-832.html">
	    Commissioning and hardware testing scripts
	  </a>
	</li>
	<li>
	  <a href="cli-advanced-tasks-793.html">
	    Advanced tasks
	  </a>
	</li>
	<li>
	  <a href="cli-composable-hardware-795.html">
	    Composable hardware
	  </a>
	</li>
	<li>
	  <a href="python-api-client-810.html">
	    API client
	  </a>
	</li>
      </ul>
      <strong>
	<a href="https://maas.io/docs/api">
	  API documentation
	</a>
      </strong>
      <ul>
	<li>
	  <a href="api-authentication-742.html">
	    API authentication
	  </a>
	</li>
      </ul>
      <strong>
	<a href="troubleshooting-837.html">
	  Troubleshoot
	</a>
      </strong>
      <ul>
	<li>
	  <a href="getting-help-838.html">
	    Getting help
	  </a>
	</li>
	<li>
	  <a href="tips-tricks-and-traps-1506.html">
	    Tips, tricks, and traps
	  </a>
	</li>
	<li>
	  <a href="https://old-docs.maas.io/2.5/en/">
	    MAAS 2.5 (+ earlier) doc
	  </a>
	</li>
      </ul>
      <strong>
	<a href="whats-new-in-maas-2-8-1655.html">
	  Release notes
	</a>
      </strong>
      <p/>
      <strong>
	<a href="writing-guide-747.html">
	  Help improve these docs
	</a>
      </strong>
    </div>
    <div class="container" style="float:right; width:65%; margin-top:40px; margin-right:30px">
      <h1>CLI tag management</h1><p>This document lists tag management tasks you can perform with the MAAS CLI.</p>
<h4>Quick questions you may have:</h4>
<ul>
<li><a href="maas-cli-802.html">How do I get started with the MAAS CLI?</a></li>
<li><a href="maas-tags-834.html">What are tags and how do I use them?</a></li>
<li><a href="cli-tag-management-801.html#heading--rudimentary-tag-creation">How do I effect rudimentary tag creation?</a></li>
<li><a href="cli-tag-management-801.html#heading--tag-creation-and-auto-assignment">How do I do tag creation and auto-assignment?</a></li>
<li><a href="cli-tag-management-801.html#heading--delete-a-tag">How do I delete a tag?</a></li>
<li><a href="cli-tag-management-801.html#heading--list-all-tags">How do I list all tags?</a></li>
<li><a href="#heading--list-nodesmachines-labelled-with-a-tag">How do I list nodes/machines labelled with a tag?</a></li>
<li><a href="cli-tag-management-801.html#heading--juju-integration">How do I handle Juju integration?</a></li>
<li><a href="cli-tag-management-801.html#heading--manual-tag-assignment">How do I effect manual tag assignment?</a></li>
<li><a href="cli-tag-management-801.html#heading--hybrid-tag-assignment">How do I effect hybrid tag assignment?</a></li>
</ul>
<h2 id="heading--rudimentary-tag-creation">Rudimentary tag creation</h2>

<pre><code class="bash">maas $PROFILE tags create name=$TAG_NAME
</code></pre>

<h2 id="heading--tag-creation-and-auto-assignment">Tag creation and auto-assignment</h2>

<p>When you supply a <a href="maas-tags-834.html#heading--tag-definitions">definition</a> during a tag&rsquo;s creation, MAAS automatically applies the tag o all the nodes that satisfy the definition:</p>
<pre><code class="bash">maas $PROFILE tags create name=$TAG_NAME \
    comment='$TAG_COMMENT' definition='$TAG_DEFINITION'
</code></pre>

<p>For example,</p>
<pre><code class="bash">maas $PROFILE tags create name='gpu' \
    comment='GPU with clock speed &gt;1GHz for running CUDA type operations.' \
    definition='//node[@id=&quot;display&quot;]/'clock units=&quot;Hz&quot;' &gt; 1000000000'
</code></pre>

<p>We recommend that each tag have a short name and a comment that adequately describes it. You should make sure to create both of these because they will help you identify and use the tag later.</p>
<h2 id="heading--delete-a-tag">Delete a tag</h2>

<pre><code class="bash">maas $PROFILE tag delete $TAG_NAME
</code></pre>

<h2 id="heading--list-all-tags">List all tags</h2>

<p>To list all tags present on the region controller:</p>
<pre><code class="bash">maas $PROFILE tags read
</code></pre>

<h2 id="heading--list-nodesmachines-labelled-with-a-tag">List nodes/machines labelled with a tag</h2>

<p>To list what nodes (or machines) a tag applies to:</p>
<pre><code class="bash">maas $PROFILE tag nodes $TAG_NAME
maas $PROFILE tag machines $TAG_NAME
</code></pre>

<h2 id="heading--juju-integration">Juju integration</h2>

<p>Although you can use a tag in the web UI (as a node search filter), you realise most of the benefit when you&rsquo;re deploying applications with Juju.</p>
<p>For example, to use the &lsquo;gpu&rsquo; tag to deploy a (hypothetical) service called &lsquo;cuda&rsquo;:</p>
<pre><code class="bash">juju deploy --constraints tags=gpu cuda
</code></pre>

<p>You can also use multiple tags in addition to the normal Juju constraints:</p>
<pre><code class="bash">juju deploy --constraints &quot;mem=1024 tags=gpu,intel&quot; cuda
</code></pre>

<h2 id="heading--manual-tag-assignment">Manual tag assignment</h2>

<p>It is possible to assign tags to nodes manually by simply omitting the definition and applying the tag to a node by referencing its system id:</p>
<pre><code class="bash">maas $PROFILE tags create name=$TAG_NAME comment='$TAG_COMMENT'
maas $PROFILE tag update-nodes $TAG_NAME add=$SYSTEM_ID
</code></pre>

<p>To remove a tag:</p>
<pre><code class="bash">maas $PROFILE tag update-nodes $TAG_NAME remove=$SYSTEM_ID
</code></pre>

<p>In the same operation, a tag can be added to some nodes and removed from others:</p>
<pre><code class="bash">maas $PROFILE tag update-nodes $TAG_NAME \
    add=$SYSTEM_ID_1 add=$SYSTEM_ID_2 remove=$SYSTEM_ID_3
</code></pre>

<h2 id="heading--hybrid-tag-assignment">Hybrid tag assignment</h2>

<p>You can also create a tag with a definition (thereby map to certain nodes), remove the definition (but retain the mapping), and then add the tag manually to specific nodes. This action is useful for hardware which is conceptually similar but does not all satisfy a single tag definition. Here are the commands you would use to do this:</p>
<pre><code class="bash">maas $PROFILE tags create name=$TAG_NAME \
    comment='$TAG_COMMENT' definition='$TAG_DEFINITION'
maas $PROFILE tag update $TAG_NAME definition=''
maas $PROFILE tag update-nodes $TAG_NAME add=$SYSTEM_ID
</code></pre>

<!-- LINKS -->
    </div>
  </body>
</html>