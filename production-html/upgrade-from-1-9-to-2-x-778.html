<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="css/stylesheet.css" />
    <style>
      #selector a:link{color:black;}
      #selector a:visited{color:black;}
      #selector a:active{color:black;}
      #selector a:hover{color:blue;}
      #sidebar a:link{color:black;}
      #sidebar a:visited{color:black;}
      #sidebar a:active{color:black;}
      #sidebar a:hover{color:blue;}
      ul {margin-left:0;list-style-type:none;}
      li {margin: 4px 0;}
    </style>
  </head>
  <body>
    <div id="selector" style="top:0; position:fixed; float:right; background-color:#d9d9d9; width:100%;border-bottom:1px solid black;">
      &nbsp;&nbsp;<strong>Offline docs</strong>
      <a href="https://maas.io/docs">(switch to live docs)</a>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <a href="../maas-vanilla/upgrade-from-1-9-to-2-x-778.html" style="border-top:1px solid black; border-left:1px solid black; border-right:1px solid black;">
	Full
      </a>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <a href="../maas-ui-only/upgrade-from-1-9-to-2-x-778.html" style="border-top:1px solid black; border-left:1px solid black; border-right:1px solid black;">
	UI-only
      </a>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <strong>
	<a href="../maas-cli-only/upgrade-from-1-9-to-2-x-778.html" style="background-color:white;border-top:1px solid black; border-left:1px solid black; border-right:1px solid black; border-bottom:5px solid white;align:center;">
	  &nbsp;CLI-only&nbsp;
	</a>
      </strong>
    </div>
    <div id="sidebar" style="float:left; width:25%;margin-top:40px; margin-left:20px">
      <strong>
	<a href="maas-documentation-25.html">
	  Introduction
	</a>
      </strong>
      <ul>
	<li>
	  <a href="about-maas-840.html">
	    About MAAS
	  </a>
	</li>
	<li>
	  <a href="give-me-an-example-of-maas-1314.html">
	    &ldquo;Give me an example&rdquo;
	  </a>
	</li>
	<li>
	  <a href="explore-maas-787.html">
	    Explore MAAS
	  </a>
	</li>
	<li>
	  <a href="whats-new-in-maas-2-8-1655.html">
	    What&rsquo;s new in 2.8
	  </a>
	</li>
	<li>
	  <a href="https://maas.io/install">
	    Quick start
	  </a>
	</li>
      </ul>
      <strong>Installing MAAS
      </strong>
      <ul>
	<li>
	  <a href="maas-requirements-789.html">
	    Requirements
	  </a>
	</li>
	<li>
	  <a href="maas-installation-from-a-snap-773.html">
	    Installation
	  </a>
	</li>
	<li>
	  <a href="configuration-journey-781.html">
	    Configuration journey
	  </a>
	</li>
	<li>
	  <a href="installation-and-configuration-checklist-750.html">
	    Setup checklist
	  </a>
	</li>
      </ul>
      <strong>
	<a href="introduction-to-controllers-786.html">
	  Controllers
	</a>
      </strong>
      <ul>
	<li>
	  <a href="maas-communication-783.html">
	    Communication
	  </a>
	</li>
	<li>
	  <a href="rack-controllers-771.html">
	    Rack controllers
	  </a>
	</li>
	<li>
	  <a href="region-controllers-772.html">
	    Region controllers
	  </a>
	</li>
	<li>
	  <a href="high-availability-804.html">
	    High availability
	  </a>
	</li>
      </ul>
      <strong>
	<a href="introduction-to-machines-829.html">
	  Machines
	</a>
      </strong>
      <ul>
	<li>
	  <a href="add-machines-821.html">
	    Add machines
	  </a>
	</li>
	<li>
	  <a href="power-management-830.html">
	    Power management
	  </a>
	</li>
	<li>
	  <a href="commission-machines-822.html">
	    Commission machines
	  </a>
	</li>
	<li>Testing
	</li>
	<li>
	  <a href="hardware-testing-826.html">
	    Hardware testing
	  </a>
	</li>
	<li>
	  <a href="network-testing-1267.html">
	    Network testing
	  </a>
	</li>
	<li>
	  <a href="commissioning-and-hardware-testing-scripts-833.html">
	    Commissioning and hardware testing scripts
	  </a>
	</li>
	<li>
	  <a href="deploy-machines-825.html">
	    Deploy machines
	  </a>
	</li>
	<li>
	  <a href="maas-tags-834.html">
	    Tags
	  </a>
	</li>
	<li>
	  <a href="custom-machine-setup-824.html">
	    Custom machine setup
	  </a>
	</li>
	<li>
	  <a href="kernel-boot-options-827.html">
	    Kernel boot options
	  </a>
	</li>
	<li>
	  <a href="resource-pools-831.html">
	    Resource pools
	  </a>
	</li>
	<li>
	  <a href="storage-775.html">
	    Storage
	  </a>
	</li>
	<li>
	  <a href="vmware-vmfs-datastores-780.html">
	    VMware VMFS datastores
	  </a>
	</li>
	<li>
	  <a href="ubuntu-kernels-828.html">
	    Ubuntu kernels
	  </a>
	</li>
      </ul>
      <strong>
	<a href="images-754.html">
	  Images
	</a>
      </strong>
      <ul>
	<li>
	  <a href="select-and-import-images-751.html">
	    Select and import images
	  </a>
	</li>
	<li>
	  <a href="local-image-mirror-752.html">
	    Local image mirror
	  </a>
	</li>
	<li>
	  <a href="vmware-images-753.html">
	    VMWare images
	  </a>
	</li>
      </ul>
      <strong>
	<a href="networking-768.html">
	  Networking
	</a>
      </strong>
      <ul>
	<li>
	  <a href="subnet-management-766.html">
	    Subnet management
	  </a>
	</li>
	<li>
	  <a href="managing-dhcp-759.html">
	    DHCP
	  </a>
	</li>
	<li>
	  <a href="ip-ranges-760.html">
	    IP ranges
	  </a>
	</li>
	<li>
	  <a href="proxy-763.html">
	    Proxy
	  </a>
	</li>
	<li>
	  <a href="ntp-services-762.html">
	    NTP
	  </a>
	</li>
	<li>
	  <a href="network-discovery-758.html">
	    Network discovery
	  </a>
	</li>
	<li>
	  <a href="ipv6-addressing-761.html">
	    IPv6
	  </a>
	</li>
	<li>
	  <a href="configuring-tls-encryption-764.html">
	    SSL
	  </a>
	</li>
	<li>
	  <a href="managing-stp-765.html">
	    STP
	  </a>
	</li>
	<li>
	  <a href="availability-zones-820.html">
	    Availability zones (AZs)
	  </a>
	</li>
      </ul>
      <strong>
	<a href="introduction-to-vm-hosting-1524.html">
	  VM hosting
	</a>
      </strong>
      <ul>
	<li>
	  <a href="vm-host-networking-1526.html">
	    VM host networking
	  </a>
	</li>
	<li>
	  <a href="adding-a-vm-host-1549.html">
	    Add a VM host
	  </a>
	</li>
	<li>
	  <a href="vm-host-storage-pools-1525.html">
	    VM host storage pools
	  </a>
	</li>
	<li>
	  <a href="creating-and-deleting-vms-806.html">
	    Creating and deleting VMs
	  </a>
	</li>
      </ul>
      <strong>Operations
      </strong>
      <ul>
	<li>
	  <a href="prometheus-metrics-813.html">
	    Prometheus metrics
	  </a>
	</li>
	<li>
	  <a href="backup-792.html">
	    Backup
	  </a>
	</li>
	<li>
	  <a href="hardening-your-maas-installation-1381.html">
	    MAAS security
	  </a>
	</li>
	<li>
	  <a href="maas-logging-1468.html">
	    Logging
	  </a>
	</li>
	<li>
	  <a href="commissioning-logs-1478.html">
	    Commissioning logs
	  </a>
	</li>
	<li>
	  <a href="user-accounts-790.html">
	    User accounts
	  </a>
	</li>
	<li>
	  <a href="interactive-search-819.html">
	    Interactive search
	  </a>
	</li>
      </ul>
      <strong>
	<a href="concepts-and-terms-785.html">
	  Concepts &amp; terms
	</a>
      </strong>
      <ul>
	<li>
	  <a href="concepts-and-terms-785.html#heading--network-tutorial">
	    Brief network tutorial
	  </a>
	</li>
      </ul>
      <strong>
	<a href="maas-cli-802.html">
	  CLI
	</a>
      </strong>
      <ul>
	<li>
	  <a href="common-cli-tasks-794.html">
	    Common tasks
	  </a>
	</li>
	<li>
	  <a href="audit-event-logs-791.html">
	    Audit event logs
	  </a>
	</li>
	<li>
	  <a href="cli-kernel-management-799.html">
	    Kernel management
	  </a>
	</li>
	<li>
	  <a href="cli-image-management-797.html">
	    Image management
	  </a>
	</li>
	<li>
	  <a href="cli-interface-management-798.html">
	    Interface management
	  </a>
	</li>
	<li>
	  <a href="cli-tag-management-801.html">
	    Tag management
	  </a>
	</li>
	<li>
	  <a href="cli-resource-pool-management-800.html">
	    Resource pool management
	  </a>
	</li>
	<li>
	  <a href="cli-dhcp-snippet-management-796.html">
	    DHCP snippet management
	  </a>
	</li>
	<li>
	  <a href="cli-commissioning-and-hardware-testing-scripts-832.html">
	    Commissioning and hardware testing scripts
	  </a>
	</li>
	<li>
	  <a href="cli-advanced-tasks-793.html">
	    Advanced tasks
	  </a>
	</li>
	<li>
	  <a href="cli-composable-hardware-795.html">
	    Composable hardware
	  </a>
	</li>
	<li>
	  <a href="python-api-client-810.html">
	    API client
	  </a>
	</li>
      </ul>
      <strong>
	<a href="https://maas.io/docs/api">
	  API documentation
	</a>
      </strong>
      <ul>
	<li>
	  <a href="api-authentication-742.html">
	    API authentication
	  </a>
	</li>
      </ul>
      <strong>
	<a href="troubleshooting-837.html">
	  Troubleshoot
	</a>
      </strong>
      <ul>
	<li>
	  <a href="getting-help-838.html">
	    Getting help
	  </a>
	</li>
	<li>
	  <a href="tips-tricks-and-traps-1506.html">
	    Tips, tricks, and traps
	  </a>
	</li>
	<li>
	  <a href="https://old-docs.maas.io/2.5/en/">
	    MAAS 2.5 (+ earlier) doc
	  </a>
	</li>
      </ul>
      <strong>
	<a href="whats-new-in-maas-2-8-1655.html">
	  Release notes
	</a>
      </strong>
      <p/>
      <strong>
	<a href="writing-guide-747.html">
	  Help improve these docs
	</a>
      </strong>
    </div>
    <div class="container" style="float:right; width:65%; margin-top:40px; margin-right:30px">
      <h1>Upgrade from 1 9 to 2 x</h1><table width="100%"><tr>
<td><a href="https://maas.io/docs/upgrade-from-1-9-to-2-x#heading--ip-range-changes">IP range changes</a></td>
<td><a href="https://maas.io/docs/upgrade-from-1-9-to-2-x#heading--troubleshooting">Troubleshooting</a></td>
</tr></table>

<hr>

<p>MAAS 2.4 is only supported on Ubuntu 18.04 (Bionic Beaver). This is because changes in the base dependencies of Ubuntu 18.04 LTS mean that newer versions of MAAS will not be back-portable, and consequently, to upgrade to MAAS 2.4 and all future versions, you will need to first upgrade to 2.3. This is covered below.</p>
<p>See <a href="upgrade-2-3-to-2-4-from-ubuntu-16-04-777.html">Upgrade 2.3 to 2.4 from Ubuntu 16.04</a> for further details on upgrading from 2.3 to 2.4</p>
<p>MAAS 2.3 is only supported on Ubuntu 16.04 LTS (Xenial Xerus). This is because 16.04 defaults to Python 3, whereas previous versions of Ubuntu defaulted to Python 2.</p>
<p>MAAS 1.9 will continue to be supported on Ubuntu 14.04 LTS (Trusty Tahr) until the latter reaches the end of its support cycle. See <a href="https://wiki.ubuntu.com/Releases">Ubuntu Releases</a> for release and EOL dates for all Ubuntu versions.</p>
<p>Upgrading from 1.9 to 2.3 will therefore involve upgrading the version of Ubuntu to 16.04 LTS. In so doing, the MAAS database and MAAS configuration will be migrated. See the <a href="https://wiki.ubuntu.com/XenialXerus/ReleaseNotes#Upgrading_from_Ubuntu_14.04_LTS_or_15.10">Xenial Release Notes</a> for upgrading to Xenial.</p>
<p>Prior to the upgrade all packages should be updated (<code>sudo apt-get update &amp;&amp; sudo apt-get dist-upgrade</code>). It is recommended that backups be made and that a test environment (that mirrors your production environment) be upgraded first, to pre-empt any issues.</p>
<h2 id="heading--ip-range-changes">IP range changes</h2>

<p>The concepts and terminology used to define IP ranges within MAAS have changed significantly between 1.9 and 2.x releases of MAAS. These changes are described below.</p>
<p>MAAS 1.9 allows users to configure their managed networks to use either <a href="https://docs.ubuntu.com/maas/1.9/en/nodes-commission">static</a> or dynamic ranges. A static range is used by MAAS to allocate automatic (static) IP addresses while a dynamic range is used solely for DHCP.</p>
<p>Static ranges are deprecated in MAAS 2.x. Instead, MAAS assumes full control of the address space for a network it manages with two exceptions:</p>
<ul>
<li>When an optional <a href="ip-ranges-760.html">reserved range</a> has been defined.</li>
<li>When <a href="subnet-management-766.html">managed allocation</a> in MAAS 2.3+ is disabled.</li>
</ul>
<p>Reserved ranges allow MAAS to avoid addresses already in use on the network. When upgrading from MAAS 1.9 to MAAS 2.x, static ranges are migrated to their <em>inverse</em> reserved range equivalents.</p>
<p>For example, a dynamic range of <code>192.168.0.20 - 192.168.0.89</code> and a static range of <code>192.168.0.100 - 192.168.0.199</code> in MAAS 1.9 would be reconfigured as the following in MAAS 2.x:</p>
<pre><code class="no-highlight">Reserved range (1): 192.168.0.1   -&gt; 192.168.0.19
Dynamic range:      192.168.0.20  -&gt; 192.168.0.89
Reserved range (2): 192.168.0.90  -&gt; 192.168.0.99
Reserved range (3): 192.168.0.200 -&gt; 192.168.0.254
</code></pre>

<p>The above example shows a static range replaced by three reserved ranges to create an equivalent configuration.</p>
<p>[note]
With MAAS 2.1+, <a href="network-discovery-758.html">network devices discovery</a> uses the ARP protocol to determine which addresses are being used, allowing MAAS to automatically avoid assigning recently used IP addresses.
[/note]</p>
<h2 id="heading--troubleshooting">Troubleshooting</h2>

<p>The upgrade process can be complex, and depending on your installation, may require manual intervention. You may be asked whether you want to overwrite some files, PostgreSQL files in particular, especially if you&rsquo;ve implemented high availability in PostgreSQL (see <a href="postgresql-ha-hot-standby-803.html">PostgreSQL HA</a>). If you&rsquo;ve made no modifications to these files, you can instruct the upgrade process to overwrite them. Otherwise, you&rsquo;ll need to merge the new changes into the files manually.</p>
<p>At the end of the upgrade, if you see processing errors with the <code>maas</code>, <code>squid3</code> or <code>maas-region-controller</code> packages, or if the upgrade complains about unmet dependencies with the MAAS packages, try the following:</p>
<pre><code class="bash">sudo apt -f install
sudo apt autoremove
sudo apt upgrade
</code></pre>

<p>This should fix the dependency errors, remove redundant packages and update to the latest version of MAAS.</p>
<!-- LINKS -->
    </div>
  </body>
</html>