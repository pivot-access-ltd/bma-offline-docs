<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="css/stylesheet.css" />
    <style>
      #selector a:link{color:black;}
      #selector a:visited{color:black;}
      #selector a:active{color:black;}
      #selector a:hover{color:blue;}
      #sidebar a:link{color:black;}
      #sidebar a:visited{color:black;}
      #sidebar a:active{color:black;}
      #sidebar a:hover{color:blue;}
      ul {margin-left:0;list-style-type:none;}
      li {margin: 4px 0;}
    </style>
  </head>
  <body>
    <div id="selector" style="top:0; position:fixed; float:right; background-color:#d9d9d9; width:100%;border-bottom:1px solid black;">
      &nbsp;&nbsp;
      <strong>Offline docs
      </strong>
      <a href="https://maas.io/docs">(switch to live docs)
      </a>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <span style="background-color:white;border-top:1px solid black; border-left:1px solid black; border-right:1px solid black; border-bottom:5px solid white;">
	  UI-only
      </span>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	<a href="../cli/bootstrap-maas.html">
	  CLI-only
	</a>
    </div>
    <div id="sidebar" style="float:left; width:25%;margin-top:40px; margin-left:20px">
      <strong>
	<a href="maas-documentation-25.html">
	  Home
	</a>
      </strong> 
      <strong>
	<a href="tutorials.html">
	  Tutorials
	</a>
      </strong>
      <ul>
	<li>
	  <a href="bootstrap-maas.html">
	    Bootstrap MAAS
	  </a>
	</li>
	<li>
	  <a href="try-out-the-maas-cli.html">
	    Try out the MAAS CLI
	  </a>
	</li>
	<li>
	  <a href="create-a-custom-image.html">
	    Create a custom image
	  </a>
	</li>
	<li>
	  <a href="get-fancy-cli-output.html">
	    Get fancy CLI output
	  </a>
	</li>
      </ul>
      <strong>
	<a href="how-to-get-started-with-maas.html">
	  How to get started with MAAS
	</a>
      </strong>
      <ul>
	<li>
	  <a href="how-to-do-a-fresh-install-of-maas.html">
	    Do a fresh install of MAAS
	  </a>
	</li>
	<li>
	  <a href="how-to-upgrade-maas.html">
	    Upgrade MAAS
	  </a>
	</li>
	<li>
	  <a href="how-to-spin-up-maas-with-ansible.html">
	    Spin up MAAS with Ansible
	  </a>
	</li>
      </ul>
      <strong>
	<a href="how-to-set-up-networks.html">
	  How to set up networks
	</a>
      </strong>
      <ul>
	<li>
	  <a href="how-to-connect-maas-networks.html">
	    Connect MAAS networks
	  </a>
	</li>
	<li>
	  <a href="how-to-enable-dhcp.html">
	    Enable DHCP
	  </a>
	</li>
	<li>
	  <a href="how-to-use-availability-zones.html">
	    Use availability zones
	  </a>
	</li>
      </ul>
      <strong>
	<a href="how-to-use-images.html">
	  How to use images
	</a>
      </strong>
      <ul>
	<li>
	  <a href="how-to-use-standard-images.html">
	    Use standard images
	  </a>
	</li>
	<li>
	  <a href="how-to-mirror-images-locally.html">
	    Mirror images locally
	  </a>
	</li>
	<li>
	  <a href="how-to-customise-images.html">
	    Customise images
	  </a>
	</li>
	<li>
	  <a href="how-to-employ-vmware-images.html">
	    Employ VMWare images
	  </a>
	</li>
	<li>
	  <a href="how-to-deploy-a-real-time-kernel.html">
	    Deploy a RT kernel
	  </a>
	</li>
      </ul>
      <strong>
	<a href="how-to-manage-controllers.html">
	  How to manage controllers
	</a>
      </strong>
      <ul>
	<li>
	  <a href="how-to-configure-controllers.html">
	    Configure controllers
	  </a>
	</li>
	<li>
	  <a href="how-to-enable-high-availability.html">
	    Enable HA
	  </a>
	</li>
      </ul>
      <strong>
	<a href="how-to-manage-machines.html">
	  How to manage machines
	</a>
      </strong>
      <ul>
	<li>
	  <a href="how-to-make-machines-available.html">
	    Make machines available
	  </a>
	</li>
	<li>
	  <a href="how-to-customise-machines.html">
	    Customise machines
	  </a>
	</li>
	<li>
	  <a href="how-to-put-machines-to-work.html">
	    Put machines to work
	  </a>
	</li>
      </ul>
      <strong>
	<a href="how-to-use-virtual-machines.html">
	  How to use virtual machines
	</a>
      </strong>
      <ul>
	<li>
	  <a href="how-to-set-up-lxd.html">
	    Set up LXD
	  </a>
	</li>
	<li>
	  <a href="how-to-manage-vm-hosts.html">
	    Manage VM hosts
	  </a>
	</li>
	<li>
	  <a href="how-to-manage-virtual-machines.html">
	    Manage virtual machines
	  </a>
	</li>
      </ul>
      <strong>
	<a href="how-to-label-devices.html">
	  How to label devices
	</a>
      </strong>
      <ul>
	<li>
	  <a href="how-to-tag-machines.html">
	    Tag machines
	  </a>
	</li>
	<li>
	  <a href="how-to-annotate-machines.html">
	    Annotate machines
	  </a>
	</li>
	<li>
	  <a href="how-to-use-machine-tags.html">
	    Use machine tags
	  </a>
	</li>
	<li>
	  <a href="how-to-use-controller-tags.html">
	    Use controller tags
	  </a>
	</li>
	<li>
	  <a href="how-to-use-storage-tags.html">
	    Use storage tags
	  </a>
	</li>
	<li>
	  <a href="how-to-use-network-tags.html">
	    Use network tags
	  </a>
	</li>
      </ul>
      <strong>
	<a href="how-to-secure-maas.html">
	  How to secure MAAS
	</a>
      </strong>
      <ul>
	<li>
	  <a href="how-to-improve-maas-security.html">
	    Improve MAAS security
	  </a>
	</li>
	<li>
	  <a href="how-to-manage-user-accounts.html">
	    Manage user accounts
	  </a>
	</li>
	<li>
	  <a href="how-to-enable-maas-native-tls.html">
	    Enable MAAS native TLS
	  </a>
	</li>
	<li>
	  <a href="how-to-use-hashicorp-vault-with-maas.html">
	    Use Vault with MAAS
	  </a>
	</li>
	<li>
	  <a href="how-to-set-up-an-air-gapped-maas.html">
	    Set up an air-gapped MAAS
	  </a>
	</li>
      </ul>
      <strong>
	<a href="how-to-operate-maas.html">
	  How to operate MAAS
	</a>
      </strong>
      <ul>
	<li>
	  <a href="how-to-find-machines.html">
	    Find machines
	  </a>
	</li>
	<li>
	  <a href="how-to-back-up-maas.html">
	    Back up MAAS
	  </a>
	</li>
	<li>
	  <a href="how-to-monitor-maas.html">
	    Monitor MAAS
	  </a>
	</li>
	<li>
	  <a href="how-to-audit-maas.html">
	    Audit MAAS
	  </a>
	</li>
	<li>
	  <a href="how-to-troubleshoot-maas.html">
	    Troubleshoot MAAS
	  </a>
	</li>
      </ul>
      <strong>
	<a href="how-to-give-and-receive-help.html">
	  How to give and receive help
	</a>
      </strong>
      <ul>
	<li>
	  <a href="how-to-use-our-discourse-forum.html">
	    Use our discourse forum
	  </a>
	</li>
	<li>
	  <a href="how-to-contact-us">
	    Get support↗
	  </a>
	</li>
	<li>
	  <a href="how-to-request-new-features.html">
	    Request new features
	  </a>
	</li>
	<li>
	  <a href="how-to-review-and-report-bugs.html">
	    Review and report bugs
	  </a>
	</li>
	<li>
	  <a href="how-to-contribute-doc.html">
	    Contribute documentation
	  </a>
	</li>
      </ul>
      <strong>
	<a href="general-reference.html">
	  General reference
	</a>
      </strong>
      <ul>
	<li>
	  <a href="what-is-new-with-maas.html">
	    Release notes
	  </a>
	</li>
	<li>
	  <a href="maas-installation-requirements.html">
	    Installation requirements
	  </a>
	</li>
	<li>
	  <a href="maas-settings-reference.html">
	    MAAS settings
	  </a>
	</li>
	<li>
	  <a href="https://launchpad.net/maas.html">
	    MAAS source code↗
	  </a>
	</li>
	<li>
	  <a href="how-to-help-improve-the-doc.html">
	    Doc style guide
	  </a>
	</li>
	<li>
	  <a href="maas-glossary.html">
	    Glossary
	  </a>
	</li>
	<li>
	  <a href="https://ubuntu.com/community/code-of-conduct">
	    Code of conduct↗
	  </a>
	</li>
      </ul>
      <strong>
	<a href="api-reference.html">
	  API reference
	</a>
      </strong>
      <ul>
	<li>
	  <a href="api-authentication-reference.html">
	    API authentication
	  </a>
	</li>
	<li>
	  <a href="python-api-client-reference.html">
	    Python API client
	  </a>
	</li>
	<li>
	  <a href="api">
	    API documentation↗
	  </a>
	</li>
      </ul>
      <strong>
	<a href="maas-scripts-reference.html">
	  Scripts reference
	</a>
      </strong>
      <ul>
	<li>
	  <a href="commissioning-scripts-reference.html">
	    Commissioning scripts
	  </a>
	</li>
	<li>
	  <a href="hardware-test-scripts-reference.html">
	    Hardware test scripts
	  </a>
	</li>
	<li>
	  <a href="maas-terraform-reference.html">
	    Terraform
	  </a>
	</li>
      </ul>
      <strong>
	<a href="maas-logs-reference.html">
	  Log reference
	</a>
      </strong>
      <ul>
	<li>
	  <a href="event-logs-reference.html">
	    Event logs
	  </a>
	</li>
	<li>
	  <a href="audit-event-logs-reference.html">
	    Audit event logs
	  </a>
	</li>
	<li>
	  <a href="commissioning-logs-reference.html">
	    Commissioning logs
	  </a>
	</li>
	<li>
	  <a href="testing-logs-reference.html">
	    Testing logs
	  </a>
	</li>
      </ul>
      <strong>
	<a href="machine-parameters-reference.html">
	  Machine parameters reference
	</a>
      </strong>
      <ul>
	<li>
	  <a href="power-drivers-reference.html">
	    Power drivers
	  </a>
	</li>
	<li>
	  <a href="storage-layouts-reference.html">
	    Storage layouts
	  </a>
	</li>
	<li>
	  <a href="device-labelling-reference.html">
	    Device labelling
	  </a>
	</li>
      </ul>
      <strong>
	<a href=".html">
	  Explanation
	</a>
      </strong>
      <ul>
	<li>
	  <a href="about-maas.html">
	    About MAAS
	  </a>
	</li>
	<li>
	  <a href="about-networking.html">
	    About networking
	  </a>
	</li>
	<li>
	  <a href="about-images.html">
	    About images
	  </a>
	</li>
	<li>
	  <a href="about-controllers.html">
	    About controllers
	  </a>
	</li>
	<li>
	  <a href="about-machines.html">
	    About machines
	  </a>
	</li>
	<li>
	  <a href="about-virtual-machines.html">
	    About virtual machines
	  </a>
	</li>
	<li>
	  <a href="about-device-labels.html">
	    About device labels
	  </a>
	</li>
	<li>
	  <a href="about-maas-events.html">
	    About MAAS events
	  </a>
	</li>
	<li>
	  <a href="about-maas-audit-events.html">
	    About audit events
	  </a>
	</li>
	<li>
	  <a href="about-maas-logging.html">
	    About MAAS logging
	  </a>
	</li>
	<li>
	  <a href="about-maas-security.html">
	    About MAAS security
	  </a>
	</li>
	<li>
	  <a href="about-maas-performance.html">
	    About MAAS performance
	  </a>
	</li>
	<li>
	  <a href="about-ansible.html">
	    About Ansible
	  </a>
	</li>
      </ul>
    </div>
    <div class="container" style="float:right; width:65%; margin-top:40px; margin-right:30px">
      <h1>Bootstrap MAAS</h1><!-- "Bootstrap MAAS" -->
<p>Welcome to MAAS, the powerful tool for managing physical servers and data centres. This tutorial will help you get MAAS up and running, so that you can create, commission, and deploy some virtual machines in later tutorials. Let&rsquo;s jump right in and start doing things.</p>
<p><a href="#heading--Step-1-Install-MAAS"><h2 id="heading--Step-1-Install-MAAS">Step 1: Install MAAS</h2></a></p>
<p>To kickstart your MAAS journey, we&rsquo;ll begin with a simple and easy installation process.</p>
<ol>
<li>Install the MAAS snap:</li>
</ol>
<pre><code class="language-nohighlight">sudo snap install maas
</code></pre>
<ol>
<li>Install PostgreSQL and update necessary packages:</li>
</ol>
<pre><code class="language-nohighlight">sudo apt update -y
sudo apt install -y postgresql
</code></pre>
<ol>
<li>Create a PostgreSQL user and a secure password:</li>
</ol>
<pre><code class="language-nohighlight">sudo -u postgres psql -c &quot;CREATE USER \&quot;maascli\&quot; WITH ENCRYPTED PASSWORD 'maascli'&quot;
</code></pre>
<ol>
<li>Create a MAAS database:</li>
</ol>
<pre><code class="language-nohighlight">sudo -u postgres createdb -O &quot;maascli&quot; &quot;maasclidb&quot;
</code></pre>
<ol>
<li>Edit the pg_hba.conf file to enhance security and connectivity:</li>
</ol>
<pre><code class="language-nohighlight">sudo vi /etc/postgresql/12/main/pg_hba.conf
</code></pre>
<ol>
<li>Initialise MAAS using the command line:</li>
</ol>
<pre><code class="language-nohighlight">sudo maas init region+rack --database-uri &quot;postgres://maascli:maascli@localhost/maasclidb&quot;
</code></pre>
<ol>
<li>
<p>Note the URL that is returned by the action above; you&rsquo;ll need that shortly.</p>
</li>
<li>
<p>Create your admin user for MAAS:</p>
</li>
</ol>
<pre><code class="language-nohighlight">sudo maas createadmin
</code></pre>
<p>Congratulations! Your MAAS installation is complete. Next up? MAAS configuration.</p>
<p><a href="#heading--Step-2-Configure-MAAS"><h2 id="heading--Step-2-Configure-MAAS">Step 2: Configure MAAS</h2></a></p>
<p>To configure MAAS for first-time use:</p>
<ol>
<li>Access MAAS at this address, where <code>$API_HOST</code> is the hostname or IP address of the region API server, which was set during installation:</li>
</ol>
<pre><code class="language-nohighlight">http://${API_HOST}:5240/MAAS
</code></pre>
<ol>
<li>
<p>Log in using the login information you created when initialising MAAS.</p>
</li>
<li>
<p>Set the DNS forwarder to a suitable value, e.g., 8.8.8.8.</p>
</li>
<li>
<p>Select an Ubuntu image to import; you may be required to select at least one LTS version.</p>
</li>
</ol>
<p><a href="#heading--Step-3-Set-up-SSH-access"><h2 id="heading--Step-3-Set-up-SSH-access">Step 3: Set up SSH access</h2></a></p>
<p>Set up your SSH keys for admin users like this:</p>
<ol>
<li>
<p>Import your SSH public key from Launchpad, GitHub, or upload your existing public key.</p>
</li>
<li>
<p>Click &ldquo;Import&rdquo; to import the SSH key.</p>
</li>
</ol>
<p>Congratulations! MAAS has been successfully set up. Now, let&rsquo;s install and set up a LXD virtual machine host.</p>
<p><a href="#heading--Step-4-Install-LXD"><h2 id="heading--Step-4-Install-LXD">Step 4: Install LXD</h2></a></p>
<p>Here&rsquo;s how to install LXD for use with MAAS:</p>
<ol>
<li>If you&rsquo;re on a version of Ubuntu older than 20.04 or have the Debian version of LXD, initiate the uninstall process; otherwise, skip this step:</li>
</ol>
<pre><code class="language-nohighlight">sudo apt-get purge -y *lxd* *lxc*
</code></pre>
<ol>
<li>Free up disk space by running the autoremove command:</li>
</ol>
<pre><code class="language-nohighlight">sudo apt-get autoremove -y
</code></pre>
<ol>
<li>Check if LXD is already installed and up to date; if so, skip to major step 4, below:</li>
</ol>
<pre><code class="language-nohighlight">sudo snap refresh
</code></pre>
<ol>
<li>If LXD needs to be updated, run the following command to install or update it:</li>
</ol>
<pre><code class="language-nohighlight">sudo snap install lxd
</code></pre>
<ol>
<li>Run the initialisation command, follow the interactive prompts to configure LXD based on your requirements:</li>
</ol>
<pre><code class="language-nohighlight">sudo lxd init
</code></pre>
<ol>
<li>Check the LXD network configuration:</li>
</ol>
<pre><code class="language-nohighlight">lxc network show lxdbr0
</code></pre>
<ol>
<li>If you need to turn off LXD-provided DHCP, change the following settings:</li>
</ol>
<pre><code class="language-nohighlight">lxc network set lxdbr0 dns.mode=none
lxc network set lxdbr0 ipv4.dhcp=false
lxc network set lxdbr0 ipv6.dhcp=false
</code></pre>
<ol>
<li>Verify the changes by running the show command again:</li>
</ol>
<pre><code class="language-nohighlight">lxc network show lxdbr0
</code></pre>
<p>Once these steps are completed, your LXD installation will be updated, and any DHCP provided by LXD will be disabled. You can now proceed to add the LXD host to MAAS and utilise LXD for building an example configuration.</p>
<p><a href="#heading--Step-5-Enable-DHCP-for-LXD"><h2 id="heading--Step-5-Enable-DHCP-for-LXD">Step 5: Enable DHCP for LXD</h2></a></p>
<p>To enable DHCP to communicate with the LXD bridge you just created:</p>
<ol>
<li>Open a terminal and type the following command:</li>
</ol>
<pre><code class="language-nohighlight">ip addr
</code></pre>
<ol>
<li>
<p>Note the IP address of the bridge lxdbr0 (or whatever you named your LXD bridge).</p>
</li>
<li>
<p>In the MAAS UI, select <em>Networking &gt; Subnets</em>.</p>
</li>
<li>
<p>In the table, find the Fabric which contains the IP address of the lxdbr0 bridge, and select the associated VLAN.</p>
</li>
<li>
<p>Select <em>Configure DHCP</em>.</p>
</li>
<li>
<p>In the dropdown <em>Select rack controller</em>, select a rack controller.  For this example, there should only be one.</p>
</li>
<li>
<p>In the dropdown <em>Select subnet</em>, select a suitable subnet.</p>
</li>
<li>
<p>Select <em>Configure DHCP</em>.  </p>
</li>
</ol>
<p><a href="#heading--Step-6-Create-a-LXD-KVM-host"><h2 id="heading--Step-6-Create-a-LXD-KVM-host">Step 6: Create a LXD KVM host</h2></a></p>
<p>To create VMs, you&rsquo;ll need to create a VM host, like this:</p>
<ol>
<li>
<p>Open the MAAS web interface and select the &ldquo;KVM &gt; LXD&rdquo; option.</p>
</li>
<li>
<p>Click on &ldquo;Add KVM&rdquo; and provide a descriptive Name for the KVM host.</p>
</li>
<li>
<p>Optionally, choose a specific Zone and Resource pool if needed.</p>
</li>
<li>
<p>Enter the LXD address as the gateway address of the bridge for that LXD instance. For example, if <code>lxdbr0</code> has the address <code>10.4.241.0</code>, the default gateway address would be <code>10.4.241.1</code>.</p>
</li>
<li>
<p>Select &ldquo;Generate new certificate&rdquo; and proceed by clicking &ldquo;Next&rdquo;.</p>
</li>
<li>
<p>To establish trust with LXD, select &ldquo;Add trust to LXD via command line&rdquo;.</p>
</li>
<li>
<p>Copy the provided bash command and certificate from the text box.</p>
</li>
<li>
<p>Open a terminal and paste the copied command, ensuring it runs successfully (i.e., returns nothing but another prompt).</p>
</li>
<li>
<p>Click on &ldquo;Check authentication&rdquo;. You will switch screens, and if everything goes well, you&rsquo;ll see a &ldquo;Connected&rdquo; message with a green check-mark.</p>
</li>
<li>
<p>Choose to &ldquo;Add new project&rdquo; or &ldquo;Select existing project&rdquo;. Note that selecting an existing project will commission any VMs already in that project.</p>
</li>
<li>
<p>Proceed by clicking &ldquo;Next&rdquo;. You will be taken to a dashboard for the VM host.</p>
</li>
</ol>
<p>Now you can start adding virtual machines to this new VM host as desired.  Check this tutorial to learn how to do so.</p>
    </div>
  </body>
</html>