<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="css/stylesheet.css" />
    <style>
      #selector a:link{color:black;}
      #selector a:visited{color:black;}
      #selector a:active{color:black;}
      #selector a:hover{color:blue;}
      #sidebar a:link{color:black;}
      #sidebar a:visited{color:black;}
      #sidebar a:active{color:black;}
      #sidebar a:hover{color:blue;}
      ul {margin-left:0;list-style-type:none;}
      li {margin: 4px 0;}
    </style>
  </head>
  <body>
    <div id="selector" style="top:0; position:fixed; float:right; background-color:#d9d9d9; width:100%;border-bottom:1px solid black;">
      &nbsp;&nbsp;<strong>Offline docs</strong>
      <a href="https://maas.io/docs">(switch to live docs)</a>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	<a href="../ui/networking.html">
	  &nbsp;UI-only&nbsp;
	</a>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <span style="background-color:white;border-top:1px solid black; border-left:1px solid black; border-right:1px solid black; border-bottom:5px solid white;">
	  CLI-only
      </span>
    </div>
    <div id="sidebar" style="float:left; width:25%;margin-top:40px; margin-left:20px">
      <strong>
	<a href="maas-documentation.html">
	  Introduction
	</a>
      </strong>
      <ul>
	<li>
	  <a href="about-maas.html">
	    About MAAS
	  </a>
	</li>
	<li>
	  <a href="give-me-an-example-of-maas.html">
	    &ldquo;Give me an example&rdquo;
	  </a>
	</li>
	<li>
	  <a href="whats-new-in-maas.html">
	    What&rsquo;s new in 3.0
	  </a>
	</li>
	<li>
	  <a href="maas-requirements.html">
	    Requirements
	  </a>
	</li>
	<li>
	  <a href="maas-installation.html">
	    Installation
	  </a>
	</li>
	<li>
	  <a href="configuration-journey.html">
	    Configuration journey
	  </a>
	</li>
      <strong>
	<a href="controllers.html">
	  Controllers
	</a>
      </strong>
      <ul>
	<li>
	  <a href="maas-communication.html">
	    Communication
	  </a>
	</li>
	<li>
	  <a href="rack-controllers.html">
	    Rack controllers
	  </a>
	</li>
	<li>
	  <a href="region-controllers.html">
	    Region controllers
	  </a>
	</li>
	<li>
	  <a href="high-availability.html">
	    High availability
	  </a>
	</li>
      </ul>
      <strong>
	<a href="machines.html">
	  Machines
	</a>
      </strong>
      <ul>
	<li>
	  <a href="add-machines.html">
	    Add machines
	  </a>
	</li>
	<li>
	  <a href="power-management.html">
	    Power management
	  </a>
	</li>
	<li>
	  <a href="commission-machines.html">
	    Commission machines
	  </a>
	</li>
	<li>Testing
	</li>
	<li>
	  <a href="hardware-testing.html">
	    Hardware testing
	  </a>
	</li>
	<li>
	  <a href="network-testing.html">
	    Network testing
	  </a>
	</li>
	<li>
	  <a href="commissioning-and-hardware-testing-scripts.html">
	    Commissioning and hardware testing scripts
	  </a>
	</li>
	<li>
	  <a href="deploy-machines.html">
	    Deploy machines
	  </a>
	</li>
	<li>
	  <a href="maas-tags.html">
	    Tags
	  </a>
	</li>
	<li>
	  <a href="custom-machine-setup.html">
	    Custom machine setup
	  </a>
	</li>
	<li>
	  <a href="kernel-boot-options.html">
	    Kernel boot options
	  </a>
	</li>
	<li>
	  <a href="resource-pools.html">
	    Resource pools
	  </a>
	</li>
	<li>
	  <a href="storage.html">
	    Storage
	  </a>
	</li>
	<li>
	  <a href="vmware-vmfs-datastores.html">
	    VMware VMFS datastores
	  </a>
	</li>
	<li>
	  <a href="ubuntu-kernels.html">
	    Ubuntu kernels
	  </a>
	</li>
      </ul>
      <strong>
	<a href="images.html">
	  Images
	</a>
      </strong>
      <ul>
	<li>
	  <a href="select-and-import-images.html">
	    Select and import images
	  </a>
	</li>
	<li>
	  <a href="local-image-mirror.html">
	    Local image mirror
	  </a>
	</li>
	<li>
	  <a href="vmware-images.html">
	    VMWare images
	  </a>
	</li>
      </ul>
      <strong>
	<a href="networking.html">
	  Networking
	</a>
      </strong>
      <ul>
	<li>
	  <a href="subnet-management.html">
	    Subnet management
	  </a>
	</li>
	<li>
	  <a href="managing-dhcp.html">
	    DHCP
	  </a>
	</li>
	<li>
	  <a href="ip-ranges.html">
	    IP ranges
	  </a>
	</li>
	<li>
	  <a href="proxy.html">
	    Proxy
	  </a>
	</li>
	<li>
	  <a href="ntp-services.html">
	    NTP
	  </a>
	</li>
	<li>
	  <a href="network-discovery.html">
	    Network discovery
	  </a>
	</li>
	<li>
	  <a href="ipv6-addressing.html">
	    IPv6
	  </a>
	</li>
	<li>
	  <a href="configuring-tls-encryption.html">
	    SSL
	  </a>
	</li>
	<li>
	  <a href="managing-stp.html">
	    STP
	  </a>
	</li>
	<li>
	  <a href="availability-zones.html">
	    Availability zones (AZs)
	  </a>
	</li>
      </ul>
      <strong>
	<a href="vm-hosting.html">
	  VM hosting
	</a>
      </strong>
      <ul>
	<li>
	  <a href="vm-host-networking.html">
	    VM host networking
	  </a>
	</li>
	<li>
	  <a href="adding-a-vm-host.html">
	    Add a VM host
	  </a>
	</li>
	<li>
	  <a href="vm-host-storage-pools.html">
	    VM host storage pools
	  </a>
	</li>
	<li>
	  <a href="creating-and-deleting-vms.html">
	    Creating and deleting VMs
	  </a>
	</li>
      </ul>
      <strong>Operations
      </strong>
      <ul>
	<li>
	  <a href="prometheus-metrics.html">
	    Prometheus metrics
	  </a>
	</li>
	<li>
	  <a href="backup.html">
	    Backup
	  </a>
	</li>
	<li>
	  <a href="hardening-your-maas-installation.html">
	    MAAS security
	  </a>
	</li>
	<li>
	  <a href="maas-logging.html">
	    Logging
	  </a>
	</li>
	<li>
	  <a href="commissioning-logs.html">
	    Commissioning logs
	  </a>
	</li>
	<li>
	  <a href="user-accounts.html">
	    User accounts
	  </a>
	</li>
	<li>
	  <a href="interactive-search.html">
	    Interactive search
	  </a>
	</li>
      </ul>
      <strong>
	<a href="concepts-and-terms.html">
	  Concepts &amp; terms
	</a>
      </strong>
      <ul>
	<li>
	  <a href="concepts-and-terms.html#heading--network-tutorial">
	    Brief network tutorial
	  </a>
	</li>
      </ul>
      <strong>
	<a href="maas-cli.html">
	  CLI
	</a>
      </strong>
      <ul>
	<li>
	  <a href="common-cli-tasks.html">
	    The CLI cookbook
	  </a>
	</li>
	<li>
	  <a href="common-cli-tasks.html">
	    Common tasks
	  </a>
	</li>
	<li>
	  <a href="audit-event-logs.html">
	    Audit event logs
	  </a>
	</li>
	<li>
	  <a href="cli-kernel-management.html">
	    Kernel management
	  </a>
	</li>
	<li>
	  <a href="cli-image-management.html">
	    Image management
	  </a>
	</li>
	<li>
	  <a href="cli-interface-management.html">
	    Interface management
	  </a>
	</li>
	<li>
	  <a href="cli-advanced-tasks.html">
	    Advanced tasks
	  </a>
	</li>
	<li>
	  <a href="cli-composable-hardware.html">
	    Composable hardware
	  </a>
	</li>
	<li>
	  <a href="python-api-client.html">
	    API client
	  </a>
	</li>
      </ul>
      <strong>
	<a href="api.html">
	  API documentation
	</a>
      </strong>
      <ul>
	<li>
	  <a href="api-authentication.html">
	    API authentication
	  </a>
	</li>
      </ul>
      <strong>
	<a href="troubleshooting.html">
	  Troubleshoot
	</a>
      </strong>
      <ul>
	<li>
	  <a href="getting-help.html">
	    Getting help
	  </a>
	</li>
	<li>
	  <a href="tips-tricks-and-traps.html">
	    Tips, tricks, and traps
	  </a>
	</li>
	<li>
	  <a href="https://old-docs.maas.io/2.5/en/">
	    MAAS 2.5 (+ earlier) doc
	  </a>
	</li>
      </ul>
      <strong>
	<a href="whats-new-in-maas.html">
	  Release notes
	</a>
      </strong>
      <p/>
      <strong>
	<a href="writing-guide.html">
	  Help improve these docs
	</a>
      </strong>
    </div>
    <div class="container" style="float:right; width:65%; margin-top:40px; margin-right:30px">
      <h1>Networking</h1>
<p>You can use the CLI to manage the networking elements of MAAS, including subnets, fabrics, VLANs, and spaces.  This page shows how to access and edit these elements. See <a href="concepts-and-terms.html">Concepts and terms</a> for the definitions of networking objects, along with a basic networking tutorial (if needed).</p>
<h4>Nine questions you may have:</h4>
<ol>
<li><a href="#heading--cli-list-available-subnets">How do I list available subnets?</a></li>
<li><a href="#heading--cli-managing-subnets">How do I manage subnets?</a></li>
<li><a href="#heading--static-routes">How do I manage static routes?</a></li>
<li><a href="#heading--reserved-ranges">How do I manage reserved ranges?</a></li>
<li><a href="#heading--setting-up-a-bridge">How do I set up a bridge?</a></li>
<li><a href="#heading--maas-bridge-cli">How do I set up a bridge with the MAAS CLI/API?</a></li>
<li><a href="#heading--maas-bridge-netplan">How do I set up a bridge with netplan?</a></li>
</ol>
<p><a href="#heading--cli-list-available-subnets"><h2 id="heading--cli-list-available-subnets">List available subnets</h2></a></p>
<p>To view the list of available subnets, enter the following command:</p>
<pre><code>maas admin subnets read | \
jq -r '([&quot;FABRIC&quot;, &quot;VLAN&quot;, &quot;DHCP&quot;, &quot;SUBNET&quot;]
| (., map(length*&quot;-&quot;))),
(.[] | [.vlan.fabric, .vlan.name, .vlan.dhcp_on, .cidr])
| @tsv' \
| column -t
</code></pre>

<p>which produces output something like this:</p>
<pre><code>FABRIC        VLAN      DHCP       SUBNET
------        ----      ---------  ------
Patient-Care  untagged  true       192.168.123.0/24
fabric-0      untagged  false      0.0.0.0/0
fabric-0      untagged  false      10.0.0.0/24
fabric-1      untagged  false      10.70.132.0/24
fabric-1      untagged  false      fd42:8b52:7114:9ef8::/64
fabric-3      untagged  true       192.168.43.0/24
fabric-3      untagged  true       2600:100d:b125:d5e9::/64
fabric-3      untagged  true       2600:100d:b120:3933::/64
fabric-3      untagged  true       2600:100d:b109:dee0::/64
fabric-3      untagged  true       2600:100d:b104:94c0::/64
</code></pre>

<!--   snap-2-9-ui   deb-2-9-ui deb-3-0-ui snap-3-0-ui
You can use the Web UI to manage the networking elements of MAAS, including subnets, fabrics, VLANs, and spaces.  This page shows how to access and edit these elements. See [Concepts and terms](concepts-and-terms.html) for the definitions of networking objects, along with a basic networking tutorial (if needed).

#### Ten questions you may have:

1. [How do I access the main networking view?](#heading--ui-main-view)
2. [How do I view the subnet window?](#heading--ui-subnet-window)
3. [How do I view a subnet summary?](#heading--ui-subnet-summary)
4. [How do I view utilisation?](#heading--ui-utilisation)
5. [How do I manage static routes?](#heading--static-routes)
6. [How do I manage reserved ranges?](#heading--reserved-ranges)
7. [How do I view used addresses?](#heading--ui-used-addresses)
8. [How do I set up a bridge?](#heading--setting-up-a-bridge)
9. [How do I set up a bridge with the web UI?](#heading--maas-bridge-web-ui)
10. [How do I set up a bridge with netplan?](#heading--maas-bridge-netplan)

<a href="#heading--ui-main-view"><h2 id="heading--ui-main-view">Main networking view</h2></a>

To access the main networking view visit the 'Subnets' page:

<a href="images/657bb332-installconfig-networking__2.4_subnets.png" target = "_blank"><img src="images/657bb332-installconfig-networking__2.4_subnets.png"></a></a>

Due to the nature of this example, we re-use elements like fabrics, VLANs, subnets, and spaces.  MAAS can automatically detect these elements -- here there are two fabrics, one VLAN, five subnets, and two spaces -- but if MAAS doesn't find them, they can be added manually using the 'Add' button.

This main view can also be filtered either by fabrics or by spaces through the use of the 'Group by' drop-down.
  snap-2-9-ui   deb-2-9-ui deb-3-0-ui snap-3-0-ui -->

<!-- deb-2-9-cli
Fabrics, VLANs, and spaces do not require much configuration beyond names and descriptions. You can change the MTU for a VLAN, as well as [enable DHCP](managing-dhcp.html#heading--enabling-dhcp) (see 'Take action' button).  None of these options requires detailed instruction. A subnet, on the other hand, provides a number of configuration options relevant to the day-to-day operation of MAAS.
 deb-2-9-cli -->

<!-- deb-2-9-ui
Fabrics, VLANs, and spaces do not require much configuration beyond names and descriptions. You can change the MTU for a VLAN, as well as [enable DHCP](managing-dhcp.html#heading--enabling-dhcp) (see 'Take action' button).  None of these options requires detailed instruction. A subnet, on the other hand, provides a number of configuration options relevant to the day-to-day operation of MAAS.
 deb-2-9-ui -->

<p>Fabrics, VLANs, and spaces do not require much configuration beyond names and descriptions. You can change the MTU for a VLAN, as well as <a href="managing-dhcp.html#heading--enabling-dhcp">enable DHCP</a> (see &lsquo;Take action&rsquo; button).  None of these options requires detailed instruction. A subnet, on the other hand, provides a number of configuration options relevant to the day-to-day operation of MAAS.</p>
<!-- deb-3-0-ui
Fabrics, VLANs, and spaces do not require much configuration beyond names and descriptions. You can change the MTU for a VLAN, as well as [enable DHCP](managing-dhcp.html#heading--enabling-dhcp) (see 'Take action' button).  None of these options requires detailed instruction. A subnet, on the other hand, provides a number of configuration options relevant to the day-to-day operation of MAAS.
 deb-3-0-ui -->

<!-- snap-2-9-cli
Fabrics, VLANs, and spaces do not require much configuration beyond names and descriptions. You can change the MTU for a VLAN, as well as [enable DHCP](managing-dhcp.html#heading--enabling-dhcp) (see 'Take action' button).  None of these options requires detailed instruction. A subnet, on the other hand, provides a number of configuration options relevant to the day-to-day operation of MAAS.
 snap-2-9-cli -->

<!-- snap-2-9-ui
Fabrics, VLANs, and spaces do not require much configuration beyond names and descriptions. You can change the MTU for a VLAN, as well as [enable DHCP](managing-dhcp.html#heading--enabling-dhcp) (see 'Take action' button).  None of these options requires detailed instruction. A subnet, on the other hand, provides a number of configuration options relevant to the day-to-day operation of MAAS.
 snap-2-9-ui -->

<!-- snap-3-0-cli
Fabrics, VLANs, and spaces do not require much configuration beyond names and descriptions. You can change the MTU for a VLAN, as well as [enable DHCP](managing-dhcp.html#heading--enabling-dhcp) (see 'Take action' button).  None of these options requires detailed instruction. A subnet, on the other hand, provides a number of configuration options relevant to the day-to-day operation of MAAS.
 snap-3-0-cli -->

<!-- snap-3-0-ui
Fabrics, VLANs, and spaces do not require much configuration beyond names and descriptions. You can change the MTU for a VLAN, as well as [enable DHCP](managing-dhcp.html#heading--enabling-dhcp) (see 'Take action' button).  None of these options requires detailed instruction. A subnet, on the other hand, provides a number of configuration options relevant to the day-to-day operation of MAAS.
 snap-3-0-ui -->

<p><a href="#heading--cli-managing-subnets"><h2 id="heading--cli-managing-subnets">Managing subnets</h3></a></p>
<p>You can view the details of an individual subnet with the command:</p>
<pre><code>maas $PROFILE subnet read $SUBNET_ID \
| jq -r '([&quot;NAME&quot;,&quot;CIDR&quot;,&quot;GATEWAY&quot;,&quot;DNS&quot;,&quot;DISCOVERY&quot;,&quot;FABRIC&quot;,&quot;VLAN&quot;]
| (., map(length*&quot;-&quot;))), ([.name,.cidr,.gateway_ip // &quot;-&quot;, .allow_dns,.active_discovery,.vlan.name,.vlan.fabric]) | @tsv' | column -t
</code></pre>

<p>This command retrieves output similar to this:</p>
<pre><code>NAME              CIDR              GATEWAY  DNS   DISCOVERY  FABRIC    VLAN
----              ----              -------  ---   ---------  ------    ----
192.168.123.0/24  192.168.123.0/24  -        true  false      untagged  default
</code></pre>

<p>If you don&rsquo;t know the subnet ID, you can look it up like this:</p>
<pre><code>maas $PROFILE subnets read \
| jq -r '([&quot;NAME&quot;, &quot;SUBNET_ID&quot;]
| (., map(length*&quot;-&quot;))), (.[] | [.name, .id]) | @tsv' \
| column -t | grep $SUBNET_NAME
</code></pre>

<p>For example, if you&rsquo;re using the &ldquo;admin&rdquo; profile, and your subnet name contains &ldquo;192.168.123,&rdquo; you could find the subnet ID with this command:</p>
<pre><code>maas admin subnets read \
| jq -r '([&quot;NAME&quot;, &quot;SUBNET_ID&quot;]
| (., map(length*&quot;-&quot;))), (.[] | [.name, .id]) | @tsv' \
| column -t | grep 192.168.123
</code></pre>

<p>Subnets support the following configurable values:</p>
<!--   snap-2-9-ui   deb-2-9-ui snap-3-0-ui deb-3-0-ui 
<a href="#heading--ui-subnet-window"><h2 id="heading--ui-subnet-window">Subnet window</h3></a>

Clicking a subnet (here `192.168.100.0/24`) will display its detail screen, which presents several vertical sections.  Let's take them one by one.

<a href="#heading--ui-subnet-summary"><h3 id="heading--ui-subnet-summary">Subnet summary</h3></a>

The **Subnet summary** section is the largest and most complex of the subnet configuration screens:

<a href="images/17617b35-installconfig-networking__2.4_subnets-summary.png" target = "_blank"><img src="images/17617b35-installconfig-networking__2.4_subnets-summary.png"></a></a>

This screen presents the following configurable options:
  snap-2-9-ui   deb-2-9-ui snap-3-0-ui deb-3-0-ui -->

<ul>
<li>
<p><strong>Name</strong>: Subnet names can be any valid text string, although usually, and by default, they are named with the CIDR of the subnet itself.</p>
</li>
<li>
<p><strong>CIDR</strong>: This is the address parameter for the subnet.  In keeping with standard CIDR notation, the number of bits of the prefix are indicated after the slash.</p>
</li>
<li>
<p><strong>Gateway IP</strong>: This is the address of the default gateway for your subnet, which is the IP address that transfers packets to other subnets or networks. Typically, this is simply the first IP address in a block of addresses (the <code>.1</code> address).</p>
</li>
<li>
<p><strong>DNS</strong>: This is the address of a DNS (domain name server, or simply &ldquo;nameserver&rdquo;) for your subnet.  It&rsquo;s optional, but can be configured if desired.</p>
</li>
<li>
<p><strong>Description</strong>: This field represents freeform text that you can enter to describe your subnet, as needed to keep important notes attached to the definition of the subnet.</p>
</li>
</ul>
<!-- deb-2-9-cli
* **Managed allocation** refers to the ability of MAAS to completely manage a subnet. See [Subnet management](subnet-management.html).
 deb-2-9-cli -->

<!-- deb-2-9-ui
* **Managed allocation** refers to the ability of MAAS to completely manage a subnet. See [Subnet management](subnet-management.html).
 deb-2-9-ui -->

<ul>
<li><strong>Managed allocation</strong> refers to the ability of MAAS to completely manage a subnet. See <a href="subnet-management.html">Subnet management</a>.</li>
</ul>
<!-- deb-3-0-ui
* **Managed allocation** refers to the ability of MAAS to completely manage a subnet. See [Subnet management](subnet-management.html).
 deb-3-0-ui -->

<!-- snap-2-9-cli
* **Managed allocation** refers to the ability of MAAS to completely manage a subnet. See [Subnet management](subnet-management.html).
 snap-2-9-cli -->

<!-- snap-2-9-ui
* **Managed allocation** refers to the ability of MAAS to completely manage a subnet. See [Subnet management](subnet-management.html).
 snap-2-9-ui -->

<!-- snap-3-0-cli
* **Managed allocation** refers to the ability of MAAS to completely manage a subnet. See [Subnet management](subnet-management.html).
 snap-3-0-cli -->

<!-- snap-3-0-ui
* **Managed allocation** refers to the ability of MAAS to completely manage a subnet. See [Subnet management](subnet-management.html).
 snap-3-0-ui -->

<ul>
<li>
<p><strong>Active mapping</strong> instructs MAAS to scan the subnet every 3 hours to discover hosts that have not been discovered passively.</p>
</li>
<li>
<p><strong>Proxy access</strong> instructs MAAS to allow clients from this subnet to access the MAAS proxy.</p>
</li>
<li>
<p><strong>Allow DNS resolution</strong> allows subnet clients to use MAAS for DNS resolution.</p>
</li>
<li>
<p><strong>Fabric</strong>: This field allows you to set the subnet&rsquo;s fabric.</p>
</li>
<li>
<p><strong>VLAN</strong>: This field allows you to set the subnet&rsquo;s VLAN.</p>
</li>
<li>
<p><strong>Space</strong> is presented for clarity, though spaces are managed at the VLAN level.</p>
</li>
</ul>
<!--   snap-2-9-ui   deb-2-9-ui snap-3-0-ui deb-3-0-ui
<a href="#heading--ui-utilisation"><h3 id="heading--ui-utilisation">Utilisation</h3></a>

This section of the subnet page presents metrics regarding address usage by this subnet.

<a href="images/3d3e4b61-installconfig-networking__2.4_subnets-utilisation.png" target = "_blank"><img src="images/3d3e4b61-installconfig-networking__2.4_subnets-utilisation.png"></a></a>

'Subnet addresses' shows the total number of addresses associated with the subnet, here 254. 'Availability' shows how many of those addresses are unused, and therefore "available", here 189, which corresponds to a percentage of roughly 74% of the total. Finally, 'Used' shows the percentage that is used, here roughly 26%.
  snap-2-9-ui   deb-2-9-ui snap-3-0-ui deb-3-0-ui -->

<p><a href="#heading--static-routes"><h2 id="heading--static-routes">Static Routes</h2></a></p>
<p>This section can be used to define a static route between two subnets. A route is defined on a per-subnet basis to use a particular gateway, using a configured destination and metric.</p>
<p>To create a static route, use the following command:</p>
<pre><code>maas admin static-routes create source=$SOURCE_SUBNET destination=$DEST_SUBNET \
gateway_ip=$GATEWAY_IP
</code></pre>

<!--   snap-2-9-ui   deb-2-9-ui snap-3-0-ui deb-3-0-ui
To create a static route, click the 'Add static route' button to reveal the edit pane. Enter a Gateway IP address, select a destination subnet from the 'Destination' drop-down list, and edit the routing metric value if needed. Clicking 'Add' will activate the route. Routes can be edited and removed using the icons to the right of each entry.

<a href="images/49f5e240-installconfig-networking__2.4_subnets-routes.png" target = "_blank"><img src="images/49f5e240-installconfig-networking__2.4_subnets-routes.png"></a></a>
  snap-2-9-ui   deb-2-9-ui snap-3-0-ui deb-3-0-ui -->

<p><a href="#heading--reserved-ranges"><h2 id="heading--reserved-ranges">Reserved ranges</h2></a></p>
<!--   snap-2-9-ui   deb-2-9-ui deb-3-0-ui snap-3-0-ui
The reserved ranges section of the subnet screen looks like this:

<a href="images/5f9f50f9-installconfig-networking__2.4_subnets-reserved.png" target = "_blank"><img src="images/5f9f50f9-installconfig-networking__2.4_subnets-reserved.png"></a></a>
  snap-2-9-ui   deb-2-9-ui deb-3-0-ui snap-3-0-ui -->

<!-- deb-2-9-cli
This subject is treated separately in [IP ranges](ip-ranges.html).
 deb-2-9-cli -->

<!-- deb-2-9-ui
This subject is treated separately in [IP ranges](ip-ranges.html).
 deb-2-9-ui -->

<p>This subject is treated separately in <a href="ip-ranges.html">IP ranges</a>.</p>
<!-- deb-3-0-ui
This subject is treated separately in [IP ranges](ip-ranges.html).
 deb-3-0-ui -->

<!-- snap-2-9-cli
This subject is treated separately in [IP ranges](ip-ranges.html).
 snap-2-9-cli -->

<!-- snap-2-9-ui
This subject is treated separately in [IP ranges](ip-ranges.html).
 snap-2-9-ui -->

<!-- snap-3-0-cli
This subject is treated separately in [IP ranges](ip-ranges.html).
 snap-3-0-cli -->

<!-- snap-3-0-ui
This subject is treated separately in [IP ranges](ip-ranges.html).
 snap-3-0-ui -->

<!--   snap-2-9-ui   deb-2-9-ui snap-3-0-ui deb-3-0-ui
<a href="#heading--ui-used-addresses"><h2 id="heading--ui-used-addresses">Used</h2></a>

This section displays hosts (including controllers) associated with the used addresses along with related bits of host information.

<a href="images/b9e69b0b-installconfig-networking__2.4_subnets-used.png" target = "_blank"><img src="images/b9e69b0b-installconfig-networking__2.4_subnets-used.png"></a></a>
  snap-2-9-ui   deb-2-9-ui snap-3-0-ui deb-3-0-ui -->

<p><a href="#heading--setting-up-a-bridge"><h2 id="heading--setting-up-a-bridge">Setting up a bridge</h2></a></p>
<p>At various times in your MAAS network, you may need to set up a bridge to connect between your machines and MAAS.  This section explains several ways of accomplishing this.</p>
<p><strong>NOTE:</strong> 
It&rsquo;s essential to enforce usage of IP addresses to avoid domain name conflicts, should different controllers resolve the same domain name with different IP addresses. You should also avoid using 127.0.0.1 when running multiple controllers, as it would confuse MAAS.</p>
<!--   snap-2-9-ui   deb-2-9-ui snap-3-0-ui deb-3-0-ui
<a href="#heading--maas-bridge-web-ui"><h2 id="heading--maas-bridge-web-ui">Set up a bridge with MAAS UI</h2></a>

You can use the MAAS UI to configure a bridge. Select the machine you want to bridge and switch to the "Network" tab. Select the network where you want to create the bridge and click "Create bridge:"

<a href="images/29624d737106c5bad777aee9d2c8cad9c3de7151.jpeg" target = "_blank"><img src="images/29624d737106c5bad777aee9d2c8cad9c3de7151.jpeg"></a></a> 

Configure the bridge on a subnet MAAS controls.  You may use any IP mode for the bridge:

<a href="images/dd8567ff1cd76606c5ce1751e606fcfab2bc7ce2.jpeg" target = "_blank"><img src="images/dd8567ff1cd76606c5ce1751e606fcfab2bc7ce2.jpeg"></a></a> 

When you're done, it should look something like this:

<a href="images/e392d638f0acecb9d54c81bbca4ee17cbcd05445.jpeg" target = "_blank"><img src="images/e392d638f0acecb9d54c81bbca4ee17cbcd05445.jpeg"></a></a> 

Then you can deploy using the bridge.

  snap-2-9-ui   deb-2-9-ui snap-3-0-ui deb-3-0-ui -->

<!-- snap-2-9-ui deb-2-9-ui snap-3-0-ui deb-3-0-ui
**NOTE** that you can create an "OpenVswitch" bridge if desired, and MAAS will create the netplan model for you.
 snap-2-9-ui deb-2-9-ui snap-3-0-ui deb-3-0-ui -->

<p><a href="#heading--maas-bridge-cli"><h2 id="heading--maas-bridge-cli">Use the MAAS API to configure a bridge</h2></a></p>
<p>You can use the MAAS CLI/API to configure a bridge, with the following procedure:</p>
<ol>
<li>
<p>Select the interface you wish to configure the bridge on. This example uses the boot interface, since the boot interface must be connected to a MAAS controlled network &ndash; but any interface is allowed:</p>
<pre><code>INTERFACE_ID=$(maas $PROFILE machine read $SYSTEM_ID | jq .boot_interface.id)
</code></pre>
</li>
<li>
<p>Create the bridge:</p>
<pre><code> BRIDGE_ID=$(maas $PROFILE interfaces create-bridge $SYSTEM_ID name=br0 parent=$INTERFACE_ID | jq .id)
</code></pre>
</li>
<li>
<p>Select the subnet where you want the bridge (this should be a MAAS controlled subnet):</p>
<pre><code>SUBNET_ID=$(maas $PROFILE subnets read | jq -r '.[] | select(.cidr == "10.0.0.0/24" and .managed == true).id')
</code></pre>
</li>
<li>
<p>Connect the bridge to the subnet:</p>
<pre><code>  maas $PROFILE interface link-subnet $SYSTEM_ID $BRIDGE_ID subnet=$SUBNET_ID mode="STATIC" ip_address="10.0.0.101"
</code></pre>
</li>
</ol>
<p><a href="#heading--maas-bridge-netplan"><h2 id="heading--maas-bridge-netplan">Use netplan to configure a bridge</h2></a></p>
<p>You can also use netplan to configure a bridge:</p>
<p>Open your netplan configuration file.  This should be in <code>/etc/netplan</code>.  It could be called <code>50-cloud-init.yaml</code>, <code>netplan.yaml</code>, or something else.  Modify the file to add a bridge, using the example below to guide you:</p>
<pre><code>network:
    bridges:
        br0:
            addresses:
            - 10.0.0.101/24
            gateway4: 10.0.0.1
            interfaces:
            - enp1s0
            macaddress: 52:54:00:39:9d:f9
            mtu: 1500
            nameservers:
                addresses:
                - 10.0.0.2
                search:
                - maas
            parameters:
                forward-delay: 15
                stp: false
    ethernets:
        enp1s0:
            match:
                macaddress: 52:54:00:39:9d:f9
            mtu: 1500
            set-name: enp1s0
        enp2s0:
            match:
                macaddress: 52:54:00:df:87:ac
            mtu: 1500
            set-name: enp2s0
        enp3s0:
            match:
                macaddress: 52:54:00:a7:ac:46
            mtu: 1500
            set-name: enp3s0
    version: 2
</code></pre>

<p>Apply the new configuration with <code>netplan apply</code>.</p>
    </div>
  </body>
</html>